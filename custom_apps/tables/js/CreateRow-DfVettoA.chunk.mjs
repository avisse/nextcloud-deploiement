const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=[window.OC.filePath('tables', '', 'js/store-Cvxj8Vav.chunk.mjs'),window.OC.filePath('tables', '', 'js/constants-C1shV9FP.chunk.mjs'),window.OC.filePath('tables', '', 'js/vue.runtime.esm-DBajT-mq.chunk.mjs'),window.OC.filePath('tables', '', 'js/_plugin-vue2_normalizer-jrlE7CJU-B-cIoeGj.chunk.mjs'),window.OC.filePath('tables', '', 'js/NcNoteCard-DG3F-LUj.chunk.mjs'),window.OC.filePath('tables', '', 'js/index-BmkWHhSR.chunk.mjs')])))=>i.map(i=>d[i]);
/*! third party licenses: js/vendor.LICENSE.txt */
import{_ as s}from"./preload-helper-DI1sXkNj.chunk.mjs";import{i,f as l}from"./useFormatDateTime-AjHnUuIE.chunk.mjs";import{i as a,f as n,l as d}from"./NcNoteCard-DG3F-LUj.chunk.mjs";import{n as c}from"./_plugin-vue2_normalizer-oRdohoZe.chunk.mjs";import"./index-BmkWHhSR.chunk.mjs";import"./index-56SXuvlv-Ca_OzF4R.chunk.mjs";import{s as m,b as w}from"./_plugin-vue2_normalizer-jrlE7CJU-B-cIoeGj.chunk.mjs";/* empty css                     */import{r as u,a as h}from"./rowHelper-CqVeo9j1.chunk.mjs";import{u as p}from"./data-BYdwMvxA.chunk.mjs";import{m as f,A as y}from"./constants-C1shV9FP.chunk.mjs";import"./vue.runtime.esm-DBajT-mq.chunk.mjs";import"./public-0fz1q1qH.chunk.mjs";import"./RowFormWrapper-CzNjoOJe.chunk.mjs";import"./NcTable-BKzW_OCJ.chunk.mjs";import"./Link-BMMtnqd-.chunk.mjs";import"./store-Cvxj8Vav.chunk.mjs";const C={name:"CreateRow",components:{NcDialog:l,ColumnFormComponent:h,NcCheckboxRadioSwitch:i,NcNoteCard:d,NcButton:n},mixins:[u],props:{showModal:{type:Boolean,default:!1},columns:{type:Array,default:null},isView:{type:Boolean,default:!1},elementId:{type:Number,default:null}},data(){return{row:{},localLoading:!1,addNewAfterSave:!1,allowedProtocols:y}},computed:{nonMetaColumns(){return this.columns.filter(t=>t.id>=0)},hasEmptyMandatoryRows(){return this.checkMandatoryFields(this.row)},hasInvalidUrlProtocol(){return this.nonMetaColumns.some(t=>t.type==="text-link"&&!this.isValidUrlProtocol(this.row[t.id]))}},watch:{showModal(){this.showModal&&this.$nextTick(()=>{this.$el.querySelector("input")?.focus()})}},methods:{...f(p,["insertNewRow"]),t:a,actionCancel(){this.reset(),this.addNewAfterSave=!1,this.$emit("close")},async actionConfirm(){this.localLoading=!0,await this.sendNewRowToBE(),this.localLoading=!1,this.addNewAfterSave?(w(a("tables","Row successfully created.")),this.reset()):this.actionCancel()},async sendNewRowToBE(){if(!this.tablesStore){const{default:t}=await s(async()=>{const{default:e}=await import("./store-Cvxj8Vav.chunk.mjs");return{default:e}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);this.tablesStore=t}try{const t={};for(const[e,o]of Object.entries(this.row))t[e]=o;await this.insertNewRow({viewId:this.isView?this.elementId:null,tableId:this.isView?null:this.elementId,data:t})}catch(t){console.error(t),m(a("tables","Could not create new row"))}},reset(){this.row={}},onKeydown(t){t.key==="Enter"&&t.ctrlKey&&this.actionConfirm()}}};var v=function(){var t=this,e=t._self._c;return t.showModal?e("NcDialog",{attrs:{name:t.t("tables","Create row"),size:"large","data-cy":"createRowModal"},on:{closing:t.actionCancel}},[e("div",{staticClass:"modal__content",on:{keydown:t.onKeydown}},[t._l(t.nonMetaColumns,function(o){return e("div",{key:o.id,attrs:{"data-cy":o.title}},[e("ColumnFormComponent",{attrs:{column:o,value:t.row[o.id]},on:{"update:value":function(r){return t.$set(t.row,o.id,r)}}}),o.mandatory&&!t.isValueValidForColumn(t.row[o.id],o)?e("NcNoteCard",{attrs:{type:"error"}},[t._v(" "+t._s(t.t("tables",'"{columnTitle}" should not be empty',{columnTitle:o.title}))+" ")]):t._e(),t.row[o.id]&&o.type==="text-link"&&!t.isValidUrlProtocol(t.row[o.id])?e("NcNoteCard",{attrs:{type:"error"}},[t._v(" "+t._s(t.t("tables","Invalid protocol. Allowed: {allowed}",{allowed:t.allowedProtocols.join(", ")}))+" ")]):t._e()],1)}),e("div",{staticClass:"row"},[e("div",{staticClass:"fix-col-4 space-T end"},[e("div",{staticClass:"padding-right"},[e("NcCheckboxRadioSwitch",{attrs:{checked:t.addNewAfterSave,type:"switch","data-cy":"createRowAddMoreSwitch"},on:{"update:checked":function(o){t.addNewAfterSave=o}}},[t._v(" "+t._s(t.t("tables","Add more"))+" ")])],1),t.localLoading?t._e():e("NcButton",{staticClass:"primary",attrs:{"aria-label":t.t("tables","Save row"),disabled:t.hasEmptyMandatoryRows||t.hasInvalidUrlProtocol,"data-cy":"createRowSaveButton"},on:{click:function(o){return t.actionConfirm()}}},[t._v(" "+t._s(t.t("tables","Save"))+" ")])],1)])],2)]):t._e()},_=[],N=c(C,v,_,!1,null,"d3efd220");const $=N.exports;export{$ as default};
//# sourceMappingURL=CreateRow-DfVettoA.chunk.mjs.map
