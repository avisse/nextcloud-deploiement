const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=[window.OC.filePath('tables', '', 'js/LinkReferenceWidget-CIcrZN12.chunk.mjs'),window.OC.filePath('tables', '', 'js/IconTables-C-somE0B.chunk.mjs'),window.OC.filePath('tables', '', 'js/_plugin-vue2_normalizer-oRdohoZe.chunk.mjs'),window.OC.filePath('tables', '', 'js/vue.runtime.esm-DBajT-mq.chunk.mjs'),window.OC.filePath('tables', '', 'js/NcNoteCard-DG3F-LUj.chunk.mjs'),window.OC.filePath('tables', '', 'js/useFormatDateTime-AjHnUuIE.chunk.mjs'),window.OC.filePath('tables', '', 'js/index-BmkWHhSR.chunk.mjs'),window.OC.filePath('tables', '', 'js/public-0fz1q1qH.chunk.mjs'),window.OC.filePath('tables', '', 'js/index-56SXuvlv-Ca_OzF4R.chunk.mjs'),window.OC.filePath('tables', '', 'js/ContentReferenceWidget-B9NGkCoK.chunk.mjs'),window.OC.filePath('tables', '', 'js/preload-helper-DI1sXkNj.chunk.mjs'),window.OC.filePath('tables', '', 'js/NcTable-BKzW_OCJ.chunk.mjs'),window.OC.filePath('tables', '', 'js/data-BYdwMvxA.chunk.mjs'),window.OC.filePath('tables', '', 'js/constants-C1shV9FP.chunk.mjs'),window.OC.filePath('tables', '', 'js/_plugin-vue2_normalizer-jrlE7CJU-B-cIoeGj.chunk.mjs'),window.OC.filePath('tables', '', 'js/Link-BMMtnqd-.chunk.mjs'),window.OC.filePath('tables', '', 'js/store-Cvxj8Vav.chunk.mjs'),window.OC.filePath('tables', '', 'js/index-Da8lzF0Y.chunk.mjs')])))=>i.map(i=>d[i]);
/*! third party licenses: js/vendor.LICENSE.txt */
import{_ as s}from"./preload-helper-DI1sXkNj.chunk.mjs";import{i,_ as a,o as u,k as d,f as h}from"./NcNoteCard-DG3F-LUj.chunk.mjs";import{j as p,e as m,i as v,c as b}from"./useFormatDateTime-AjHnUuIE.chunk.mjs";import{n as l}from"./_plugin-vue2_normalizer-oRdohoZe.chunk.mjs";import{c as n}from"./index-BmkWHhSR.chunk.mjs";import"./index-56SXuvlv-Ca_OzF4R.chunk.mjs";import{I as f,a as w}from"./IconTables-C-somE0B.chunk.mjs";import{S as _}from"./SearchAndSelectOption-Bn11z2MS.chunk.mjs";import{d as r}from"./constants-C1shV9FP.chunk.mjs";import{I as y}from"./Link-BMMtnqd-.chunk.mjs";import{useTablesStore as C}from"./store-Cvxj8Vav.chunk.mjs";import"./vue.runtime.esm-DBajT-mq.chunk.mjs";import"./public-0fz1q1qH.chunk.mjs";import"./_plugin-vue2_normalizer-jrlE7CJU-B-cIoeGj.chunk.mjs";const g={components:{NcSelect:m,SearchAndSelectOption:_},props:{value:{type:Object,default:null}},data(){return{loading:!1,term:null,options:[]}},computed:{getOptions(){return[...this.options].sort((t,e)=>t.quality-e.quality)},localValue:{get(){return this.value},set(t){this.$emit("update:value",t)}}},watch:{term(){this.debounceSubmit()}},mounted(){},methods:{t:i,async loadResultsFromBE(){this.loading=!0;try{const t=await n.get(a("/apps/tables/search/all?term="+this.term));console.debug("res",t),this.options=t.data}catch(t){r(t,i("tables","Could not load search results."))}this.loading=!1},async load(){this.term?.length>=3&&await this.loadResultsFromBE()},debounceSubmit:p(function(){this.load()},500)}};var k=function(){var t=this,e=t._self._c;return e("div",[e("NcSelect",{attrs:{id:"smartpicker-select",loading:t.loading,placeholder:t.t("tables","Search for table and views..."),"aria-label-combobox":t.t("tables","Search for table and views..."),options:t.getOptions},on:{search:o=>t.term=o},scopedSlots:t._u([{key:"option",fn:function(o){return[e("SearchAndSelectOption",{attrs:{label:o.label,emoji:o.emoji,owner:o.owner,"owner-display-name":o.ownerDisplayName,"rows-count":o.rowsCount,type:o.type,subline:o.subline}})]}},{key:"selected-option",fn:function(o){return[e("SearchAndSelectOption",{attrs:{label:o.label,emoji:o.emoji,owner:o.owner,"owner-display-name":o.ownerDisplayName,"rows-count":o.rowsCount,subline:o.subline,type:o.type}})]}}]),model:{value:t.localValue,callback:function(o){t.localValue=o},expression:"localValue"}})],1)},S=[],j=l(g,k,S,!1,null,"378ff41f");const O=j.exports,L={name:"CheckIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var R=function(){var t=this,e=t._self._c;return e("span",t._b({staticClass:"material-design-icon check-icon",attrs:{"aria-hidden":t.title?null:"true","aria-label":t.title,role:"img"},on:{click:function(o){return t.$emit("click",o)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])},I=[],N=l(L,R,I,!1,null,null);const x=N.exports,E={components:{IconTables:w,IconLink:y,IconText:f,IconCheck:x,NcEmptyContent:b,Search:O,NcCheckboxRadioSwitch:v,NcButton:h,LinkReferenceWidget:s(()=>import("./LinkReferenceWidget-CIcrZN12.chunk.mjs"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]),import.meta.url),ContentReferenceWidget:s(()=>import("./ContentReferenceWidget-B9NGkCoK.chunk.mjs"),__vite__mapDeps([9,10,11,4,3,5,6,7,2,8,12,13,14,15,16,17]),import.meta.url),NcLoadingIcon:d},setup(){return{tablesStore:C()}},data(){return{renderMode:"link",value:null,previewLoading:!1,richObject:{}}},computed:{getLink(){if(!this.value)return"";const t=this.renderMode==="content"?"/content":"";return window.location.protocol+"//"+window.location.host+a("/apps/tables/#/"+this.value?.type+"/"+this.value?.value+t)}},watch:{renderMode(){this.updateContent()},value(){this.updateRichObject(),this.updateContent()}},async mounted(){if(!this.tablesStore){const{default:t}=await s(async()=>{const{default:o}=await import("./store-Cvxj8Vav.chunk.mjs");return{default:o}},__vite__mapDeps([16,13,3,14,4,6]),import.meta.url),{default:e}=await s(async()=>{const{default:o}=await import("./data-BYdwMvxA.chunk.mjs").then(c=>c.d);return{default:o}},__vite__mapDeps([12,6,3,4,13,14]),import.meta.url);this.tablesStore=t,this.tablesStore.data=e}},methods:{t:i,n:u,async updateContent(){this.renderMode==="content"?(this.previewLoading=!0,await this.loadColumnsForContentPreview(),await this.loadRowsForContentPreview(),this.previewLoading=!1):(delete this.richObject.rows,delete this.richObject.columns)},selectReference(){this.$emit("submit",this.getLink)},updateRichObject(){this.richObject.emoji=this.value.emoji,this.richObject.link=this.getLink,this.richObject.ownerDisplayName=this.value.ownerDisplayName,this.richObject.ownership=this.value.owner,this.richObject.rowsCount=this.value.rowsCount,this.richObject.title=this.value.label,this.richObject.type=this.value.type,this.richObject.id=this.value.value},async loadColumnsForContentPreview(){if(this.value!==null)try{const t=await n.get(a("/apps/tables/api/1/"+this.value.type+"s/"+this.value.value+"/columns"));console.debug("columns from BE",t.data),this.richObject.columns=t.data}catch(t){r(t,i("tables","Could not fetch columns for content preview."))}},async loadRowsForContentPreview(){if(this.value!==null)try{const t=await n.get(a("/apps/tables/row/"+this.value.type+"/"+this.value.value));console.debug("rows from BE",t.data),this.richObject.rows=t.data}catch(t){r(t,i("tables","Could not fetch rows for content preview."))}}}};var T=function(){var t=this,e=t._self._c;return e("div",{staticClass:"picker-content"},[e("h2",{staticClass:"picker-title"},[t._v(" "+t._s(t.t("tables","Nextcloud Tables"))+" ")]),e("div",{staticClass:"selection-wrapper"},[e("div",{staticClass:"selection"},[e("div",{staticClass:"space-T space-B"},[e("Search",{attrs:{value:t.value},on:{"update:value":function(o){t.value=o}}})],1),e("div",{staticClass:"space-T space-B"},[e("h3",[t._v(t._s(t.t("tables","Render mode")))]),e("div",{staticClass:"radio"},[e("NcCheckboxRadioSwitch",{attrs:{checked:t.renderMode,value:"link",name:"render-mode",type:"radio"},on:{"update:checked":function(o){t.renderMode=o}}},[e("IconLink",{attrs:{size:20}}),t._v(t._s(t.t("tables","Link"))+" ")],1),e("NcCheckboxRadioSwitch",{attrs:{checked:t.renderMode,value:"content",name:"render-mode",type:"radio"},on:{"update:checked":function(o){t.renderMode=o}}},[e("IconText",{attrs:{size:20}}),t._v(t._s(t.t("tables","Content"))+" ")],1)],1)]),t.getLink?e("div",{staticClass:"space-T space-B"},[e("h3",[t._v(t._s(t.t("tables","Preview")))]),e("div",{staticClass:"preview space-T"},[t.previewLoading?e("div",[e("NcLoadingIcon")],1):e("div",[t.renderMode==="link"?e("LinkReferenceWidget",{attrs:{"rich-object":t.richObject}}):t._e(),t.renderMode==="content"?e("ContentReferenceWidget",{attrs:{"rich-object":t.richObject}}):t._e()],1)])]):e("NcEmptyContent",{scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconTables")]},proxy:!0}])})],1)]),e("div",{staticClass:"select-button"},[e("NcButton",{attrs:{type:"primary",disabled:t.value===null,"aria-label":t.t("tables","Select")},on:{click:t.selectReference},scopedSlots:t._u([{key:"icon",fn:function(){return[e("IconCheck",{attrs:{size:20}})]},proxy:!0}])},[t._v(" "+t._s(t.t("tables","Insert"))+" ")])],1)])},M=[],B=l(E,T,M,!1,null,"e31c4790");const Q=B.exports;export{Q as default};
//# sourceMappingURL=SmartPicker-BJa3HyOL.chunk.mjs.map
