(()=>{(self.webpackChunktalk=self.webpackChunktalk||[]).push([["files-sidebar-tab-chunk"],{54529:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".chatView[data-v-18b378b3]{width:100%;height:100%;display:flex;flex-direction:column;flex-grow:1;min-height:0}.messages-list-dragover-wrapper[data-v-18b378b3]{position:relative;flex:1 0;display:flex;min-height:0}.dragover[data-v-18b378b3]{position:absolute;inset:5%;background:var(--color-primary-element-light);z-index:11;display:flex;box-shadow:0 0 36px var(--color-box-shadow);border-radius:var(--border-radius);opacity:90%;pointer-events:none}.scroll-to-bottom[data-v-18b378b3]{position:relative;height:0}.scroll-to-bottom__button[data-v-18b378b3]{position:absolute !important;bottom:8px;inset-inline-end:24px;z-index:2}","",{version:3,sources:["webpack://./src/components/ChatView.vue"],names:[],mappings:"AACA,2BACC,UAAA,CACA,WAAA,CACA,YAAA,CACA,qBAAA,CACA,WAAA,CACA,YAAA,CAGD,iDACC,iBAAA,CACA,QAAA,CACA,YAAA,CACA,YAAA,CAGD,2BACC,iBAAA,CACA,QAAA,CACA,6CAAA,CACA,UAAA,CACA,YAAA,CACA,2CAAA,CACA,kCAAA,CACA,WAAA,CACA,mBAAA,CAGD,mCACC,iBAAA,CACA,QAAA,CAEA,2CACC,4BAAA,CACA,UAAA,CACA,qBAAA,CACA,SAAA",sourceRoot:""}]);const r=l},1030:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".empty-view[data-v-51aa65e6]{height:100%;padding:calc(var(--default-grid-baseline)*4)}","",{version:3,sources:["webpack://./src/components/EmptyView.vue"],names:[],mappings:"AACA,6BACC,WAAA,CACA,4CAAA",sourceRoot:""}]);const r=l},77672:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".modal__content[data-v-b3fb2702]{padding:calc(var(--default-grid-baseline)*3);background-color:var(--color-main-background)}.conversation-information[data-v-b3fb2702]{margin-top:5px;display:flex;flex-direction:column;align-items:center}.description[data-v-b3fb2702]{margin-bottom:12px;max-height:8lh;overflow-x:hidden;overflow-y:auto;text-overflow:ellipsis}.username-form__input[data-v-b3fb2702]{margin-bottom:20px}.submit-button[data-v-b3fb2702]{margin:0 auto}.login-info[data-v-b3fb2702]{display:flex;align-items:center;gap:calc(var(--default-grid-baseline)*2);padding-top:calc(var(--default-grid-baseline)*2)}.separator[data-v-b3fb2702]{margin:calc(var(--default-grid-baseline)*5) 0 var(--default-grid-baseline);border-top:1px solid}","",{version:3,sources:["webpack://./src/components/GuestWelcomeWindow.vue"],names:[],mappings:"AACA,iCACC,4CAAA,CACA,6CAAA,CAGD,2CACC,cAAA,CACA,YAAA,CACA,qBAAA,CACA,kBAAA,CAGD,8BACC,kBAAA,CACA,cAAA,CACA,iBAAA,CACA,eAAA,CACA,sBAAA,CAGD,uCACC,kBAAA,CAGD,gCACC,aAAA,CAGD,6BACC,YAAA,CACA,kBAAA,CACA,wCAAA,CACA,gDAAA,CAGD,4BACI,0EAAA,CACA,oBAAA",sourceRoot:""}]);const r=l},65394:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".media-devices-selector[data-v-1c8a36b0]{display:flex;gap:var(--default-grid-baseline);margin:calc(3*var(--default-grid-baseline)) 0}.media-devices-selector__icon[data-v-1c8a36b0]{display:flex;justify-content:center;align-items:center;width:var(--default-clickable-area);flex-shrink:0}.media-devices-selector[data-v-1c8a36b0] .v-select.select{width:100%}","",{version:3,sources:["webpack://./src/components/MediaSettings/MediaDevicesSelector.vue"],names:[],mappings:"AACA,yCACC,YAAA,CACA,gCAAA,CACA,6CAAA,CAEA,+CACC,YAAA,CACA,sBAAA,CACA,kBAAA,CACA,mCAAA,CACA,aAAA,CAGD,0DACC,UAAA",sourceRoot:""}]);const r=l},59713:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".media-devices-checker[data-v-8e69121a]{display:flex;gap:var(--default-grid-baseline);margin:calc(3*var(--default-grid-baseline)) 0}.media-devices-checker__icon[data-v-8e69121a]{display:flex;justify-content:center;align-items:center;width:var(--default-clickable-area);flex-shrink:0}.media-devices-checker .equalizer[data-v-8e69121a]{margin-inline-start:8px;height:var(--default-clickable-area);display:flex;align-items:center}.media-devices-checker .equalizer__bar[data-v-8e69121a]{width:8px;height:100%;background:var(--color-primary-element);border-radius:4px;margin:0 2px;will-change:height;animation:equalizer-8e69121a 2s steps(15, end) infinite}@keyframes equalizer-8e69121a{0%{height:79%}4%{height:27%}8%{height:26%}12%{height:68%}16%{height:48%}20%{height:86%}24%{height:80%}28%{height:48%}32%{height:53%}36%{height:75%}40%{height:35%}44%{height:59%}48%{height:82%}52%{height:58%}56%{height:48%}60%{height:35%}}","",{version:3,sources:["webpack://./src/components/MediaSettings/MediaDevicesSpeakerTest.vue"],names:[],mappings:"AAGA,wCACC,YAAA,CACA,gCAAA,CACA,6CAAA,CAEA,8CACC,YAAA,CACA,sBAAA,CACA,kBAAA,CACA,mCAAA,CACA,aAAA,CAGD,mDACC,uBAAA,CACA,oCAAA,CACA,YAAA,CACA,kBAAA,CAEA,wDACC,SAAA,CACA,WAAA,CACA,uCAAA,CACA,iBAAA,CACA,YAAA,CACA,kBAAA,CACA,uDAAA,CAKH,8BAEE,GAAA,UAAA,CAAA,GAAA,UAAA,CAAA,GAAA,UAAA,CAAA,IAAA,UAAA,CAAA,IAAA,UAAA,CAAA,IAAA,UAAA,CAAA,IAAA,UAAA,CAAA,IAAA,UAAA,CAAA,IAAA,UAAA,CAAA,IAAA,UAAA,CAAA,IAAA,UAAA,CAAA,IAAA,UAAA,CAAA,IAAA,UAAA,CAAA,IAAA,UAAA,CAAA,IAAA,UAAA,CAAA,IAAA,UAAA,CAAA",sourceRoot:""}]);const r=l},7196:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".media-settings[data-v-7c03922a]{padding:calc(var(--default-grid-baseline)*5);padding-bottom:0}.media-settings__preview[data-v-7c03922a]{position:relative;margin:0 auto calc(var(--default-grid-baseline)*4);display:flex;align-items:center;justify-content:center;border-radius:var(--border-radius-element, var(--border-radius-large));background-color:var(--color-loading-dark);width:100%;aspect-ratio:4/3}.media-settings__preview>.media-settings__preview-mirror[data-v-7c03922a]{position:absolute;top:calc(var(--default-grid-baseline)*2);inset-inline-end:calc(var(--default-grid-baseline)*2)}.media-settings__toggles[data-v-7c03922a]{display:flex;position:absolute;bottom:calc(var(--default-grid-baseline)*-2);background:var(--color-main-background);border-radius:var(--border-radius-element, calc(var(--default-clickable-area) / 2));box-shadow:0 0 var(--default-grid-baseline) var(--color-box-shadow)}.media-settings__call-buttons[data-v-7c03922a]{display:flex;z-index:1;align-items:center;justify-content:center;gap:var(--default-grid-baseline);position:sticky;bottom:0;background-color:var(--color-main-background);padding:10px 0 20px}.preview__video[data-v-7c03922a]{max-width:100%;object-fit:contain;max-height:100%;border-radius:var(--border-radius-element)}.preview__video--mirrored[data-v-7c03922a]{transform:none !important}.preview__novideo[data-v-7c03922a]{position:relative;display:flex;align-items:center;justify-content:center;overflow:hidden;width:100%;height:100%;border-radius:var(--border-radius-element)}.call-button[data-v-7c03922a]{display:flex;justify-content:center;align-items:center}.checkbox[data-v-7c03922a]{display:flex;justify-content:center;margin:calc(var(--default-grid-baseline)*2)}.checkbox--warning[data-v-7c03922a]:focus-within .checkbox-radio-switch__label,.checkbox--warning[data-v-7c03922a] .checkbox-radio-switch__label:hover{background-color:var(--note-background) !important}[data-v-7c03922a] .modal-wrapper--normal > .modal-container{max-width:500px !important}","",{version:3,sources:["webpack://./src/components/MediaSettings/MediaSettings.vue"],names:[],mappings:"AACA,iCACC,4CAAA,CACA,gBAAA,CAEA,0CACC,iBAAA,CACA,kDAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,sEAAA,CACA,0CAAA,CACA,UAAA,CACA,gBAAA,CAGD,0EACC,iBAAA,CACA,wCAAA,CACA,qDAAA,CAGD,0CACC,YAAA,CACA,iBAAA,CACA,4CAAA,CACA,uCAAA,CACA,mFAAA,CACA,mEAAA,CAGD,+CACC,YAAA,CACA,SAAA,CACA,kBAAA,CACA,sBAAA,CACA,gCAAA,CACA,eAAA,CACA,QAAA,CACA,6CAAA,CACA,mBAAA,CAKD,iCACC,cAAA,CACA,kBAAA,CACA,eAAA,CACA,0CAAA,CAEA,2CACC,yBAAA,CAIF,mCACC,iBAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,eAAA,CACA,UAAA,CACA,WAAA,CACA,0CAAA,CAIF,8BACC,YAAA,CACA,sBAAA,CACA,kBAAA,CAGD,2BACC,YAAA,CACA,sBAAA,CACA,2CAAA,CAGC,uJAEC,kDAAA,CAKH,4DACC,0BAAA",sourceRoot:""}]);const r=l},16744:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".tab-list[data-v-4a409665]{display:flex;justify-content:center;align-items:center;gap:calc(var(--default-grid-baseline)*2)}.tab-panels-container[data-v-4a409665]{display:flex;width:100%;overflow:hidden;transition:height ease var(--animation-slow)}.tab-panel[data-v-4a409665]{width:100%;flex:1 0 100%;transition:transform ease var(--animation-slow)}","",{version:3,sources:["webpack://./src/components/MediaSettings/MediaSettingsTabs.vue"],names:[],mappings:"AACA,2BACC,YAAA,CACA,sBAAA,CACA,kBAAA,CACA,wCAAA,CAGD,uCACC,YAAA,CACA,UAAA,CACA,eAAA,CACA,4CAAA,CAGD,4BACC,UAAA,CACA,aAAA,CACA,+CAAA",sourceRoot:""}]);const r=l},6925:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".background-editor[data-v-46481b48]{display:grid;grid-template-columns:repeat(4, 1fr);gap:calc(var(--default-grid-baseline)*2);margin-top:calc(var(--default-grid-baseline)*2)}.background-editor__element[data-v-46481b48]{border:none;margin:0 !important;border-radius:var(--border-radius-element, calc(var(--border-radius-large) * 1.5));height:calc(var(--default-grid-baseline)*16);display:flex;flex-direction:column;justify-content:center;align-items:center;background-color:rgba(28,175,255,.1803921569);background-size:cover;background-position:center;flex:1 0 108px}.background-editor__element--selected[data-v-46481b48]{box-shadow:inset 0 0 0 var(--default-grid-baseline) var(--color-primary-element)}.background-editor__element[data-v-46481b48]:focus-visible{outline-offset:-2px}","",{version:3,sources:["webpack://./src/components/MediaSettings/VideoBackgroundEditor.vue"],names:[],mappings:"AACA,oCACC,YAAA,CACA,oCAAA,CACA,wCAAA,CACA,+CAAA,CAEA,6CACC,WAAA,CACA,mBAAA,CACA,kFAAA,CACA,4CAAA,CACA,YAAA,CACA,qBAAA,CACA,sBAAA,CACA,kBAAA,CACA,6CAAA,CACA,qBAAA,CACA,0BAAA,CACA,cAAA,CAEA,uDACC,gFAAA,CAGD,2DAEC,mBAAA",sourceRoot:""}]);const r=l},59083:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,'.message[data-v-61667449]{position:relative}.message:hover .normal-message-body[data-v-61667449],.message:hover .combined-system[data-v-61667449],.message--hovered .normal-message-body[data-v-61667449]{border-radius:8px;background-color:var(--color-background-hover)}.message-body[data-v-61667449]{padding:var(--default-grid-baseline);font-size:var(--default-font-size);line-height:var(--default-line-height);position:relative}.message-body__scroll[data-v-61667449]{position:absolute;top:0;inset-inline-end:0;width:fit-content;height:100%;padding:8px 8px 0 0}.message--highlighted[data-v-61667449]{animation:highlight-animation-61667449 5s 1;border-radius:8px}@keyframes highlight-animation-61667449{0%{background-color:var(--color-background-hover)}50%{background-color:var(--color-background-hover)}100%{background-color:rgba(var(--color-background-hover), 0)}}.message-unread-marker[data-v-61667449]{position:relative;margin:calc(4*var(--default-grid-baseline))}.message-unread-marker[data-v-61667449]::before{content:"";width:100%;border-top:1px solid var(--color-border-maxcontrast);position:absolute;top:50%;z-index:-1}.message-unread-marker__wrapper[data-v-61667449]{display:flex;justify-content:center;align-items:center;gap:calc(3*var(--default-grid-baseline));margin-inline:auto;padding-inline:calc(3*var(--default-grid-baseline));width:fit-content;border-radius:var(--border-radius);background-color:var(--color-main-background)}.message-unread-marker__text[data-v-61667449]{text-align:center;white-space:nowrap;font-weight:bold;color:var(--color-main-text)}.message-buttons-bar[data-v-61667449]{display:flex;inset-inline-end:14px;top:0;position:sticky;background-color:var(--color-main-background);border-radius:var(--border-radius-element, calc(var(--default-clickable-area) / 2));box-shadow:0 0 4px 0 var(--color-box-shadow);height:var(--default-clickable-area);z-index:1}',"",{version:3,sources:["webpack://./src/components/MessagesList/MessagesGroup/Message/Message.vue"],names:[],mappings:"AACA,0BACC,iBAAA,CAEA,8JAGC,iBAAA,CACA,8CAAA,CAIF,+BACC,oCAAA,CACA,kCAAA,CACA,sCAAA,CACA,iBAAA,CAEA,uCACC,iBAAA,CACA,KAAA,CACA,kBAAA,CACA,iBAAA,CACA,WAAA,CACA,mBAAA,CAIF,uCACC,2CAAA,CACA,iBAAA,CAGD,wCACC,GAAA,8CAAA,CACA,IAAA,8CAAA,CACA,KAAA,uDAAA,CAAA,CAGD,wCACC,iBAAA,CACA,2CAAA,CAEA,gDACC,UAAA,CACA,UAAA,CACA,oDAAA,CACA,iBAAA,CACA,OAAA,CACA,UAAA,CAGD,iDACC,YAAA,CACA,sBAAA,CACA,kBAAA,CACA,wCAAA,CACA,kBAAA,CACA,mDAAA,CACA,iBAAA,CACA,kCAAA,CACA,6CAAA,CAGD,8CACC,iBAAA,CACA,kBAAA,CACA,gBAAA,CACA,4BAAA,CAIF,sCACC,YAAA,CACA,qBAAA,CACA,KAAA,CACA,eAAA,CACA,6CAAA,CACA,mFAAA,CACA,4CAAA,CACA,oCAAA,CACA,SAAA",sourceRoot:""}]);const r=l},76384:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".edit-timestamp[data-v-8025549a] .action-text__longtext-wrapper{padding:0}","",{version:3,sources:["webpack://./src/components/MessagesList/MessagesGroup/Message/MessageButtonsBar/MessageButtonsBar.vue"],names:[],mappings:"AACA,gEACC,SAAA",sourceRoot:""}]);const r=l},93003:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".translate-dialog[data-v-6dd63ec4] .dialog__content{position:relative;display:flex;flex-direction:column;gap:calc(var(--default-grid-baseline)*2);min-height:300px;padding-bottom:calc(var(--default-grid-baseline)*3)}.translate-dialog__wrapper[data-v-6dd63ec4]{display:flex;align-items:center;gap:calc(var(--default-grid-baseline)*4)}.translate-dialog .translate-dialog__select[data-v-6dd63ec4]{width:50%}.translate-dialog__button[data-v-6dd63ec4]{flex-shrink:0;margin-inline-start:auto}.translate-dialog__message[data-v-6dd63ec4]{padding:calc(var(--default-grid-baseline)*2);flex-grow:1;border-radius:var(--border-radius-large)}.translate-dialog__message-source[data-v-6dd63ec4]{color:var(--color-text-maxcontrast);border:2px solid var(--color-border)}.translate-dialog__message-translation[data-v-6dd63ec4]{border:2px solid var(--color-primary-element)}","",{version:3,sources:["webpack://./src/components/MessagesList/MessagesGroup/Message/MessageButtonsBar/MessageTranslateDialog.vue"],names:[],mappings:"AAEC,oDACC,iBAAA,CACA,YAAA,CACA,qBAAA,CACA,wCAAA,CACA,gBAAA,CACA,mDAAA,CAGD,4CACC,YAAA,CACA,kBAAA,CACA,wCAAA,CAGD,6DACC,SAAA,CAGD,2CACC,aAAA,CACA,wBAAA,CAGD,4CACC,4CAAA,CACA,WAAA,CACA,wCAAA,CAEA,mDACC,mCAAA,CACA,oCAAA,CAGD,wDACC,6CAAA",sourceRoot:""}]);const r=l},92510:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".contact[data-v-e44aa098]{display:flex;transition:box-shadow .1s ease-in-out;border:1px solid var(--color-border);box-shadow:0 0 2px 0 var(--color-box-shadow);border-radius:var(--border-radius-large);font-size:100%;background-color:var(--color-main-background);margin:12px 0;max-width:300px;padding:12px;white-space:nowrap;align-items:center}.contact[data-v-e44aa098]:hover,.contact[data-v-e44aa098]:focus{box-shadow:0 0 5px 0 var(--color-box-shadow)}.contact__image[data-v-e44aa098]{display:inline-block;border-radius:50%;max-width:var(--clickable-area-large);max-height:var(--clickable-area-large)}.contact__icon[data-v-e44aa098]{display:inline-block;width:var(--clickable-area-large);height:var(--clickable-area-large)}.contact__lineone[data-v-e44aa098]{height:30px;display:flex;justify-content:flex-start;align-items:center;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.contact__lineone .title[data-v-e44aa098]{margin-inline-start:12px}.icon-contacts[data-v-e44aa098]{opacity:.8}","",{version:3,sources:["webpack://./src/components/MessagesList/MessagesGroup/Message/MessagePart/Contact.vue"],names:[],mappings:"AACA,0BACC,YAAA,CACA,qCAAA,CACA,oCAAA,CACA,4CAAA,CACA,wCAAA,CACA,cAAA,CACA,6CAAA,CACA,aAAA,CACA,eAAA,CACA,YAAA,CACA,kBAAA,CACA,kBAAA,CACA,gEAEC,4CAAA,CAED,iCACC,oBAAA,CACA,iBAAA,CACA,qCAAA,CACA,sCAAA,CAED,gCACC,oBAAA,CACA,iCAAA,CACA,kCAAA,CAED,mCACC,WAAA,CACA,YAAA,CACA,0BAAA,CACA,kBAAA,CACA,eAAA,CACA,kBAAA,CACA,sBAAA,CAEA,0CACC,wBAAA,CAKH,gCACC,UAAA",sourceRoot:""}]);const r=l},35304:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".deck-card[data-v-db6a7cf8]{display:flex;border:2px solid var(--color-border);border-radius:var(--border-radius-large);font-size:100%;background-color:var(--color-main-background);max-width:300px;padding:8px 16px;flex-direction:column;white-space:nowrap;transition:border-color .1s ease-in-out}.deck-card[data-v-db6a7cf8]:hover,.deck-card[data-v-db6a7cf8]:focus,.deck-card[data-v-db6a7cf8]:focus-visible{border-color:var(--color-primary-element);outline:none}.deck-card__lineone[data-v-db6a7cf8]{height:30px;display:flex;justify-content:flex-start;align-items:center;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.deck-card__lineone .title[data-v-db6a7cf8]{margin-inline-start:8px}.deck-card__linetwo[data-v-db6a7cf8]{height:30px;color:var(--color-text-maxcontrast);overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.icon-deck[data-v-db6a7cf8]{opacity:.8}.wide[data-v-db6a7cf8]{max-width:400px;width:100%}","",{version:3,sources:["webpack://./src/components/MessagesList/MessagesGroup/Message/MessagePart/DeckCard.vue"],names:[],mappings:"AACA,4BACC,YAAA,CACA,oCAAA,CACA,wCAAA,CACA,cAAA,CACA,6CAAA,CACA,eAAA,CACA,gBAAA,CACA,qBAAA,CACA,kBAAA,CACA,uCAAA,CAEA,8GAGC,yCAAA,CACA,YAAA,CAGD,qCACC,WAAA,CACA,YAAA,CACA,0BAAA,CACA,kBAAA,CACA,eAAA,CACA,kBAAA,CACA,sBAAA,CAEA,4CACC,uBAAA,CAIF,qCACC,WAAA,CACA,mCAAA,CACA,eAAA,CACA,kBAAA,CACA,sBAAA,CAIF,4BACC,UAAA,CAGD,uBACC,eAAA,CACA,UAAA",sourceRoot:""}]);const r=l},82085:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".location[data-v-34c47c84]{display:flex;flex-direction:column;position:relative;z-index:1;white-space:initial;overflow:hidden;border-radius:var(--border-radius-large);height:300px;max-height:30vh;margin:4px;transition:outline .1s ease-in-out}.location[data-v-34c47c84]:hover,.location[data-v-34c47c84]:focus,.location[data-v-34c47c84]:focus-visible{outline:2px solid var(--color-primary-element)}.location.wide[data-v-34c47c84]{width:100%;height:100%;margin:0}","",{version:3,sources:["webpack://./src/components/MessagesList/MessagesGroup/Message/MessagePart/Location.vue"],names:[],mappings:"AACA,2BACC,YAAA,CACA,qBAAA,CACA,iBAAA,CACA,SAAA,CACA,mBAAA,CACA,eAAA,CACA,wCAAA,CACA,YAAA,CACA,eAAA,CACA,UAAA,CACA,kCAAA,CAEA,2GAGC,8CAAA,CAGD,gCACC,UAAA,CACA,WAAA,CACA,QAAA",sourceRoot:""}]);const r=l},90630:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".mention[data-v-37e5c889]{display:contents;white-space:nowrap}","",{version:3,sources:["webpack://./src/components/MessagesList/MessagesGroup/Message/MessagePart/Mention.vue"],names:[],mappings:"AACA,0BACC,gBAAA,CACA,kBAAA",sourceRoot:""}]);const r=l},19389:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".message-main[data-v-1e850aa1]{display:grid;grid-template-columns:minmax(0, calc(50 * var(--default-font-size))) calc(8ch + var(--clickable-area-small, 24px) + 4*var(--default-grid-baseline));grid-row-gap:var(--default-grid-baseline);justify-content:space-between;align-items:flex-start;min-width:100%}.message-main__text[data-v-1e850aa1]{width:100%;color:var(--color-text-light)}.message-main__text>.single-emoji[data-v-1e850aa1]{font-size:250%;line-height:100%}.message-main__text.system-message[data-v-1e850aa1]{color:var(--color-text-maxcontrast);text-align:center;padding:0 20px}.message-main__text.message-highlighted[data-v-1e850aa1]{color:var(--color-text-light);background-color:var(--color-primary-element-light);padding:10px;border-radius:var(--border-radius-large);text-align:center}.message-main__text.deleted-message[data-v-1e850aa1]{display:flex;align-items:center;color:var(--color-text-maxcontrast)}.message-main__text.deleted-message[data-v-1e850aa1] .rich-text--wrapper{flex-grow:1;text-align:start}.message-main__text.markdown-message[data-v-1e850aa1]{position:relative}.message-main__text.markdown-message .message-copy-code[data-v-1e850aa1]{position:absolute;top:0;inset-inline-end:calc(4px + var(--default-clickable-area));margin-top:4px;background-color:var(--color-background-dark)}.message-main__text.markdown-message[data-v-1e850aa1] .rich-text--wrapper{text-align:start}.message-main__text.markdown-message[data-v-1e850aa1] .rich-text--wrapper h4{font-size:100%}.message-main__text.markdown-message[data-v-1e850aa1] .rich-text--wrapper em{font-style:italic}.message-main__text.markdown-message[data-v-1e850aa1] .rich-text--wrapper ul,.message-main__text.markdown-message[data-v-1e850aa1] .rich-text--wrapper ol{padding-left:0;padding-inline-start:15px}.message-main__text.markdown-message[data-v-1e850aa1] .rich-text--wrapper ul.contains-task-list,.message-main__text.markdown-message[data-v-1e850aa1] .rich-text--wrapper ol.contains-task-list{padding:0}.message-main__text.markdown-message[data-v-1e850aa1] .rich-text--wrapper input:disabled+.checkbox-content{opacity:1 !important}.message-main__text.markdown-message[data-v-1e850aa1] .rich-text--wrapper div:has(table){overflow-x:auto}.message-main__text.markdown-message[data-v-1e850aa1] .rich-text--wrapper pre{width:calc(100% - var(--default-clickable-area));padding:4px;margin:2px 0;border-radius:var(--border-radius);background-color:var(--color-background-dark);overflow-x:auto}.message-main__text.markdown-message[data-v-1e850aa1] .rich-text--wrapper pre code{margin:0;padding:0}.message-main__text.markdown-message[data-v-1e850aa1] .rich-text--wrapper code{display:inline-block;padding:2px 4px;margin:2px 0;border-radius:var(--border-radius);background-color:var(--color-background-dark)}.message-main__text.markdown-message[data-v-1e850aa1] .rich-text--wrapper blockquote{padding-left:0;padding-inline-start:13px;border-left:none;border-inline-start:4px solid var(--color-border)}.message-main__info[data-v-1e850aa1]{position:relative;user-select:none;display:flex;justify-content:flex-end;color:var(--color-text-maxcontrast);font-size:var(--default-font-size);width:calc(8ch + var(--clickable-area-small, 24px) + 4*var(--default-grid-baseline));padding-inline:calc(2*var(--default-grid-baseline))}.message-main__info .date[data-v-1e850aa1]{width:8ch;text-align:end}.message-main__info .date--hidden[data-v-1e850aa1]{pointer-events:none;opacity:0}.message-main__info .date[data-v-1e850aa1]:last-child{margin-inline-end:var(--clickable-area-small, 24px)}.message-status[data-v-1e850aa1]{width:var(--clickable-area-small, 24px);height:var(--clickable-area-small, 24px);display:flex;justify-content:center;align-items:center}.message-status.retry-option[data-v-1e850aa1]{cursor:pointer}[data-v-1e850aa1] .rich-text--wrapper{direction:inherit}[data-v-1e850aa1] .rich-text--wrapper pre{direction:ltr}[data-v-1e850aa1] .widget-default--image{max-width:240px}","",{version:3,sources:["webpack://./src/components/MessagesList/MessagesGroup/Message/MessagePart/MessageBody.vue","webpack://./src/assets/markdown.scss","webpack://./src/assets/variables.scss"],names:[],mappings:"AAIA,+BACC,YAAA,CACA,mJAAA,CACA,yCAAA,CACA,6BAAA,CACA,sBAAA,CACA,cAAA,CAEA,qCACC,UAAA,CACA,6BAAA,CAEA,mDACC,cAAA,CACA,gBAAA,CAGD,oDACC,mCAAA,CACA,iBAAA,CACA,cAAA,CAGD,yDACC,6BAAA,CACA,mDAAA,CACA,YAAA,CACA,wCAAA,CACA,iBAAA,CAGD,qDACC,YAAA,CACA,kBAAA,CACA,mCAAA,CACA,yEACC,WAAA,CACA,gBAAA,CAIF,sDACC,iBAAA,CAEA,yEACC,iBAAA,CACA,KAAA,CACA,0DAAA,CACA,cAAA,CACA,6CAAA,CAGD,0EACC,gBAAA,CClDH,6EACC,cAAA,CAGD,6EACC,iBAAA,CAGD,0JAGC,cAAA,CACA,yBAAA,CAEA,gMACC,SAAA,CAIF,2GACC,oBAAA,CAGD,yFACC,eAAA,CAGD,8EACC,gDAAA,CACA,WAAA,CACA,YAAA,CACA,kCAAA,CACA,6CAAA,CACA,eAAA,CAEA,mFACC,QAAA,CACA,SAAA,CAIF,+EACC,oBAAA,CACA,eAAA,CACA,YAAA,CACA,kCAAA,CACA,6CAAA,CAGD,qFAEC,cAAA,CACA,yBAAA,CAEA,gBAAA,CACA,iDAAA,CDCD,qCACC,iBAAA,CACA,gBAAA,CACA,YAAA,CACA,wBAAA,CACA,mCAAA,CACA,kCAAA,CACA,oFExDoB,CFyDpB,mDAAA,CAEA,2CACC,SAAA,CACA,cAAA,CAEA,mDACC,mBAAA,CACA,SAAA,CAGD,sDACC,mDAAA,CAMJ,iCACC,uCAAA,CACA,wCAAA,CACA,YAAA,CACA,sBAAA,CACA,kBAAA,CAEA,8CACC,cAAA,CAIF,sCACC,iBAAA,CAID,0CACC,aAAA,CAID,yCACC,eAAA",sourceRoot:""}]);const r=l},47618:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".poll-card[data-v-57b5ff68]{position:relative;display:block;max-width:300px;padding:calc(3*var(--default-grid-baseline)) calc(2*var(--default-grid-baseline));border:2px solid var(--color-border);border-radius:var(--border-radius-large);background:var(--color-main-background);transition:border-color .1s ease-in-out}.poll-card[data-v-57b5ff68]:hover,.poll-card[data-v-57b5ff68]:focus,.poll-card[data-v-57b5ff68]:focus-visible{border-color:var(--color-primary-element);outline:none}.poll-card__header[data-v-57b5ff68]{display:flex;align-items:flex-start;gap:calc(2*var(--default-grid-baseline));margin-bottom:16px;font-weight:bold;white-space:normal;word-wrap:anywhere}.poll-card__header--draft[data-v-57b5ff68]{gap:var(--default-grid-baseline)}.poll-card__header-name[data-v-57b5ff68]{margin-inline-end:auto;align-self:center}.poll-card__header-icon[data-v-57b5ff68]{height:var(--default-clickable-area);margin-bottom:auto}.poll-card__footer[data-v-57b5ff68]{color:var(--color-text-maxcontrast);white-space:normal}.poll-closed[data-v-57b5ff68]{margin:4px auto}","",{version:3,sources:["webpack://./src/components/MessagesList/MessagesGroup/Message/MessagePart/Poll.vue"],names:[],mappings:"AACA,4BACC,iBAAA,CACA,aAAA,CACA,eAAA,CACA,iFAAA,CACA,oCAAA,CACA,wCAAA,CACA,uCAAA,CACA,uCAAA,CAEA,8GAGC,yCAAA,CACA,YAAA,CAGD,oCACC,YAAA,CACA,sBAAA,CACA,wCAAA,CACA,kBAAA,CACA,gBAAA,CACA,kBAAA,CACA,kBAAA,CAEA,2CACC,gCAAA,CAGD,yCACC,sBAAA,CACA,iBAAA,CAGD,yCACC,oCAAA,CACA,kBAAA,CAIF,oCACC,mCAAA,CACA,kBAAA,CAIF,8BACC,eAAA",sourceRoot:""}]);const r=l},34469:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,'.reactions-wrapper[data-v-4b4afe76]{--minimal-button-width: 48px;--font-family-emoji: "Segoe UI Emoji", "Segoe UI Symbol", "Segoe UI", "Apple Color Emoji", "Twemoji Mozilla", "Noto Color Emoji", "EmojiOne Color", "Android Emoji";display:flex;flex-wrap:wrap;gap:var(--default-grid-baseline)}.reactions-wrapper[data-v-4b4afe76] .button-vue{min-width:var(--minimal-button-width)}.reactions-wrapper[data-v-4b4afe76] .button-vue__text{font-weight:normal}.reactions-wrapper .reaction-emoji[data-v-4b4afe76]{font-family:var(--font-family-emoji)}.reactions-wrapper .reaction-button--thumbnail[data-v-4b4afe76]{height:var(--clickable-area-small);width:var(--minimal-button-width);pointer-events:none}.reaction-details[data-v-4b4afe76]{padding:8px;max-width:250px}.details-loading[data-v-4b4afe76]{display:flex;justify-content:center;width:38px}.more-reactions-button[data-v-4b4afe76]{text-decoration:underline}.more-reactions-button[data-v-4b4afe76]:hover{text-decoration:none}',"",{version:3,sources:["webpack://./src/components/MessagesList/MessagesGroup/Message/MessagePart/Reactions.vue"],names:[],mappings:"AACA,oCACC,4BAAA,CACA,mKAAA,CACA,YAAA,CACA,cAAA,CACA,gCAAA,CAGA,gDACC,qCAAA,CAED,sDACC,kBAAA,CAGD,oDACC,oCAAA,CAGD,gEACC,kCAAA,CACA,iCAAA,CACA,mBAAA,CAIF,mCACC,WAAA,CACA,eAAA,CAGD,kCACC,YAAA,CACA,sBAAA,CACA,UAAA,CAGD,wCACC,yBAAA,CACA,8CACC,oBAAA",sourceRoot:""}]);const r=l},30346:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".reactions__modal[data-v-6216fb6a]{min-height:450px;padding-bottom:calc(3*var(--default-grid-baseline))}.reactions-list__navigation[data-v-6216fb6a]{display:flex;gap:2px;flex-wrap:wrap}.reactions-list__navigation[data-v-6216fb6a] .button-vue{border-radius:var(--border-radius-large)}.reactions-list__navigation[data-v-6216fb6a] .button-vue.active{background-color:var(--color-primary-element-light)}.all-reactions__button[data-v-6216fb6a] .button-vue__text{display:inline-flex;gap:4px}.reactions-list__scrollable[data-v-6216fb6a]{overflow-y:auto;overflow-x:hidden;height:327px}.reactions-item[data-v-6216fb6a]{display:flex;align-items:center;gap:8px;width:100%;padding:6px 0}.reactions-item__name[data-v-6216fb6a]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.reactions-item__emojis[data-v-6216fb6a]{margin-inline-start:auto;max-width:180px;direction:rtl;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;position:relative}","",{version:3,sources:["webpack://./src/components/MessagesList/MessagesGroup/Message/MessagePart/ReactionsList.vue"],names:[],mappings:"AACA,mCACC,gBAAA,CACA,mDAAA,CAGD,6CACC,YAAA,CACA,OAAA,CACA,cAAA,CAEA,yDACC,wCAAA,CAEA,gEACC,mDAAA,CAKH,0DACC,mBAAA,CACA,OAAA,CAGD,6CACC,eAAA,CACA,iBAAA,CACA,YAAA,CAGD,iCACC,YAAA,CACA,kBAAA,CACA,OAAA,CACA,UAAA,CACA,aAAA,CAEA,uCACC,kBAAA,CACA,eAAA,CACA,sBAAA,CAGD,yCACC,wBAAA,CACA,eAAA,CACA,aAAA,CACA,mBAAA,CACA,oBAAA,CACA,2BAAA,CACA,eAAA,CACA,iBAAA",sourceRoot:""}]);const r=l},64555:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".wrapper[data-v-77e4c704]{display:flex;align-items:flex-start;width:100%;padding:0}.wrapper[data-v-77e4c704]:focus{background-color:rgba(47,47,47,.068)}.messages[data-v-77e4c704]{flex:auto;display:flex;padding:var(--default-grid-baseline) 0;flex-direction:column;width:100%;min-width:0}.messages__avatar[data-v-77e4c704]{position:sticky;top:0;padding:calc(2*var(--default-grid-baseline));margin-top:calc(2*var(--default-grid-baseline))}.messages__author[data-v-77e4c704]{max-width:calc(50*var(--default-font-size));padding-inline-start:var(--default-grid-baseline);color:var(--color-text-maxcontrast);flex-shrink:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}","",{version:3,sources:["webpack://./src/components/MessagesList/MessagesGroup/MessagesGroup.vue","webpack://./src/assets/variables.scss"],names:[],mappings:"AAGA,0BACC,YAAA,CACA,sBAAA,CACA,UAAA,CACA,SAAA,CAEA,gCACC,oCAAA,CAIF,2BACC,SAAA,CACA,YAAA,CACA,sCAAA,CACA,qBAAA,CACA,UAAA,CACA,WAAA,CAEA,mCACC,eAAA,CACA,KAAA,CACA,4CAAA,CACA,+CAAA,CAGD,mCACC,2CClBwB,CDmBxB,iDAAA,CACA,mCAAA,CACA,aAAA,CACA,kBAAA,CACA,eAAA,CACA,sBAAA",sourceRoot:""}]);const r=l},25283:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".messages-group__system[data-v-4c6a63a2]{display:flex;flex-direction:column}.wrapper[data-v-4c6a63a2]{display:flex;width:100%;padding:0}.wrapper--system[data-v-4c6a63a2]{flex-direction:column;padding-inline-start:calc(32px + 4*var(--default-grid-baseline))}.wrapper[data-v-4c6a63a2]:focus{background-color:rgba(47,47,47,.068)}.messages[data-v-4c6a63a2]{flex:auto;display:flex;flex-direction:column;width:100%;min-width:0}.messages--collapsed[data-v-4c6a63a2]{border-radius:var(--border-radius-large);background-color:var(--color-background-hover)}","",{version:3,sources:["webpack://./src/components/MessagesList/MessagesGroup/MessagesSystemGroup.vue"],names:[],mappings:"AAGA,yCACC,YAAA,CACA,qBAAA,CAGD,0BACC,YAAA,CACA,UAAA,CACA,SAAA,CACA,kCACC,qBAAA,CACA,gEAAA,CAED,gCACC,oCAAA,CAIF,2BACC,SAAA,CACA,YAAA,CACA,qBAAA,CACA,UAAA,CACA,WAAA,CAEA,sCACC,wCAAA,CACA,8CAAA",sourceRoot:""}]);const r=l},78092:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".scroller[data-v-6b78e40c]{position:relative;flex:1 0;padding-top:var(--default-grid-baseline);overflow-y:scroll;overflow-x:hidden;border-bottom:1px solid var(--color-border);transition:all var(--animation-quick, 100ms) ease-in-out}.scroller--chatScrolledToBottom[data-v-6b78e40c]{border-block-end-color:rgba(0,0,0,0)}.scroller__content[data-v-6b78e40c]{max-width:calc(32px + 4*var(--default-grid-baseline) + 50*var(--default-font-size) + 2*var(--default-grid-baseline) + 8ch + var(--clickable-area-small, 24px) + 4*var(--default-grid-baseline));margin:0 auto}.scroller__loading[data-v-6b78e40c]{position:relative;height:0;max-width:calc(32px + 4*var(--default-grid-baseline) + 50*var(--default-font-size) + 2*var(--default-grid-baseline) + 8ch + var(--clickable-area-small, 24px) + 4*var(--default-grid-baseline));margin:0 auto}.scroller__loading-element[data-v-6b78e40c]{position:absolute;top:0;inset-inline-start:calc(2*var(--default-grid-baseline))}.messages-list__placeholder[data-v-6b78e40c]{display:flex;flex-direction:column-reverse;overflow:hidden;height:100%}.messages-list__empty-content[data-v-6b78e40c]{height:100%}.messages-group__date[data-v-6b78e40c]{position:sticky;top:0;display:grid;grid-template-columns:minmax(0, calc(50 * var(--default-font-size))) calc(8ch + var(--clickable-area-small, 24px) + 4*var(--default-grid-baseline));z-index:2;margin-inline-start:calc(32px + 4*var(--default-grid-baseline));margin-bottom:5px;padding-inline:var(--default-grid-baseline);pointer-events:none}.messages-group__date-text[data-v-6b78e40c]{margin:0 auto;padding:var(--default-grid-baseline) calc(3*var(--default-grid-baseline));text-wrap:nowrap;color:var(--color-text-maxcontrast);background-color:var(--color-background-dark);border-radius:var(--border-radius-element, var(--border-radius-pill))}.messages-group[data-v-6b78e40c]:last-child{margin-bottom:16px}.has-sticky .messages-group__date[data-v-6b78e40c]{transition:opacity .3s ease-in-out;transition-delay:2s;opacity:0}.scroller--isScrolling .has-sticky .messages-group__date[data-v-6b78e40c]{opacity:1;transition:opacity 0s}","",{version:3,sources:["webpack://./src/components/MessagesList/MessagesList.vue","webpack://./src/assets/variables.scss"],names:[],mappings:"AAGA,2BACC,iBAAA,CACA,QAAA,CACA,wCAAA,CACA,iBAAA,CACA,iBAAA,CACA,2CAAA,CACA,wDCeY,CDbZ,iDACC,oCAAA,CAGD,oCACC,+LCFwB,CDGxB,aAAA,CAGD,oCACC,iBAAA,CACA,QAAA,CACA,+LCTwB,CDUxB,aAAA,CAEA,4CACC,iBAAA,CACA,KAAA,CACA,uDAAA,CAMF,6CACC,YAAA,CACA,6BAAA,CACA,eAAA,CACA,WAAA,CAGD,+CACC,WAAA,CAKD,uCACC,eAAA,CACA,KAAA,CACA,YAAA,CACA,mJAAA,CACA,SAAA,CACA,+DAAA,CACA,iBAAA,CACA,2CAAA,CACA,mBAAA,CAGD,4CACC,aAAA,CACA,yEAAA,CACA,gBAAA,CACA,mCAAA,CACA,6CAAA,CACA,qEAAA,CAGD,4CACC,kBAAA,CAIF,mDACC,kCAAA,CACA,mBAAA,CACA,SAAA,CAGD,0EACC,SAAA,CACA,qBAAA",sourceRoot:""}]);const r=l},73708:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".upload-editor[data-v-a9598b96]{height:100%;display:flex;flex-direction:column;justify-content:space-between;padding:calc(3*var(--default-grid-baseline))}.upload-editor__previews[data-v-a9598b96]{display:flex;position:relative;overflow:auto;flex-wrap:wrap}.upload-editor__previews.dragging-over[data-v-a9598b96]{outline:3px dashed var(--color-primary-element);border-radius:var(--border-radius-large)}.upload-editor__actions[data-v-a9598b96]{display:flex;justify-content:flex-end;gap:4px;padding:12px 0}.upload-editor__textfield[data-v-a9598b96]{padding-block:calc(var(--default-grid-baseline)*2)}.upload-editor .add-more-button[data-v-a9598b96]{width:164px !important;height:176px !important;margin:10px}.upload-editor .add-more-button[data-v-a9598b96] .button-vue__icon{border-radius:var(--border-radius-pill);color:var(--color-primary-element-text);background-color:var(--color-primary-element)}","",{version:3,sources:["webpack://./src/components/NewMessage/NewMessageUploadEditor.vue"],names:[],mappings:"AACA,gCACC,WAAA,CACA,YAAA,CACA,qBAAA,CACA,6BAAA,CACA,4CAAA,CAEA,0CACC,YAAA,CACA,iBAAA,CACA,aAAA,CACA,cAAA,CAEA,wDACC,+CAAA,CACA,wCAAA,CAIF,yCACC,YAAA,CACA,wBAAA,CACA,OAAA,CACA,cAAA,CAGD,2CACC,kDAAA,CAGD,iDACC,sBAAA,CACA,uBAAA,CACA,WAAA,CAEA,mEACC,uCAAA,CACA,uCAAA,CACA,6CAAA",sourceRoot:""}]);const r=l},57300:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".drafts[data-v-6bdc379b] .dialog__content{min-height:200px}.drafts__wrapper[data-v-6bdc379b]{display:grid;grid-template-columns:1fr 1fr;grid-gap:var(--default-grid-baseline)}.drafts__empty[data-v-6bdc379b]{margin:0 !important}","",{version:3,sources:["webpack://./src/components/PollViewer/PollDraftHandler.vue"],names:[],mappings:"AAEC,0CACC,gBAAA,CAGD,kCACC,YAAA,CACA,6BAAA,CACA,qCAAA,CAGD,gCACC,mBAAA",sourceRoot:""}]);const r=l},18408:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".poll-editor__wrapper[data-v-1b71dcf8]{display:flex;align-items:flex-end;gap:var(--default-grid-baseline)}.poll-editor__caption[data-v-1b71dcf8]{margin:calc(var(--default-grid-baseline)*2) 0 var(--default-grid-baseline);font-weight:bold;color:var(--color-primary-element)}.poll-editor__option[data-v-1b71dcf8]{display:flex;align-items:flex-end;gap:var(--default-grid-baseline);width:100%;margin-bottom:calc(var(--default-grid-baseline)*2)}.poll-editor__settings[data-v-1b71dcf8]{display:flex;flex-direction:column;gap:4px;margin-bottom:8px}.poll-editor__back-button[data-v-1b71dcf8]{position:absolute !important;top:var(--default-grid-baseline);inset-inline-start:var(--default-grid-baseline);z-index:1}","",{version:3,sources:["webpack://./src/components/PollViewer/PollEditor.vue"],names:[],mappings:"AAEC,uCACC,YAAA,CACA,oBAAA,CACA,gCAAA,CAGD,uCACC,0EAAA,CACA,gBAAA,CACA,kCAAA,CAGD,sCACC,YAAA,CACA,oBAAA,CACA,gCAAA,CACA,UAAA,CACA,kDAAA,CAGD,wCACC,YAAA,CACA,qBAAA,CACA,OAAA,CACA,iBAAA,CAGD,2CACC,4BAAA,CACA,gCAAA,CACA,+CAAA,CACA,SAAA",sourceRoot:""}]);const r=l},12069:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".poll-modal[data-v-5f34177e]{position:relative;padding:20px}.poll-modal__header[data-v-5f34177e]{display:flex;align-items:flex-start;gap:8px;margin-bottom:8px;font-weight:bold;font-size:18px;white-space:normal;word-wrap:anywhere}.poll-modal__header[data-v-5f34177e] .material-design-icon{margin-bottom:auto}.poll-modal__summary[data-v-5f34177e]{color:var(--color-text-maxcontrast);margin-bottom:16px}.poll-modal__options[data-v-5f34177e]{display:flex;flex-direction:column;gap:4px;word-wrap:anywhere}.poll-modal__actions[data-v-5f34177e]{position:sticky;bottom:0;display:flex;justify-content:center;gap:8px;padding:8px 0 0;background-color:var(--color-main-background)}.poll-modal__loading[data-v-5f34177e]{height:200px}.results__options[data-v-5f34177e]{display:flex;flex-direction:column;gap:calc(4*var(--default-grid-baseline));word-wrap:anywhere;margin:8px 0 20px 0}.results__option[data-v-5f34177e]{display:flex;flex-direction:column}.results__option[data-v-5f34177e]:not(:last-child){border-bottom:1px solid var(--color-border)}.results__option__details[data-v-5f34177e]{display:flex;margin-bottom:8px}.results__option-subtitle[data-v-5f34177e]{display:flex;gap:var(--default-grid-baseline);color:var(--color-text-maxcontrast)}.results__option-progress[data-v-5f34177e]{margin-top:4px}.results__option-title[data-v-5f34177e]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:4px}.results__option-title .percentage[data-v-5f34177e]{white-space:nowrap;margin-inline-start:16px}.critical[data-v-5f34177e] .action-button{color:var(--color-error) !important}","",{version:3,sources:["webpack://./src/components/PollViewer/PollViewer.vue"],names:[],mappings:"AACA,6BACC,iBAAA,CACA,YAAA,CAEA,qCACC,YAAA,CACA,sBAAA,CACA,OAAA,CACA,iBAAA,CACA,gBAAA,CACA,cAAA,CACA,kBAAA,CACA,kBAAA,CAEA,2DACC,kBAAA,CAIF,sCACC,mCAAA,CACA,kBAAA,CAGD,sCACC,YAAA,CACA,qBAAA,CACA,OAAA,CACA,kBAAA,CAGD,sCACC,eAAA,CACA,QAAA,CACA,YAAA,CACA,sBAAA,CACA,OAAA,CACA,eAAA,CACA,6CAAA,CAGD,sCACC,YAAA,CAIF,mCACC,YAAA,CACA,qBAAA,CACA,wCAAA,CACA,kBAAA,CACA,mBAAA,CAGD,kCACC,YAAA,CACA,qBAAA,CAEA,mDACC,2CAAA,CAGD,2CACC,YAAA,CACA,iBAAA,CAGD,2CACC,YAAA,CACA,gCAAA,CACA,mCAAA,CAGD,2CACC,cAAA,CAGD,wCACC,YAAA,CACA,6BAAA,CACA,sBAAA,CACA,iBAAA,CAEA,oDACC,kBAAA,CACA,wBAAA,CAKH,0CACC,mCAAA",sourceRoot:""}]);const r=l},30197:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".poll-voters-details[data-v-154f7bb4]{max-width:30%;margin-inline-end:8px}.poll-voters-details .poll-voters-details__button[data-v-154f7bb4],.poll-voters-details__button[data-v-154f7bb4] .button-vue__icon{min-height:auto;height:auto;min-width:auto;width:auto !important;flex-wrap:wrap;justify-content:flex-start;border-radius:0;overflow:visible}.poll-voters-details__popover[data-v-154f7bb4]{padding:8px;max-height:400px;overflow-y:scroll}.poll-voters-details__display-name[data-v-154f7bb4]{margin-inline-start:4px}.poll-voters-details__list-item[data-v-154f7bb4]{display:flex;justify-content:flex-start;align-items:center;min-width:150px;height:32px;margin-bottom:var(--margin-small)}","",{version:3,sources:["webpack://./src/components/PollViewer/PollVotersDetails.vue"],names:[],mappings:"AAEA,sCACC,aAAA,CACA,qBAAA,CAEA,mIAEC,eAAA,CACA,WAAA,CACA,cAAA,CACA,qBAAA,CACA,cAAA,CACA,0BAAA,CACA,eAAA,CACA,gBAAA,CAGD,+CACC,WAAA,CACA,gBAAA,CACA,iBAAA,CAGD,oDACC,uBAAA,CAGD,iDACC,YAAA,CACA,0BAAA,CACA,kBAAA,CACA,eAAA,CACA,WAAA,CACA,iCAAA",sourceRoot:""}]);const r=l},50232:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".internal-warning[data-v-1743a337]{margin:var(--default-grid-baseline) !important}","",{version:3,sources:["webpack://./src/components/RightSidebar/InternalSignalingHint.vue"],names:[],mappings:"AACA,mCACC,8CAAA",sourceRoot:""}]);const r=l},90158:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".conversation-actions[data-v-e0669596]{padding:calc(var(--default-grid-baseline)*2) var(--default-grid-baseline);transition:background-color var(--animation-quick) ease}.conversation-actions--highlighted[data-v-e0669596]{background-color:var(--color-primary-element-light);border-radius:var(--border-radius)}.conversation-actions--highlighted p[data-v-e0669596]{color:var(--color-main-text)}.conversation-actions__buttons[data-v-e0669596]{display:flex;justify-content:center;gap:var(--default-grid-baseline);margin-top:var(--default-grid-baseline)}","",{version:3,sources:["webpack://./src/components/UIShared/ConversationActionsShortcut.vue"],names:[],mappings:"AACA,uCACC,yEAAA,CACA,uDAAA,CAEA,oDACC,mDAAA,CAIA,kCAAA,CAHA,sDACC,4BAAA,CAKF,gDACC,YAAA,CACA,sBAAA,CACA,gCAAA,CACA,uCAAA",sourceRoot:""}]);const r=l},77037:(D,E,i)=>{"use strict";i.d(E,{A:()=>r});var f=i(71354),v=i.n(f),h=i(76314),y=i.n(h),l=y()(v());l.push([D.id,".talk-tab__wrapper[data-v-5356b7d8]{display:flex;flex-direction:column;justify-content:flex-end;height:100%;padding:var(--default-grid-baseline) 0}.talk-tab__call-button[data-v-5356b7d8]{margin:0 auto calc(var(--default-grid-baseline)*2)}.talk-tab__chat-view[data-v-5356b7d8]{overflow:hidden}","",{version:3,sources:["webpack://./src/views/FilesSidebarChatView.vue"],names:[],mappings:"AAEC,oCACC,YAAA,CACA,qBAAA,CACA,wBAAA,CACA,WAAA,CACA,sCAAA,CAGD,wCACC,kDAAA,CAGD,sCACC,eAAA",sourceRoot:""}]);const r=l},34932:D=>{function E(i,f){for(var v=-1,h=i==null?0:i.length,y=Array(h);++v<h;)y[v]=f(i[v],v,i);return y}D.exports=E},77556:(D,E,i)=>{var f=i(51873),v=i(34932),h=i(56449),y=i(44394),l=1/0,r=f?f.prototype:void 0,Z=r?r.toString:void 0;function Q(K){if(typeof K=="string")return K;if(h(K))return v(K,Q)+"";if(y(K))return Z?Z.call(K):"";var Ke=K+"";return Ke=="0"&&1/K==-l?"-0":Ke}D.exports=Q},44394:(D,E,i)=>{var f=i(72552),v=i(40346),h="[object Symbol]";function y(l){return typeof l=="symbol"||v(l)&&f(l)==h}D.exports=y},13222:(D,E,i)=>{var f=i(77556);function v(h){return h==null?"":f(h)}D.exports=v},97200:(D,E,i)=>{var f=i(13222),v=0;function h(y){var l=++v;return f(y)+l}D.exports=h},40367:(D,E,i)=>{"use strict";i.r(E),i.d(E,{default:()=>Ec});var f=function(){var e=this,t=e._self._c;return t("div",{staticClass:"talk-tab__wrapper"},[t("InternalSignalingHint"),e._v(" "),e.isInCall?e._e():t("CallButton",{staticClass:"talk-tab__call-button"}),e._v(" "),e.connectionFailed?t("CallFailedDialog",{attrs:{token:e.token}}):e._e(),e._v(" "),t("ChatView",{staticClass:"talk-tab__chat-view",attrs:{"is-sidebar":""}}),e._v(" "),t("PollManager"),e._v(" "),t("PollViewer"),e._v(" "),t("MediaSettings",{attrs:{"recording-consent-given":e.recordingConsentGiven},on:{"update:recordingConsentGiven":function(a){e.recordingConsentGiven=a},"update:recording-consent-given":function(a){e.recordingConsentGiven=a}}})],1)},v=[],h=function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t(a.NcModal,{attrs:{"label-id":a.connectionFailedDialogId},on:{close:a.clearConnectionFailedError}},[t(a.NcEmptyContent,{attrs:{name:a.t("spreed","Connection failed"),description:a.message},scopedSlots:e._u([{key:"icon",fn:function(){return[t(a.IconAlertOctagon)]},proxy:!0}])})],1)},y=[],l=i(85471),r=i(53334),Z=i(32190),Q=i(69496),K=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon alert-octagon-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M13 13H11V7H13M11 15H13V17H11M15.73 3H8.27L3 8.27V15.73L8.27 21H15.73L21 15.73V8.27L15.73 3Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Ke=[];const ws={name:"AlertOctagonIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var b=i(14486),Ns=(0,b.A)(ws,K,Ke,!1,null,null,null);const Zt=Ns.exports;var ie=i(20109),js=i(12251);const Us=(0,l.pM)({__name:"CallFailedDialog",props:{token:{type:String,required:!0}},setup(s){const e=s,t=(0,ie.P)(),a={400:(0,r.t)("spreed","Recording consent is required"),403:(0,r.t)("spreed","This conversation is read-only"),404:(0,r.t)("spreed","Conversation not found or not joined"),412:(0,r.t)("spreed","Lobby is still active and you're not a moderator")},n=(0,l.EW)(()=>t.getters.connectionFailed(e.token)),o=`connection-failed-${e.token}`,u=(0,l.EW)(()=>{if(!n.value)return"";const p=n.value.meta?.statuscode;return p&&a[p]?a[p]:n.value?.data?.error?n.value.data.error:js.d});function d(){t.dispatch("clearConnectionFailed",e.token)}return{__sfc:!0,props:e,store:t,STATUS_ERRORS:a,connectionFailed:n,connectionFailedDialogId:o,message:u,clearConnectionFailedError:d,t:r.t,NcEmptyContent:Z.A,NcModal:Q.A,IconAlertOctagon:Zt}}});var $s=(0,b.A)(Us,h,y,!1,null,null,null);const Vs=$s.exports;var Ws=function(){var e=this,t=e._self._c;return t("div",{staticClass:"chatView",on:{dragover:function(a){return a.preventDefault(),e.handleDragOver.apply(null,arguments)},dragleave:function(a){return a.preventDefault(),e.handleDragLeave.apply(null,arguments)},drop:function(a){return a.preventDefault(),e.handleDropFiles.apply(null,arguments)}}},[e.isGuestWithoutDisplayName?t("GuestWelcomeWindow",{attrs:{token:e.token}}):e._e(),e._v(" "),t("div",{staticClass:"messages-list-dragover-wrapper"},[t("TransitionWrapper",{attrs:{name:"slide-up",mode:"out-in"}},[t("NcEmptyContent",{directives:[{name:"show",rawName:"v-show",value:e.isDraggingOver,expression:"isDraggingOver"}],staticClass:"dragover",attrs:{name:e.dropHintText},scopedSlots:e._u([{key:"icon",fn:function(){return[!e.isGuest&&!e.isReadOnly?t("IconTrayArrowUp"):e.isGuest?t("IconAccount"):e.isReadOnly?t("IconAlertOctagon"):e._e()]},proxy:!0}])})],1),e._v(" "),t("MessagesList",{attrs:{role:"region","aria-label":e.t("spreed","Conversation messages"),token:e.token,"is-chat-scrolled-to-bottom":e.isChatScrolledToBottom,"is-visible":e.isVisible},on:{"update:isChatScrolledToBottom":function(a){e.isChatScrolledToBottom=a},"update:is-chat-scrolled-to-bottom":function(a){e.isChatScrolledToBottom=a}}})],1),e._v(" "),t("div",{staticClass:"scroll-to-bottom"},[t("TransitionWrapper",{attrs:{name:"fade"}},[t("NcButton",{directives:[{name:"show",rawName:"v-show",value:!e.isChatScrolledToBottom&&!e.isLoadingChat,expression:"!isChatScrolledToBottom && !isLoadingChat"}],staticClass:"scroll-to-bottom__button",attrs:{type:"secondary","aria-label":e.t("spreed","Scroll to bottom"),title:e.t("spreed","Scroll to bottom")},on:{click:e.scrollToBottom},scopedSlots:e._u([{key:"icon",fn:function(){return[t("IconChevronDoubleDown",{attrs:{size:20}})]},proxy:!0}])})],1)],1),e._v(" "),t("NewMessage",{attrs:{role:"region",token:e.token,"has-typing-indicator":"","aria-label":e.t("spreed","Post message")}}),e._v(" "),t("NewMessageUploadEditor")],1)},zs=[],U=i(97012),Qt=i(83127),Hs=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon chevron-double-down-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M16.59,5.59L18,7L12,13L6,7L7.41,5.59L12,10.17L16.59,5.59M16.59,11.59L18,13L12,19L6,13L7.41,11.59L12,16.17L16.59,11.59Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Gs=[];const Ks={name:"ChevronDoubleDownIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ys=(0,b.A)(Ks,Hs,Gs,!1,null,null,null);const Xs=Ys.exports;var Js=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon tray-arrow-up-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M2 12H4V17H20V12H22V17C22 18.11 21.11 19 20 19H4C2.9 19 2 18.11 2 17V12M12 2L6.46 7.46L7.88 8.88L11 5.75V15H13V5.75L16.13 8.88L17.55 7.45L12 2Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Zs=[];const Qs={name:"TrayArrowUpIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var qs=(0,b.A)(Qs,Js,Zs,!1,null,null,null);const ea=qs.exports;var ta=function(){var e=this,t=e._self._c;return t("NcModal",{attrs:{"no-close":"","close-on-click-outside":!1,"label-id":e.dialogHeaderId,size:"small"}},[t("div",{staticClass:"modal__content"},[t("div",{staticClass:"conversation-information"},[t("ConversationIcon",{attrs:{item:e.conversation,"hide-user-status":""}}),e._v(" "),t("h2",{staticClass:"nc-dialog-alike-header",attrs:{id:e.dialogHeaderId}},[e._v(`
				`+e._s(e.conversationDisplayName)+`
			`)])],1),e._v(" "),t("p",{staticClass:"description"},[e._v(`
			`+e._s(e.conversationDescription)+`
		`)]),e._v(" "),t("label",{attrs:{for:"textField"}},[e._v(e._s(e.t("spreed","Enter your name")))]),e._v(" "),t("NcTextField",{staticClass:"username-form__input",attrs:{id:"textField",placeholder:e.t("spreed","Guest"),"show-trailing-button":!1,"label-outside":""},on:{keydown:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.handleChooseUserName.apply(null,arguments)}},model:{value:e.guestUserName,callback:function(a){e.guestUserName=a},expression:"guestUserName"}}),e._v(" "),t("NcButton",{staticClass:"submit-button",attrs:{type:"primary",disabled:e.invalidGuestUsername},on:{click:e.handleChooseUserName},scopedSlots:e._u([{key:"icon",fn:function(){return[t("Check",{attrs:{size:20}})]},proxy:!0}])},[e._v(`
			`+e._s(e.t("spreed","Submit name and join"))+`
			`)]),e._v(" "),t("div",{staticClass:"separator"}),e._v(" "),t("div",{staticClass:"login-info"},[t("span",[e._v(" "+e._s(e.t("spreed","Do you already have an account?")))]),e._v(" "),t("NcButton",{attrs:{type:"secondary",href:e.getLoginUrl()}},[e._v(`
				`+e._s(e.t("spreed","Log in"))+`
			`)])],1)],1)])},sa=[],Y=i(63814),qt=i(82182),aa=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon check-bold-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},ia=[];const ra={name:"CheckBoldIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var na=(0,b.A)(ra,aa,ia,!1,null,null,null);const es=na.exports;var oa=i(97626),Ye=i(23399),$e=i(14816);const la={name:"GuestWelcomeWindow",components:{NcModal:Q.A,NcTextField:qt.A,ConversationIcon:oa.A,NcButton:U.A,Check:es},props:{token:{type:String,required:!0}},setup(){const s=(0,$e.m)(),e=(0,l.KR)(""),t=`guest-welcome-header-${(0,Ye.B)()}`;return{guestNameStore:s,guestUserName:e,dialogHeaderId:t}},computed:{conversation(){return this.$store.getters.conversation(this.token)},conversationDisplayName(){return this.conversation?.displayName},conversationDescription(){return this.conversation?.description},invalidGuestUsername(){return this.guestUserName.trim()===""}},methods:{t:r.t,handleChooseUserName(){this.guestNameStore.submitGuestUsername(this.token,this.guestUserName)},getLoginUrl(){const s=window.location.pathname,e=(0,Y.Jv)("/login"),t=encodeURIComponent(s);return`${e}?redirect_url=${t}`}}};var ua=i(85072),T=i.n(ua),da=i(97825),I=i.n(da),ca=i(77659),P=i.n(ca),_a=i(55056),O=i.n(_a),pa=i(10540),L=i.n(pa),Aa=i(41113),R=i.n(Aa),Xe=i(77672),re={};re.styleTagTransform=R(),re.setAttributes=O(),re.insert=P().bind(null,"head"),re.domAPI=I(),re.insertStyleElement=L();var Pc=T()(Xe.A,re);const Oc=Xe.A&&Xe.A.locals?Xe.A.locals:void 0;var ga=(0,b.A)(la,ta,sa,!1,null,"b3fb2702",null);const ma=ga.exports;var Ca=function(){var e=this,t=e._self._c;return t("div",{ref:"scroller",staticClass:"scroller messages-list__scroller",class:{"scroller--chatScrolledToBottom":e.isChatScrolledToBottom,"scroller--isScrolling":e.isScrolling},on:{scroll:e.onScroll,scrollend:e.endScroll}},[t("TransitionWrapper",{attrs:{name:"fade"}},[t("div",{staticClass:"scroller__loading"},[e.displayMessagesLoader?t("NcLoadingIcon",{staticClass:"scroller__loading-element",attrs:{size:32}}):e._e()],1)]),e._v(" "),e._l(e.messagesGroupedByDateByAuthor,function(a,n){return t("ul",{key:`section_${n}`,ref:`dateGroup-${e.token}`,refInFor:!0,staticClass:"scroller__content",class:{"has-sticky":n===e.stickyDate},attrs:{"data-date-timestamp":n}},[t("li",{key:e.dateSeparatorLabels[n],staticClass:"messages-group__date"},[t("span",{staticClass:"messages-group__date-text",attrs:{role:"heading","aria-level":"3"}},[e._v(`
				`+e._s(e.dateSeparatorLabels[n])+`
			`)])]),e._v(" "),e._l(a,function(o){return t(e.messagesGroupComponent(o),{key:o.id,tag:"component",staticClass:"messages-group",attrs:{token:e.token,messages:o.messages,"previous-message-id":o.previousMessageId,"next-message-id":o.nextMessageId}})})],2)}),e._v(" "),e.isMessagesListPopulated?e.showEmptyContent?t("NcEmptyContent",{staticClass:"messages-list__empty-content",attrs:{name:e.t("spreed","No messages"),description:e.t("spreed","All messages have expired or have been deleted.")},scopedSlots:e._u([{key:"icon",fn:function(){return[t("Message",{attrs:{size:64}})]},proxy:!0}])}):e._e():[t("LoadingPlaceholder",{staticClass:"messages-list__placeholder",attrs:{type:"messages",count:15}})]],2)},va=[],q=i(65043),X=i(61338),z=i(51651),ha=i(17334),ts=i.n(ha),fa=i(97200),Da=i.n(fa),te=i(59892),ya=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon message-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M20,2H4A2,2 0 0,0 2,4V22L6,18H20A2,2 0 0,0 22,16V4C22,2.89 21.1,2 20,2Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Ea=[];const ba={name:"MessageIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ma=(0,b.A)(ba,ya,Ea,!1,null,null,null);const Fa=Ma.exports;var Ba=i(25943),Pt=i(64902),ka=function(){var e=this,t=e._self._c;return t("li",{staticClass:"wrapper"},[t("div",{staticClass:"messages__avatar"},[t("AvatarWrapper",{attrs:{id:e.actorId,token:e.token,name:e.actorDisplayName,source:e.actorType,size:e.AVATAR.SIZE.SMALL,"disable-menu":e.disableMenu,"disable-tooltip":""}})],1),e._v(" "),t("ul",{staticClass:"messages"},[t("li",{staticClass:"messages__author",attrs:{"aria-level":"4"}},[e._v(`
			`+e._s(e.actorInfo)+`
		`)]),e._v(" "),e._l(e.messages,function(a,n){return t("Message",{key:a.id,attrs:{message:a,"next-message-id":e.messages[n+1]&&e.messages[n+1].id||e.nextMessageId,"previous-message-id":n>0&&e.messages[n-1].id||e.previousMessageId}})})],2)])},Sa=[],Je=i(78457),Ta=function(){var e=this,t=e._self._c;return t("li",{ref:"message",staticClass:"message",class:{"message--hovered":e.showMessageButtonsBar},attrs:{id:`message_${e.message.id}`,"data-message-id":e.message.id,"data-seen":e.seen,"data-next-message-id":e.nextMessageId,"data-previous-message-id":e.previousMessageId,tabindex:"0"},on:{animationend:e.clearHighlightedClass,mouseover:e.handleMouseover,mouseleave:e.handleMouseleave}},[t("div",{staticClass:"message-body",class:{"normal-message-body":!e.isSystemMessage&&!e.isDeletedMessage,system:e.isSystemMessage,"combined-system":e.isCombinedSystemMessage}},[t("MessageBody",{attrs:{"rich-parameters":e.richParameters,"is-deleting":e.isDeleting,"has-call":e.conversation.hasCall,message:e.message,"read-info":e.readInfo}},[Object.keys(e.message.reactions).length?t("Reactions",{attrs:{id:e.message.id,token:e.message.token,"can-react":e.canReact,"show-controls":e.isHovered||e.isFollowUpEmojiPickerOpen},on:{"emoji-picker-toggled":e.toggleFollowUpEmojiPicker}}):e._e()],1)],1),e._v(" "),t("div",{staticClass:"message-body__scroll"},[e.showMessageButtonsBar?t("MessageButtonsBar",{ref:"messageButtonsBar",staticClass:"message-buttons-bar",attrs:{"is-translation-available":e.isTranslationAvailable,"is-action-menu-open":e.isActionMenuOpen,"is-emoji-picker-open":e.isEmojiPickerOpen,"is-reactions-menu-open":e.isReactionsMenuOpen,"is-forwarder-open":e.isForwarderOpen,"can-react":e.canReact,message:e.message,"previous-message-id":e.previousMessageId,"read-info":e.readInfo},on:{"update:isActionMenuOpen":function(a){e.isActionMenuOpen=a},"update:is-action-menu-open":function(a){e.isActionMenuOpen=a},"update:isEmojiPickerOpen":function(a){e.isEmojiPickerOpen=a},"update:is-emoji-picker-open":function(a){e.isEmojiPickerOpen=a},"update:isReactionsMenuOpen":function(a){e.isReactionsMenuOpen=a},"update:is-reactions-menu-open":function(a){e.isReactionsMenuOpen=a},"update:isForwarderOpen":function(a){e.isForwarderOpen=a},"update:is-forwarder-open":function(a){e.isForwarderOpen=a},"show-translate-dialog":function(a){e.isTranslateDialogOpen=!0},reply:e.handleReply,edit:e.handleEdit,delete:e.handleDelete}}):e.showCombinedSystemMessageToggle?t("div",{staticClass:"message-buttons-bar"},[t("NcButton",{attrs:{type:"tertiary","aria-label":e.t("spreed","Show or collapse system messages"),title:e.t("spreed","Show or collapse system messages")},on:{click:e.toggleCombinedSystemMessage},scopedSlots:e._u([{key:"icon",fn:function(){return[e.isCombinedSystemMessageCollapsed?t("IconUnfoldMore"):t("IconUnfoldLess")]},proxy:!0}])})],1):e._e()],1),e._v(" "),e.isForwarderOpen?t("MessageForwarder",{attrs:{id:e.message.id,token:e.message.token},on:{close:function(a){e.isForwarderOpen=!1}}}):e._e(),e._v(" "),e.isTranslationAvailable&&e.isTranslateDialogOpen?t("MessageTranslateDialog",{attrs:{message:e.message.message,"rich-parameters":e.richParameters},on:{close:function(a){e.isTranslateDialogOpen=!1}}}):e._e(),e._v(" "),e.isLastReadMessage?t("div",{directives:[{name:"intersection-observer",rawName:"v-intersection-observer",value:e.lastReadMessageVisibilityChanged,expression:"lastReadMessageVisibilityChanged"}],staticClass:"message-unread-marker"},[t("div",{staticClass:"message-unread-marker__wrapper"},[t("span",{staticClass:"message-unread-marker__text"},[e._v(e._s(e.t("spreed","Unread messages")))]),e._v(" "),e.shouldShowSummaryOption?t("NcButton",{attrs:{disabled:e.loading},on:{click:e.generateSummary},scopedSlots:e._u([{key:"icon",fn:function(){return[e.loading?t("NcLoadingIcon"):t("IconCreation")]},proxy:!0}],null,!1,542307774)},[e._v(`
				`+e._s(e.t("spreed","Generate summary"))+`
			`)]):e._e()],1)]):e._e()],1)},Ia=[],x=i(85168),Ve=i(57579),Pa=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon creation-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M19,1L17.74,3.75L15,5L17.74,6.26L19,9L20.25,6.26L23,5L20.25,3.75M9,4L6.5,9.5L1,12L6.5,14.5L9,20L11.5,14.5L17,12L11.5,9.5M19,15L17.74,17.74L15,19L17.74,20.25L19,23L20.25,20.25L23,19L20.25,17.74"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Oa=[];const La={name:"CreationIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ra=(0,b.A)(La,Pa,Oa,!1,null,null,null);const ss=Ra.exports;var xa=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon unfold-less-horizontal-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M16.59,5.41L15.17,4L12,7.17L8.83,4L7.41,5.41L12,10M7.41,18.59L8.83,20L12,16.83L15.17,20L16.58,18.59L12,14L7.41,18.59Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},wa=[];const Na={name:"UnfoldLessHorizontalIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ja=(0,b.A)(Na,xa,wa,!1,null,null,null);const Ua=ja.exports;var $a=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon unfold-more-horizontal-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Va=[];const Wa={name:"UnfoldMoreHorizontalIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var za=(0,b.A)(Wa,$a,Va,!1,null,null,null);const Ha=za.exports;var Ga=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.handleClickOutside,expression:"handleClickOutside"}]},[e.isReactionsMenuOpen?[t("NcButton",{attrs:{type:"tertiary","aria-label":e.t("spreed","Close reactions menu")},on:{click:e.closeReactionsMenu},scopedSlots:e._u([{key:"icon",fn:function(){return[t("IconArrowLeft",{staticClass:"bidirectional-icon",attrs:{size:20}})]},proxy:!0}])}),e._v(" "),e._l(e.frequentlyUsedEmojis,function(a){return t("NcButton",{key:a,attrs:{type:"tertiary","aria-label":e.t("spreed","React with {emoji}",{emoji:a})},on:{click:function(n){return e.handleReactionClick(a)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("span",[e._v(e._s(a))])]},proxy:!0}],null,!0)})}),e._v(" "),t("NcEmojiPicker",{attrs:{boundary:e.boundariesElement,placement:"auto"},on:{select:e.handleReactionClick,"after-show":e.onEmojiPickerOpen,"after-hide":e.onEmojiPickerClose}},[t("NcButton",{attrs:{type:"tertiary","aria-label":e.t("spreed","React with another emoji")},scopedSlots:e._u([{key:"icon",fn:function(){return[t("Plus",{attrs:{size:20}})]},proxy:!0}])})],1)]:[e.canReact?t("NcButton",{attrs:{type:"tertiary","aria-label":e.t("spreed","Add a reaction to this message"),title:e.t("spreed","Add a reaction to this message")},on:{click:e.openReactionsMenu},scopedSlots:e._u([{key:"icon",fn:function(){return[t("EmoticonOutline",{attrs:{size:20}})]},proxy:!0}],null,!1,1267396848)}):e._e(),e._v(" "),e.canReply?t("NcButton",{attrs:{type:"tertiary","aria-label":e.t("spreed","Reply"),title:e.t("spreed","Reply")},on:{click:e.handleReply},scopedSlots:e._u([{key:"icon",fn:function(){return[t("Reply",{attrs:{size:16}})]},proxy:!0}],null,!1,2449574943)}):e._e(),e._v(" "),t("NcActions",{attrs:{"force-menu":!0,placement:"bottom-end","boundaries-element":e.boundariesElement},on:{open:e.onMenuOpen,close:e.onMenuClose}},[e.submenu===null?[t("NcActionText",{scopedSlots:e._u([{key:"icon",fn:function(){return[e.readInfo.showCommonReadIcon?t("span",{attrs:{title:e.readInfo.commonReadIconTitle,"aria-label":e.readInfo.commonReadIconTitle}},[t("CheckAll",{attrs:{size:16}})],1):e.readInfo.showSentIcon?t("span",{attrs:{title:e.readInfo.sentIconTitle,"aria-label":e.readInfo.sentIconTitle}},[t("Check",{attrs:{size:16}})],1):t("ClockOutline",{attrs:{size:16}})]},proxy:!0}],null,!1,523023767)},[e._v(`
					`+e._s(e.messageDateTime)+`
				`)]),e._v(" "),e.message.lastEditTimestamp?t("NcActionText",{staticClass:"edit-timestamp",attrs:{name:e.lastEditActorLabel},scopedSlots:e._u([{key:"icon",fn:function(){return[t("ClockEditOutline",{attrs:{size:16}})]},proxy:!0}],null,!1,109138201)},[e._v(`
					`+e._s(e.editedDateTime)+`
				`)]):e._e(),e._v(" "),e.readInfo.showSilentIcon?t("NcActionText",{scopedSlots:e._u([{key:"icon",fn:function(){return[t("IconBellOff",{attrs:{size:16}})]},proxy:!0}],null,!1,3643103150)},[e._v(`
					`+e._s(e.readInfo.silentIconTitle)+`
				`)]):e._e(),e._v(" "),t("NcActionSeparator"),e._v(" "),e.supportReminders?t("NcActionButton",{attrs:{"is-menu":""},on:{click:function(a){a.stopPropagation(),e.submenu="reminder"}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("AlarmIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,1813317200)},[e._v(`
					`+e._s(e.t("spreed","Set reminder"))+`
				`)]):e._e(),e._v(" "),e.isPrivateReplyable?t("NcActionButton",{attrs:{"close-after-click":""},on:{click:function(a){return a.stopPropagation(),e.handlePrivateReply.apply(null,arguments)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("AccountIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,2066712834)},[e._v(`
					`+e._s(e.t("spreed","Reply privately"))+`
				`)]):e._e(),e._v(" "),e.isEditable?t("NcActionButton",{attrs:{"aria-label":e.t("spreed","Edit message"),"close-after-click":""},on:{click:function(a){return a.stopPropagation(),e.editMessage.apply(null,arguments)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("Pencil",{attrs:{size:20}})]},proxy:!0}],null,!1,580569589)},[e._v(`
					`+e._s(e.t("spreed","Edit message"))+`
				`)]):e._e(),e._v(" "),e.isFileShareWithoutCaption?e._e():t("NcActionButton",{attrs:{"close-after-click":""},on:{click:function(a){return a.stopPropagation(),e.handleCopyMessageText.apply(null,arguments)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("ContentCopy",{attrs:{size:20}})]},proxy:!0}],null,!1,1478045380)},[e._v(`
					`+e._s(e.t("spreed","Copy message"))+`
				`)]),e._v(" "),t("NcActionButton",{attrs:{"close-after-click":""},on:{click:function(a){return a.stopPropagation(),e.handleCopyMessageLink.apply(null,arguments)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("OpenInNewIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,1266168172)},[e._v(`
					`+e._s(e.t("spreed","Copy message link"))+`
				`)]),e._v(" "),t("NcActionButton",{attrs:{"close-after-click":""},on:{click:function(a){return a.stopPropagation(),e.handleMarkAsUnread.apply(null,arguments)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("EyeOffOutline",{attrs:{size:16}})]},proxy:!0}],null,!1,3681331803)},[e._v(`
					`+e._s(e.t("spreed","Mark as unread"))+`
				`)]),e._v(" "),e.isFileShare?[t("NcActionSeparator"),e._v(" "),t("NcActionLink",{attrs:{href:e.messageFile.link},scopedSlots:e._u([{key:"icon",fn:function(){return[t("File",{attrs:{size:20}})]},proxy:!0}],null,!1,395998446)},[e._v(`
						`+e._s(e.t("spreed","Go to file"))+`
					`)]),e._v(" "),e.hideDownloadOption?e._e():t("NcActionLink",{attrs:{href:e.linkToFileDownload,download:e.messageFile.name},scopedSlots:e._u([{key:"icon",fn:function(){return[t("IconDownload",{attrs:{size:20}})]},proxy:!0}],null,!1,2487097783)},[e._v(`
						`+e._s(e.t("spreed","Download file"))+`
					`)])]:e._e(),e._v(" "),e.canForwardMessage&&!e.isInNoteToSelf?t("NcActionButton",{attrs:{"close-after-click":""},on:{click:e.forwardToNote},scopedSlots:e._u([{key:"icon",fn:function(){return[t("Note",{attrs:{size:16}})]},proxy:!0}],null,!1,4139916445)},[e._v(`
					`+e._s(e.t("spreed","Note to self"))+`
				`)]):e._e(),e._v(" "),e.canForwardMessage?t("NcActionButton",{attrs:{"close-after-click":""},on:{click:function(a){return a.stopPropagation(),e.openForwarder.apply(null,arguments)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("Share",{attrs:{size:16}})]},proxy:!0}],null,!1,4243449760)},[e._v(`
					`+e._s(e.t("spreed","Forward message"))+`
				`)]):e._e(),e._v(" "),e.messageActions.length>0?t("NcActionSeparator"):e._e(),e._v(" "),e._l(e.messageActions,function(a){return t("NcActionButton",{key:a.label,attrs:{icon:a.icon,"close-after-click":""},on:{click:function(n){return e.handleMessageAction(a)}}},[e._v(`
					`+e._s(a.label)+`
				`)])}),e._v(" "),e.isTranslationAvailable&&!e.isFileShareWithoutCaption?t("NcActionButton",{attrs:{"close-after-click":""},on:{click:function(a){return a.stopPropagation(),e.$emit("show-translate-dialog",!0)},close:function(a){return e.$emit("show-translate-dialog",!1)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("Translate",{attrs:{size:16}})]},proxy:!0}],null,!1,3658990123)},[e._v(`
					`+e._s(e.t("spreed","Translate"))+`
				`)]):e._e(),e._v(" "),e.isDeleteable?[t("NcActionSeparator"),e._v(" "),t("NcActionButton",{attrs:{"close-after-click":""},on:{click:function(a){return a.stopPropagation(),e.handleDelete.apply(null,arguments)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("DeleteIcon",{attrs:{size:16}})]},proxy:!0}],null,!1,4498431)},[e._v(`
						`+e._s(e.t("spreed","Delete"))+`
					`)])]:e._e()]:e.supportReminders&&e.submenu==="reminder"?[t("NcActionButton",{attrs:{"aria-label":e.t("spreed","Back")},on:{click:function(a){a.stopPropagation(),e.submenu=null}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("IconArrowLeft",{staticClass:"bidirectional-icon"})]},proxy:!0}],null,!1,313241961)},[e._v(`
					`+e._s(e.t("spreed","Back"))+`
				`)]),e._v(" "),e.currentReminder?t("NcActionButton",{attrs:{"close-after-click":""},on:{click:function(a){return a.stopPropagation(),e.removeReminder.apply(null,arguments)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("CloseCircleOutline",{attrs:{size:20}})]},proxy:!0}],null,!1,3165582732)},[e._v(`
					`+e._s(e.clearReminderLabel)+`
				`)]):e._e(),e._v(" "),t("NcActionSeparator"),e._v(" "),e._l(e.reminderOptions,function(a){return t("NcActionButton",{key:a.key,attrs:{"aria-label":a.ariaLabel,"close-after-click":""},on:{click:function(n){return n.stopPropagation(),e.setReminder(a.timestamp)}}},[e._v(`
					`+e._s(a.label)+`
				`)])}),e._v(" "),t("NcActionSeparator"),e._v(" "),t("NcActionInput",{attrs:{type:"datetime-local","is-native-picker":"",min:new Date},scopedSlots:e._u([{key:"icon",fn:function(){return[t("CalendarClock",{attrs:{size:20}})]},proxy:!0}],null,!1,1325980530),model:{value:e.customReminderDateTime,callback:function(a){e.customReminderDateTime=a},expression:"customReminderDateTime"}}),e._v(" "),t("NcActionButton",{attrs:{"aria-label":e.t("spreed","Set custom reminder"),"close-after-click":""},on:{click:function(a){return a.stopPropagation(),e.setReminder(e.customReminderTimestamp)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("Check",{attrs:{size:20}})]},proxy:!0}],null,!1,4226377742)},[e._v(`
					`+e._s(e.t("spreed","Set custom reminder"))+`
				`)])]:e._e()],2)]],2)},Ka=[],as=i(21777),Ya=i(16343),Ze=i(57505),Xa=i(99103),Ot=i(72298),Qe=i(24764),Ja=i(15502),Za=i(55925),is=i(22777),Qa=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon alarm-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M12,20A7,7 0 0,1 5,13A7,7 0 0,1 12,6A7,7 0 0,1 19,13A7,7 0 0,1 12,20M12,4A9,9 0 0,0 3,13A9,9 0 0,0 12,22A9,9 0 0,0 21,13A9,9 0 0,0 12,4M12.5,8H11V14L15.75,16.85L16.5,15.62L12.5,13.25V8M7.88,3.39L6.6,1.86L2,5.71L3.29,7.24L7.88,3.39M22,5.72L17.4,1.86L16.11,3.39L20.71,7.25L22,5.72Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},qa=[];const ei={name:"AlarmIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ti=(0,b.A)(ei,Qa,qa,!1,null,null,null);const si=ti.exports;var rs=i(89654),Lt=i(39284),ai=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon calendar-clock-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M15,13H16.5V15.82L18.94,17.23L18.19,18.53L15,16.69V13M19,8H5V19H9.67C9.24,18.09 9,17.07 9,16A7,7 0 0,1 16,9C17.07,9 18.09,9.24 19,9.67V8M5,21C3.89,21 3,20.1 3,19V5C3,3.89 3.89,3 5,3H6V1H8V3H16V1H18V3H19A2,2 0 0,1 21,5V11.1C22.24,12.36 23,14.09 23,16A7,7 0 0,1 16,23C14.09,23 12.36,22.24 11.1,21H5M16,11.15A4.85,4.85 0 0,0 11.15,16C11.15,18.68 13.32,20.85 16,20.85A4.85,4.85 0 0,0 20.85,16C20.85,13.32 18.68,11.15 16,11.15Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},ii=[];const ri={name:"CalendarClockIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ni=(0,b.A)(ri,ai,ii,!1,null,null,null);const oi=ni.exports;var qe=i(91882),li=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon check-all-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M0.41,13.41L6,19L7.41,17.58L1.83,12M22.24,5.58L11.66,16.17L7.5,12L6.07,13.41L11.66,19L23.66,7M18,7L16.59,5.58L10.24,11.93L11.66,13.34L18,7Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},ui=[];const di={name:"CheckAllIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ci=(0,b.A)(di,li,ui,!1,null,null,null);const ns=ci.exports;var _i=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon clock-edit-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M21 13.1C20.9 13.1 20.7 13.2 20.6 13.3L19.6 14.3L21.7 16.4L22.7 15.4C22.9 15.2 22.9 14.8 22.7 14.6L21.4 13.3C21.3 13.2 21.2 13.1 21 13.1M19.1 14.9L13 20.9V23H15.1L21.2 16.9L19.1 14.9M12.5 7V12.2L16.5 14.6L15.5 15.6L11 13V7H12.5M11 21.9C5.9 21.4 2 17.1 2 12C2 6.5 6.5 2 12 2C17.3 2 21.6 6.1 22 11.3C21.7 11.2 21.4 11.1 21 11.1C20.6 11.1 20.3 11.2 20 11.3C19.6 7.2 16.2 4 12 4C7.6 4 4 7.6 4 12C4 16.1 7.1 19.5 11.1 19.9L11 20.1V21.9Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},pi=[];const Ai={name:"ClockEditOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var gi=(0,b.A)(Ai,_i,pi,!1,null,null,null);const mi=gi.exports;var Ci=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon clock-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22C6.47,22 2,17.5 2,12A10,10 0 0,1 12,2M12.5,7V12.25L17,14.92L16.25,16.15L11,13V7H12.5Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},vi=[];const hi={name:"ClockOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var fi=(0,b.A)(hi,Ci,vi,!1,null,null,null);const Di=fi.exports;var yi=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon close-circle-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22C17.53,22 22,17.53 22,12C22,6.47 17.53,2 12,2M14.59,8L12,10.59L9.41,8L8,9.41L10.59,12L8,14.59L9.41,16L12,13.41L14.59,16L16,14.59L13.41,12L16,9.41L14.59,8Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Ei=[];const bi={name:"CloseCircleOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Mi=(0,b.A)(bi,yi,Ei,!1,null,null,null);const Fi=Mi.exports;var Rt=i(670),xt=i(86451),Bi=i(15370),ki=i(13188),Si=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon eye-off-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M2,5.27L3.28,4L20,20.72L18.73,22L15.65,18.92C14.5,19.3 13.28,19.5 12,19.5C7,19.5 2.73,16.39 1,12C1.69,10.24 2.79,8.69 4.19,7.46L2,5.27M12,9A3,3 0 0,1 15,12C15,12.35 14.94,12.69 14.83,13L11,9.17C11.31,9.06 11.65,9 12,9M12,4.5C17,4.5 21.27,7.61 23,12C22.18,14.08 20.79,15.88 19,17.19L17.58,15.76C18.94,14.82 20.06,13.54 20.82,12C19.17,8.64 15.76,6.5 12,6.5C10.91,6.5 9.84,6.68 8.84,7L7.3,5.47C8.74,4.85 10.33,4.5 12,4.5M3.18,12C4.83,15.36 8.24,17.5 12,17.5C12.69,17.5 13.37,17.43 14,17.29L11.72,15C10.29,14.85 9.15,13.71 9,12.28L5.6,8.87C4.61,9.72 3.78,10.78 3.18,12Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Ti=[];const Ii={name:"EyeOffOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Pi=(0,b.A)(Ii,Si,Ti,!1,null,null,null);const Oi=Pi.exports;var Li=i(99788),Ri=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon note-edit-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M18.13 12L19.39 10.74C19.83 10.3 20.39 10.06 21 10V9L15 3H5C3.89 3 3 3.89 3 5V19C3 20.1 3.89 21 5 21H11V19.13L11.13 19H5V5H12V12H18.13M14 4.5L19.5 10H14V4.5M19.13 13.83L21.17 15.87L15.04 22H13V19.96L19.13 13.83M22.85 14.19L21.87 15.17L19.83 13.13L20.81 12.15C21 11.95 21.33 11.95 21.53 12.15L22.85 13.47C23.05 13.67 23.05 14 22.85 14.19Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},xi=[];const wi={name:"NoteEditOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ni=(0,b.A)(wi,Ri,xi,!1,null,null,null);const ji=Ni.exports;var Ui=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon open-in-new-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},$i=[];const Vi={name:"OpenInNewIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Wi=(0,b.A)(Vi,Ui,$i,!1,null,null,null);const zi=Wi.exports;var os=i(6513),wt=i(49954),Hi=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon reply-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M10,9V5L3,12L10,19V14.9C15,14.9 18.5,16.5 21,20C20,15 17,10 10,9Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Gi=[];const Ki={name:"ReplyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Yi=(0,b.A)(Ki,Hi,Gi,!1,null,null,null);const Xi=Yi.exports;var Ji=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon share-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M21,12L14,5V9C7,10 4,15 3,20C5.5,16.5 9,14.9 14,14.9V19L21,12Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Zi=[];const Qi={name:"ShareIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var qi=(0,b.A)(Qi,Ji,Zi,!1,null,null,null);const er=qi.exports;var tr=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon translate-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M12.87,15.07L10.33,12.56L10.36,12.53C12.1,10.59 13.34,8.36 14.07,6H17V4H10V2H8V4H1V6H12.17C11.5,7.92 10.44,9.75 9,11.35C8.07,10.32 7.3,9.19 6.69,8H4.69C5.42,9.63 6.42,11.17 7.67,12.56L2.58,17.58L4,19L9,14L12.11,17.11L12.87,15.07M18.5,10H16.5L12,22H14L15.12,19H19.87L21,22H23L18.5,10M15.88,17L17.5,12.67L19.12,17H15.88Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},sr=[];const ar={name:"TranslateIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ir=(0,b.A)(ar,tr,sr,!1,null,null,null);const rr=ir.exports;var Nt=i(85387),m=i(4133),N=i(97876);const nr=async function(s,e){return q.Ay.get((0,Y.KT)("apps/spreed/api/v1/chat/{token}/{messageId}/reminder",{token:s,messageId:e}))},or=async function(s,e,t){return q.Ay.post((0,Y.KT)("apps/spreed/api/v1/chat/{token}/{messageId}/reminder",{token:s,messageId:e}),{timestamp:t})},lr=async function(s,e){return q.Ay.delete((0,Y.KT)("apps/spreed/api/v1/chat/{token}/{messageId}/reminder",{token:s,messageId:e}))},Jc=async function(){return axios.get(generateOcsUrl("apps/spreed/api/v1/chat/upcoming-reminders"))};var ur=i(22072),ls=i(75991),dr=i(78113);function cr(s,e=(0,as.HW)()?.uid){if(!e)throw new TypeError("Cannot generate /files/<user>/ URL without a user");return dr.PY+"/files/"+encodeURI(e)+"/"+encodeURI(s)}function _r(s){return s+"/download"}var et=i(76887),pr=i(48729),jt=i(68684);const Ar={name:"MessageButtonsBar",components:{NcActionButton:Ze.A,NcActionInput:Xa.N,NcActionLink:Ot.A,NcActionSeparator:Ja.A,NcActionText:Za.A,NcActions:Qe.A,NcButton:U.A,NcEmojiPicker:is.A,AccountIcon:Qt.A,AlarmIcon:si,IconArrowLeft:rs.A,IconBellOff:Lt.A,CalendarClock:oi,CloseCircleOutline:Fi,Check:qe.A,CheckAll:ns,ClockEditOutline:mi,ClockOutline:Di,ContentCopy:Rt.A,IconDownload:Bi.A,DeleteIcon:xt.A,EmoticonOutline:ki.A,EyeOffOutline:Oi,File:Li.A,Note:ji,OpenInNewIcon:zi,Pencil:os.A,Plus:wt.A,Reply:Xi,Share:er,Translate:rr},directives:{ClickOutside:Ve.z0},inject:["getMessagesListScroller"],props:{previousMessageId:{type:[String,Number],required:!0},message:{type:Object,required:!0},isActionMenuOpen:{type:Boolean,required:!0},isEmojiPickerOpen:{type:Boolean,required:!0},isReactionsMenuOpen:{type:Boolean,required:!0},isForwarderOpen:{type:Boolean,required:!0},canReact:{type:Boolean,required:!0},readInfo:{type:Object,required:!0},isTranslationAvailable:{type:Boolean,required:!0}},emits:["delete","update:isActionMenuOpen","update:isEmojiPickerOpen","update:isReactionsMenuOpen","update:isForwarderOpen","show-translate-dialog","reply","edit"],setup(s){const{message:e}=(0,l.QW)(s),t=(0,ls.b)(),{messageActions:a}=(0,ur.Q)(),{isEditable:n,isDeleteable:o,isCurrentUserOwnMessage:u,isFileShare:d,isFileShareWithoutCaption:p,hideDownloadOption:c,isConversationReadOnly:_,isConversationModifiable:g}=(0,Nt.B)(e),C=(0,N.t0)(e.value.token,"remind-me-later");return{messageActions:a,supportReminders:C,reactionsStore:t,isEditable:n,isCurrentUserOwnMessage:u,isFileShare:d,isFileShareWithoutCaption:p,hideDownloadOption:c,isDeleteable:o,isConversationReadOnly:_,isConversationModifiable:g}},data(){return{frequentlyUsedEmojis:[],submenu:null,currentReminder:null,customReminderTimestamp:new Date().setHours(new Date().getHours()+2,0,0,0)}},computed:{conversation(){return this.$store.getters.conversation(this.message.token)},boundariesElement(){return this.getMessagesListScroller()},isPrivateReplyable(){return this.message.isReplyable&&(this.conversation.type===m.si.TYPE.PUBLIC||this.conversation.type===m.si.TYPE.GROUP)&&!this.isCurrentUserOwnMessage&&this.message.actorType===m.Rf.ACTOR_TYPE.USERS&&this.$store.getters.isActorUser()},messageFile(){const s=Object.keys(this.message.messageParameters).find(e=>e.startsWith("file"));return this.message.messageParameters[s]},linkToFileDownload(){return(0,as.HW)()?cr(this.messageFile.path):_r(this.messageFile.link)},isCurrentGuest(){return this.$store.getters.isActorGuest()},isDeletedMessage(){return this.message.messageType===m.w5.TYPE.COMMENT_DELETED},isPollMessage(){return this.message.messageType===m.w5.TYPE.COMMENT&&this.message.messageParameters?.object?.type==="talk-poll"},isInNoteToSelf(){return this.conversation.type===m.si.TYPE.NOTE_TO_SELF},canForwardMessage(){return!this.isCurrentGuest&&!this.isFileShare&&!this.isDeletedMessage&&!this.isPollMessage},messageDateTime(){return(0,z.A)(this.message.timestamp*1e3).format("lll")},editedDateTime(){return(0,z.A)(this.message.lastEditTimestamp*1e3).format("lll")},customReminderDateTime:{get(){return new Date(this.customReminderTimestamp)},set(s){s!==null&&(this.customReminderTimestamp=s.valueOf())}},reminderOptions(){const s=new Date,e=s.getDay(),t=new Date;t.setDate(s.getDate()+1);const a=new Date;a.setDate(s.getDate()+((13-e)%7||7));const n=new Date;n.setDate(s.getDate()+((8-e)%7||7));const o=s.getHours()<17?new Date().setHours(18,0,0,0):null,u=t.setHours(8,0,0,0),d=[0,5,6].includes(e)?null:a.setHours(8,0,0,0),p=e!==0?n.setHours(8,0,0,0):null;return[{key:"laterToday",timestamp:o,label:(0,r.t)("spreed","Later today \u2013 {timeLocale}",{timeLocale:(0,z.A)(o).format("LT")}),ariaLabel:(0,r.t)("spreed","Set reminder for later today")},{key:"tomorrow",timestamp:u,label:(0,r.t)("spreed","Tomorrow \u2013 {timeLocale}",{timeLocale:(0,z.A)(u).format("ddd LT")}),ariaLabel:(0,r.t)("spreed","Set reminder for tomorrow")},{key:"thisWeekend",timestamp:d,label:(0,r.t)("spreed","This weekend \u2013 {timeLocale}",{timeLocale:(0,z.A)(d).format("ddd LT")}),ariaLabel:(0,r.t)("spreed","Set reminder for this weekend")},{key:"nextWeek",timestamp:p,label:(0,r.t)("spreed","Next week \u2013 {timeLocale}",{timeLocale:(0,z.A)(p).format("ddd LT")}),ariaLabel:(0,r.t)("spreed","Set reminder for next week")}].filter(c=>c.timestamp!==null)},clearReminderLabel(){return this.currentReminder?(0,r.t)("spreed","Clear reminder \u2013 {timeLocale}",{timeLocale:(0,z.A)(this.currentReminder.timestamp*1e3).format("ddd LT")}):""},lastEditActorLabel(){return(0,r.t)("spreed","Edited by {actor}",{actor:this.message.lastEditActorDisplayName})},canReply(){return this.message.isReplyable&&!this.isConversationReadOnly&&(this.conversation.permissions&m._z.PERMISSIONS.CHAT)!==0}},watch:{submenu(s){s==="reminder"&&this.getReminder()}},methods:{t:r.t,handleReply(){this.$emit("reply")},async handlePrivateReply(){const s=await this.$store.dispatch("createOneToOneConversation",this.message.actorId);this.$router.push({name:"conversation",params:{token:s.token}}).catch(e=>console.debug(`Error while pushing the new conversation's route: ${e}`))},async handleCopyMessageText(){const s=(0,jt.X)(this.message.message,this.message.messageParameters);try{await navigator.clipboard.writeText(s),(0,x.Te)((0,r.t)("spreed","Message text copied to clipboard"))}catch{(0,x.Qg)((0,r.t)("spreed","Message text could not be copied"))}},handleCopyMessageLink(){(0,pr.EP)(this.message.token,this.message.id)},async handleMarkAsUnread(){await this.$store.dispatch("updateLastReadMessage",{token:this.message.token,id:this.previousMessageId,updateVisually:!0})},handleReactionClick(s){this.message.reactionsSelf?.includes(s)?(console.debug("user has already reacted, removing reaction"),this.reactionsStore.removeReactionFromMessage({token:this.message.token,messageId:this.message.id,selectedEmoji:s})):this.reactionsStore.addReactionToMessage({token:this.message.token,messageId:this.message.id,selectedEmoji:s}),this.closeReactionsMenu()},handleMessageAction(s){s.callback({message:this.message,metadata:this.conversation,apiVersion:"v3"})},handleDelete(){this.$emit("delete")},onMenuOpen(){this.$emit("update:isActionMenuOpen",!0)},onMenuClose(){this.$emit("update:isActionMenuOpen",!1)},onEmojiPickerOpen(){this.updateFrequentlyUsedEmojis(),this.$emit("update:isEmojiPickerOpen",!0)},onEmojiPickerClose(){this.$emit("update:isEmojiPickerOpen",!1)},openReactionsMenu(){this.updateFrequentlyUsedEmojis(),this.$emit("update:isReactionsMenuOpen",!0)},async forwardToNote(){try{await this.$store.dispatch("forwardMessage",{messageToBeForwarded:this.$store.getters.message(this.message.token,this.message.id)}),(0,x.Te)((0,r.t)("spreed",'Message forwarded to "Note to self"'))}catch(s){console.error('Error while forwarding message to "Note to self"',s),(0,x.Qg)((0,r.t)("spreed",'Error while forwarding message to "Note to self"'))}},openForwarder(){this.$emit("update:isForwarderOpen",!0)},handleClickOutside(s){s.composedPath().some(e=>e.classList?.contains("v-popper__popper--shown"))||s.composedPath().includes(this.$el)||this.closeReactionsMenu()},closeReactionsMenu(){this.$emit("update:isReactionsMenuOpen",!1)},updateFrequentlyUsedEmojis(){this.frequentlyUsedEmojis=(0,Ya.e)("",5).map(s=>s.native)},async getReminder(){try{const s=await nr(this.message.token,this.message.id);this.currentReminder=s.data.ocs.data}catch(s){console.debug(s)}},async removeReminder(){try{await lr(this.message.token,this.message.id),(0,x.Te)((0,r.t)("spreed","A reminder was successfully removed"))}catch(s){console.error(s),(0,x.Qg)((0,r.t)("spreed","Error occurred when removing a reminder"))}},async setReminder(s){try{await or(this.message.token,this.message.id,(0,et.pf)(s)),(0,x.Te)((0,r.t)("spreed","A reminder was successfully set at {datetime}",{datetime:(0,z.A)(s).format("LLL")}))}catch(e){console.error(e),(0,x.Qg)((0,r.t)("spreed","Error occurred when creating a reminder"))}},editMessage(){this.isEditable&&this.$emit("edit")}}};var tt=i(76384),ne={};ne.styleTagTransform=R(),ne.setAttributes=O(),ne.insert=P().bind(null,"head"),ne.domAPI=I(),ne.insertStyleElement=L();var Qc=T()(tt.A,ne);const qc=tt.A&&tt.A.locals?tt.A.locals:void 0;var gr=(0,b.A)(Ar,Ga,Ka,!1,null,"8025549a",null);const mr=gr.exports;var Cr=function(){var e=this,t=e._self._c;return t("div",{staticClass:"message-forwarder"},[e.showForwardedConfirmation?t("NcDialog",{attrs:{name:e.dialogTitle,"close-on-click-outside":""},on:{"update:open":e.handleClose},scopedSlots:e._u([{key:"actions",fn:function(){return[t("NcButton",{attrs:{type:"tertiary"},on:{click:e.handleClose}},[e._v(`
				`+e._s(e.t("spreed","Dismiss"))+`
			`)]),e._v(" "),t("NcButton",{attrs:{type:"primary"},on:{click:e.openConversation}},[e._v(`
				`+e._s(e.t("spreed","Go to conversation"))+`
			`)])]},proxy:!0}])},[t("NcEmptyContent",{attrs:{description:e.t("spreed","The message has been forwarded to {selectedConversationName}",{selectedConversationName:e.selectedConversationName})},scopedSlots:e._u([{key:"icon",fn:function(){return[t("Check",{attrs:{size:64}})]},proxy:!0}])})],1):t("RoomSelector",{attrs:{"show-postable-only":"","allow-federation":"","dialog-title":e.dialogTitle,"dialog-subtitle":e.dialogSubtitle},on:{select:e.setSelectedConversationToken,close:e.handleClose}})],1)},vr=[],We=i(94219),us=i(49818),hr=i(40854),e_=i(44425),fr=(0,b.A)(hr.A,us.X,us.Y,!1,null,"1c375b1a",null);const Dr=fr.exports,yr={name:"MessageForwarder",components:{Check:qe.A,NcButton:U.A,NcDialog:We.A,NcEmptyContent:Z.A,RoomSelector:Dr},props:{token:{type:String,required:!0},id:{type:[String,Number],required:!0}},emits:["close"],setup(){const s=(0,l.KR)(null),e=(0,l.KR)(null),t=(0,l.KR)(!1),a=(0,l.KR)("");return{isTalkMainApp:(0,l.WQ)("Talk:isMainApp",!1),selectedConversationToken:s,selectedConversationName:e,showForwardedConfirmation:t,forwardedMessageID:a}},computed:{dialogTitle(){return(0,r.t)("spreed","Forward message")},dialogSubtitle(){return(0,r.t)("spreed","Choose a conversation to forward the selected message.")}},methods:{t:r.t,async setSelectedConversationToken(s){this.selectedConversationToken=s.token,this.selectedConversationName=s.displayName;try{const e=await this.$store.dispatch("forwardMessage",{targetToken:this.selectedConversationToken,messageToBeForwarded:this.$store.getters.message(this.token,this.id)});this.forwardedMessageID=e.data.ocs.data.id,this.showForwardedConfirmation=!0}catch(e){console.error("Error while forwarding message",e),(0,x.Qg)((0,r.t)("spreed","Error while forwarding message"))}},openConversation(){if(this.isTalkMainApp)this.$router.push({name:"conversation",hash:`#message_${this.forwardedMessageID}`,params:{token:`${this.selectedConversationToken}`}}).catch(s=>console.debug(`Error while pushing the new conversation's route: ${s}`));else{const s=(0,Y.Jv)("/call/{token}#message_{messageId}",{token:this.selectedConversationToken,messageId:this.forwardedMessageID});window.open(s,"_blank").focus()}this.showForwardedConfirmation=!1,this.forwardedMessageID="",this.$emit("close")},handleClose(){this.$emit("close")}}};var Er=(0,b.A)(yr,Cr,vr,!1,null,null,null);const br=Er.exports;var Mr=function(){var e=this,t=e._self._c;return t("NcDialog",{ref:"translateDialog",staticClass:"translate-dialog",attrs:{name:e.t("spreed","Translate message"),size:"large","close-on-click-outside":""},on:{"update:open":function(a){return e.$emit("close")}},scopedSlots:e._u([e.isMounted?{key:"default",fn:function(){return[t("div",{staticClass:"translate-dialog__wrapper"},[t("NcSelect",{staticClass:"translate-dialog__select",attrs:{"input-id":"from","aria-label-combobox":e.t("spreed","Source language to translate from"),placeholder:e.t("spreed","Translate from"),options:e.optionsFrom,"no-wrap":""},model:{value:e.selectedFrom,callback:function(a){e.selectedFrom=a},expression:"selectedFrom"}}),e._v(" "),t("ArrowRight",{staticClass:"bidirectional-icon"}),e._v(" "),t("NcSelect",{staticClass:"translate-dialog__select",attrs:{"input-id":"to","aria-label-combobox":e.t("spreed","Target language to translate into"),placeholder:e.t("spreed","Translate to"),options:e.optionsTo,"no-wrap":""},model:{value:e.selectedTo,callback:function(a){e.selectedTo=a},expression:"selectedTo"}}),e._v(" "),t("NcButton",{staticClass:"translate-dialog__button",attrs:{type:"primary",disabled:e.isLoading},on:{click:e.handleTranslate},scopedSlots:e._u([e.isLoading?{key:"icon",fn:function(){return[t("NcLoadingIcon")]},proxy:!0}:null],null,!0)},[e._v(`
				`+e._s(e.isLoading?e.t("spreed","Translating"):e.t("spreed","Translate"))+`
			`)])],1),e._v(" "),t("NcRichText",{staticClass:"translate-dialog__message translate-dialog__message-source",attrs:{text:e.message,arguments:e.richParameters,"reference-limit":0}}),e._v(" "),e.translatedMessage?t("NcRichText",{staticClass:"translate-dialog__message translate-dialog__message-translation",attrs:{text:e.translatedMessage,arguments:e.richParameters,"reference-limit":0}}):e._e()]},proxy:!0}:null,e.translatedMessage?{key:"actions",fn:function(){return[t("NcButton",{on:{click:e.handleCopyTranslation},scopedSlots:e._u([{key:"icon",fn:function(){return[t("ContentCopy")]},proxy:!0}],null,!1,1967269327)},[e._v(`
			`+e._s(e.t("spreed","Copy translated text"))+`
		`)])]},proxy:!0}:null],null,!0)})},Fr=[],ds=i(64508),cs=i(67607),Br=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon arrow-right-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},kr=[];const Sr={name:"ArrowRightIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Tr=(0,b.A)(Sr,Br,kr,!1,null,null,null);const Ir=Tr.exports,Pr=async function(s){return q.Ay.get((0,Y.KT)("/translation/languages",void 0,s),s)},Or=async function(s,e,t,a){return q.Ay.post((0,Y.KT)("/translation/translate",void 0,a),{text:s,fromLanguage:e,toLanguage:t},a)},Lr={name:"MessageTranslateDialog",components:{NcButton:U.A,NcDialog:We.A,NcLoadingIcon:te.A,NcRichText:ds.Ay,NcSelect:cs.A,ArrowRight:Ir,ContentCopy:Rt.A},props:{message:{type:String,required:!0},richParameters:{type:Object,required:!0}},emits:["close"],data(){return{isMounted:!1,availableLanguages:null,selectedFrom:null,selectedTo:null,isLoading:!1,translatedMessage:""}},computed:{userLanguage(){return navigator.language.substring(0,2)},sourceTree(){const s={};return Array.from(new Set(this.availableLanguages?.map(t=>t.from))).forEach(t=>{s[t]={id:t,label:this.availableLanguages?.find(a=>a.from===t)?.fromLabel,translations:this.availableLanguages?.filter(a=>a.from===t).map(a=>({id:a.to,label:a.toLabel}))}}),s},translationTree(){const s={};return Array.from(new Set(this.availableLanguages?.map(t=>t.to))).forEach(t=>{s[t]={id:t,label:this.availableLanguages?.find(a=>a.to===t)?.toLabel,sources:this.availableLanguages?.filter(a=>a.to===t).map(a=>({id:a.from,label:a.fromLabel}))}}),s},optionsFrom(){return this.selectedTo?.id?this.translationTree[this.selectedTo?.id]?.sources:Object.values(this.sourceTree).map(s=>({id:s.id,label:s.label}))},optionsTo(){return this.selectedFrom?.id?this.sourceTree[this.selectedFrom?.id]?.translations:Object.values(this.translationTree).map(s=>({id:s.id,label:s.label}))}},watch:{selectedTo(){this.translatedMessage=""},selectedFrom(){this.translatedMessage=""}},async created(){const s=await Pr();this.availableLanguages=s.data.ocs.data.languages},mounted(){this.selectedTo=this.optionsTo.find(s=>s.id===this.userLanguage)||null,this.selectedTo&&this.translateMessage(),this.$nextTick(()=>{this.isMounted=!!this.$refs.translateDialog.navigationId})},methods:{t:r.t,handleTranslate(){this.translateMessage(this.selectedFrom?.id)},async translateMessage(s=null){try{this.isLoading=!0;const e=await Or(this.message,s,this.selectedTo?.id);this.translatedMessage=e.data.ocs.data.text}catch(e){console.error(e),(0,x.Qg)(e.response?.data?.ocs?.data?.message??(0,r.t)("spreed","The message could not be translated"))}finally{this.isLoading=!1}},async handleCopyTranslation(){try{await navigator.clipboard.writeText(this.translatedMessage),(0,x.Te)((0,r.t)("spreed","Translation copied to clipboard"))}catch{(0,x.Qg)((0,r.t)("spreed","Translation could not be copied"))}}}};var st=i(93003),oe={};oe.styleTagTransform=R(),oe.setAttributes=O(),oe.insert=P().bind(null,"head"),oe.domAPI=I(),oe.insertStyleElement=L();var i_=T()(st.A,oe);const r_=st.A&&st.A.locals?st.A.locals:void 0;var Rr=(0,b.A)(Lr,Mr,Fr,!1,null,"6dd63ec4",null);const xr=Rr.exports;var wr=function(){var e=this,t=e._self._c;return t("a",{staticClass:"contact",attrs:{href:e.link,"aria-label":e.contactAriaLabel,target:"_blank"}},[e.contactPhotoFromBase64?t("img",{class:{contact__image:e.contactHasPhoto,contact__icon:!e.contactHasPhoto},attrs:{alt:"",src:e.contactPhotoFromBase64}}):e._e(),e._v(" "),t("div",{staticClass:"contact__lineone"},[t("div",{staticClass:"title"},[e._v(`
			`+e._s(e.displayName)+`
		`)])])])},Nr=[];const jr={name:"Contact",props:{name:{type:String,required:!0},link:{type:String,required:!0},contactName:{type:String,default:""},contactPhoto:{type:String,default:""},contactPhotoMimetype:{type:String,default:""}},computed:{contactHasPhoto(){return this.contactPhotoMimetype&&this.contactPhoto},contactPhotoFromBase64(){return this.contactHasPhoto?"data:"+this.contactPhotoMimetype+";base64,"+this.contactPhoto:OC.MimeType.getIconUrl("text/vcard")},displayName(){return this.contactName||this.name},contactAriaLabel(){return(0,r.t)("spreed","Contact")}},methods:{t:r.t}};var at=i(92510),le={};le.styleTagTransform=R(),le.setAttributes=O(),le.insert=P().bind(null,"head"),le.domAPI=I(),le.insertStyleElement=L();var o_=T()(at.A,le);const l_=at.A&&at.A.locals?at.A.locals:void 0;var Ur=(0,b.A)(jr,wr,Nr,!1,null,"e44aa098",null);const $r=Ur.exports;var Vr=function(){var e=this,t=e._self._c;return t("a",{staticClass:"deck-card",class:{wide:e.wide},attrs:{href:e.link,"aria-label":e.deckCardAriaLabel,target:"_blank"}},[t("div",{staticClass:"deck-card__lineone"},[t("div",{staticClass:"icon-deck"}),e._v(" "),t("div",{staticClass:"title"},[e._v(`
			`+e._s(e.name)+`
		`)])]),e._v(" "),t("div",{staticClass:"deck-card__linetwo"},[t("div",[e._v(`
			`+e._s(e.deckLocation)+`
		`)])])])},Wr=[];const zr={name:"DeckCard",props:{type:{type:String,required:!0},id:{type:String,required:!0},name:{type:String,required:!0},boardname:{type:String,required:!0},stackname:{type:String,required:!0},link:{type:String,required:!0},wide:{type:Boolean,default:!1}},computed:{deckLocation(){return(0,r.t)("spreed","{stack} in {board}",{stack:this.stackname,board:this.boardname})},deckCardAriaLabel(){return(0,r.t)("spreed","Deck Card")}},methods:{t:r.t}};var it=i(35304),ue={};ue.styleTagTransform=R(),ue.setAttributes=O(),ue.insert=P().bind(null,"head"),ue.domAPI=I(),ue.insertStyleElement=L();var d_=T()(it.A,ue);const c_=it.A&&it.A.locals?it.A.locals:void 0;var Hr=(0,b.A)(zr,Vr,Wr,!1,null,"db6a7cf8",null);const Gr=Hr.exports;var Kr=i(27974),_s=i(99708),Yr=function(){var e=this,t=e._self._c;return t("a",{staticClass:"location",class:{wide:e.wide},attrs:{href:e.mapLink,target:"_blank",rel:"noopener noreferrer","aria-label":e.linkAriaLabel}},[t("LMap",{attrs:{zoom:e.previewZoom,center:e.center,options:{scrollWheelZoom:!1,zoomControl:!1,dragging:!1,attributionControl:!1}},on:{scroll:function(a){a.preventDefault()}}},[t("LTileLayer",{attrs:{url:e.url}}),e._v(" "),t("LControlAttribution",{attrs:{position:"bottomright",prefix:e.attribution}}),e._v(" "),t("LMarker",{attrs:{"lat-lng":e.center}},[t("LTooltip",{attrs:{options:{direction:"top",permanent:"true",offset:[-16,-14]}}},[e._v(`
				`+e._s(e.name)+`
			`)])],1)],1)],1)},Xr=[],j=i(53481),Jr=function(s){return!s||typeof s.charAt!="function"?s:s.charAt(0).toUpperCase()+s.slice(1)},Zr=function(s,e,t,a){var n=function(u){var d="set"+Jr(u),p=t[u].type===Object||t[u].type===Array||Array.isArray(t[u].type);t[u].custom&&s[d]?s.$watch(u,function(c,_){s[d](c,_)},{deep:p}):d==="setOptions"?s.$watch(u,function(c,_){(0,j.setOptions)(e,c)},{deep:p}):e[d]&&s.$watch(u,function(c,_){e[d](c)},{deep:p})};for(var o in t)n(o)},ps=function(s){var e={};for(var t in s){var a=s[t];a!=null&&(e[t]=a)}return e},Qr=function(s,e){var t=e.options&&e.options.constructor===Object?e.options:{};s=s&&s.constructor===Object?s:{};var a=ps(t);s=ps(s);var n=e.$options.props;for(var o in s){var u=n[o]?n[o].default&&typeof n[o].default=="function"?n[o].default.call():n[o].default:Symbol("unique"),d=!1;Array.isArray(u)?d=JSON.stringify(u)===JSON.stringify(s[o]):d=u===s[o],a[o]&&!d?(console.warn(o+" props is overriding the value passed in the options props"),a[o]=s[o]):a[o]||(a[o]=s[o])}return a},qr={props:{position:{type:String,default:"topright"}},mounted:function(){this.controlOptions={position:this.position}},beforeDestroy:function(){this.mapObject&&this.mapObject.remove()}},en={props:{options:{type:Object,default:function(){return{}}}}},tn={name:"LControlAttribution",mixins:[qr,en],props:{prefix:{type:[String,Boolean],default:null}},mounted:function(){var e=this,t=Qr(Object.assign({},this.controlOptions,{prefix:this.prefix}),this);this.mapObject=j.control.attribution(t),Zr(this,this.mapObject,this.$options.props),this.mapObject.addTo(this.$parent.mapObject),this.$nextTick(function(){e.$emit("ready",e.mapObject)})},render:function(){return null}};function sn(s,e,t,a,n,o,u,d,p,c){typeof u!="boolean"&&(p=d,d=u,u=!1);var _=typeof t=="function"?t.options:t;s&&s.render&&(_.render=s.render,_.staticRenderFns=s.staticRenderFns,_._compiled=!0,n&&(_.functional=!0)),a&&(_._scopeId=a);var g;if(o?(g=function(A){A=A||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!A&&typeof __VUE_SSR_CONTEXT__<"u"&&(A=__VUE_SSR_CONTEXT__),e&&e.call(this,p(A)),A&&A._registeredComponents&&A._registeredComponents.add(o)},_._ssrRegister=g):e&&(g=u?function(A){e.call(this,c(A,this.$root.$options.shadowRoot))}:function(A){e.call(this,d(A))}),g)if(_.functional){var C=_.render;_.render=function(B,k){return g.call(k),C(B,k)}}else{var M=_.beforeCreate;_.beforeCreate=M?[].concat(M,g):[g]}return t}var an=tn,rn=void 0,nn=void 0,on=void 0,ln=void 0,un=sn({},rn,an,nn,ln,on,!1,void 0,void 0,void 0);const dn=un;var cn=function(s){return!s||typeof s.charAt!="function"?s:s.charAt(0).toUpperCase()+s.slice(1)},_n=function(s,e,t,a){var n=function(u){var d="set"+cn(u),p=t[u].type===Object||t[u].type===Array||Array.isArray(t[u].type);t[u].custom&&s[d]?s.$watch(u,function(c,_){s[d](c,_)},{deep:p}):d==="setOptions"?s.$watch(u,function(c,_){(0,j.setOptions)(e,c)},{deep:p}):e[d]&&s.$watch(u,function(c,_){e[d](c)},{deep:p})};for(var o in t)n(o)},As=function(s){var e={};for(var t in s){var a=s[t];a!=null&&(e[t]=a)}return e},pn=function(s,e){var t=e.options&&e.options.constructor===Object?e.options:{};s=s&&s.constructor===Object?s:{};var a=As(t);s=As(s);var n=e.$options.props;for(var o in s){var u=n[o]?n[o].default&&typeof n[o].default=="function"?n[o].default.call():n[o].default:Symbol("unique"),d=!1;Array.isArray(u)?d=JSON.stringify(u)===JSON.stringify(s[o]):d=u===s[o],a[o]&&!d?(console.warn(o+" props is overriding the value passed in the options props"),a[o]=s[o]):a[o]||(a[o]=s[o])}return a},An=function(s){for(var e=!1;s&&!e;)s.mapObject===void 0?s=s.$parent:e=!0;return s},gn={props:{pane:{type:String,default:"overlayPane"},attribution:{type:String,default:null,custom:!0},name:{type:String,custom:!0,default:void 0},layerType:{type:String,custom:!0,default:void 0},visible:{type:Boolean,custom:!0,default:!0}},mounted:function(){this.layerOptions={attribution:this.attribution,pane:this.pane}},beforeDestroy:function(){this.unbindPopup(),this.unbindTooltip(),this.parentContainer.removeLayer(this)},methods:{setAttribution:function(e,t){var a=this.$parent.mapObject.attributionControl;a.removeAttribution(t).addAttribution(e)},setName:function(){this.parentContainer.removeLayer(this),this.visible&&this.parentContainer.addLayer(this)},setLayerType:function(){this.parentContainer.removeLayer(this),this.visible&&this.parentContainer.addLayer(this)},setVisible:function(e){this.mapObject&&(e?this.parentContainer.addLayer(this):this.parentContainer.hideLayer?this.parentContainer.hideLayer(this):this.parentContainer.removeLayer(this))},unbindTooltip:function(){var e=this.mapObject?this.mapObject.getTooltip():null;e&&e.unbindTooltip()},unbindPopup:function(){var e=this.mapObject?this.mapObject.getPopup():null;e&&e.unbindPopup()},updateVisibleProp:function(e){this.$emit("update:visible",e)}}},mn={mixins:[gn],props:{pane:{type:String,default:"tilePane"},opacity:{type:Number,custom:!1,default:1},zIndex:{type:Number,default:1},tileSize:{type:Number,default:256},noWrap:{type:Boolean,default:!1}},mounted:function(){this.gridLayerOptions=Object.assign({},this.layerOptions,{pane:this.pane,opacity:this.opacity,zIndex:this.zIndex,tileSize:this.tileSize,noWrap:this.noWrap})}},Cn={mixins:[mn],props:{tms:{type:Boolean,default:!1},subdomains:{type:[String,Array],default:"abc",validator:function(s){return typeof s=="string"?!0:Array.isArray(s)?s.every(function(e){return typeof e=="string"}):!1}},detectRetina:{type:Boolean,default:!1}},mounted:function(){this.tileLayerOptions=Object.assign({},this.gridLayerOptions,{tms:this.tms,subdomains:this.subdomains,detectRetina:this.detectRetina})},render:function(){return null}},vn={props:{options:{type:Object,default:function(){return{}}}}},hn={name:"LTileLayer",mixins:[Cn,vn],props:{url:{type:String,default:null},tileLayerClass:{type:Function,default:j.tileLayer}},mounted:function(){var e=this,t=pn(this.tileLayerOptions,this);this.mapObject=this.tileLayerClass(this.url,t),j.DomEvent.on(this.mapObject,this.$listeners),_n(this,this.mapObject,this.$options.props),this.parentContainer=An(this.$parent),this.parentContainer.addLayer(this,!this.visible),this.$nextTick(function(){e.$emit("ready",e.mapObject)})}};function fn(s,e,t,a,n,o,u,d,p,c){typeof u!="boolean"&&(p=d,d=u,u=!1);var _=typeof t=="function"?t.options:t;s&&s.render&&(_.render=s.render,_.staticRenderFns=s.staticRenderFns,_._compiled=!0,n&&(_.functional=!0)),a&&(_._scopeId=a);var g;if(o?(g=function(A){A=A||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!A&&typeof __VUE_SSR_CONTEXT__<"u"&&(A=__VUE_SSR_CONTEXT__),e&&e.call(this,p(A)),A&&A._registeredComponents&&A._registeredComponents.add(o)},_._ssrRegister=g):e&&(g=u?function(A){e.call(this,c(A,this.$root.$options.shadowRoot))}:function(A){e.call(this,d(A))}),g)if(_.functional){var C=_.render;_.render=function(B,k){return g.call(k),C(B,k)}}else{var M=_.beforeCreate;_.beforeCreate=M?[].concat(M,g):[g]}return t}var Dn=hn,yn=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div")},En=[],bn=void 0,Mn=void 0,Fn=void 0,Bn=!1,kn=fn({render:yn,staticRenderFns:En},bn,Dn,Mn,Bn,Fn,!1,void 0,void 0,void 0);const Sn=kn;var Tn=function(s,e){var t,a=function(){for(var n=[],o=arguments.length;o--;)n[o]=arguments[o];var u=this;t&&clearTimeout(t),t=setTimeout(function(){s.apply(u,n),t=null},e)};return a.cancel=function(){t&&clearTimeout(t)},a},In=function(s){return!s||typeof s.charAt!="function"?s:s.charAt(0).toUpperCase()+s.slice(1)},Pn=function(s,e,t,a){var n=function(u){var d="set"+In(u),p=t[u].type===Object||t[u].type===Array||Array.isArray(t[u].type);t[u].custom&&s[d]?s.$watch(u,function(c,_){s[d](c,_)},{deep:p}):d==="setOptions"?s.$watch(u,function(c,_){(0,j.setOptions)(e,c)},{deep:p}):e[d]&&s.$watch(u,function(c,_){e[d](c)},{deep:p})};for(var o in t)n(o)},gs=function(s){var e={};for(var t in s){var a=s[t];a!=null&&(e[t]=a)}return e},On=function(s,e){var t=e.options&&e.options.constructor===Object?e.options:{};s=s&&s.constructor===Object?s:{};var a=gs(t);s=gs(s);var n=e.$options.props;for(var o in s){var u=n[o]?n[o].default&&typeof n[o].default=="function"?n[o].default.call():n[o].default:Symbol("unique"),d=!1;Array.isArray(u)?d=JSON.stringify(u)===JSON.stringify(s[o]):d=u===s[o],a[o]&&!d?(console.warn(o+" props is overriding the value passed in the options props"),a[o]=s[o]):a[o]||(a[o]=s[o])}return a},Ln={props:{options:{type:Object,default:function(){return{}}}}},Rn={name:"LMap",mixins:[Ln],props:{center:{type:[Object,Array],custom:!0,default:function(){return[0,0]}},bounds:{type:[Array,Object],custom:!0,default:null},maxBounds:{type:[Array,Object],default:null},zoom:{type:Number,custom:!0,default:0},minZoom:{type:Number,default:null},maxZoom:{type:Number,default:null},paddingBottomRight:{type:Array,custom:!0,default:null},paddingTopLeft:{type:Array,custom:!0,default:null},padding:{type:Array,custom:!0,default:null},worldCopyJump:{type:Boolean,default:!1},crs:{type:Object,custom:!0,default:function(){return j.CRS.EPSG3857}},maxBoundsViscosity:{type:Number,default:null},inertia:{type:Boolean,default:null},inertiaDeceleration:{type:Number,default:null},inertiaMaxSpeed:{type:Number,default:null},easeLinearity:{type:Number,default:null},zoomAnimation:{type:Boolean,default:null},zoomAnimationThreshold:{type:Number,default:null},fadeAnimation:{type:Boolean,default:null},markerZoomAnimation:{type:Boolean,default:null},noBlockingAnimations:{type:Boolean,default:!1}},data:function(){return{ready:!1,lastSetCenter:this.center?(0,j.latLng)(this.center):null,lastSetBounds:this.bounds?(0,j.latLngBounds)(this.bounds):null,layerControl:void 0,layersToAdd:[],layersInControl:[]}},computed:{fitBoundsOptions:function(){var e={animate:this.noBlockingAnimations?!1:null};return this.padding?e.padding=this.padding:(this.paddingBottomRight&&(e.paddingBottomRight=this.paddingBottomRight),this.paddingTopLeft&&(e.paddingTopLeft=this.paddingTopLeft)),e}},beforeDestroy:function(){this.debouncedMoveEndHandler&&this.debouncedMoveEndHandler.cancel(),this.mapObject&&this.mapObject.remove()},mounted:function(){var e=this,t=On({minZoom:this.minZoom,maxZoom:this.maxZoom,maxBounds:this.maxBounds,maxBoundsViscosity:this.maxBoundsViscosity,worldCopyJump:this.worldCopyJump,crs:this.crs,center:this.center,zoom:this.zoom,inertia:this.inertia,inertiaDeceleration:this.inertiaDeceleration,inertiaMaxSpeed:this.inertiaMaxSpeed,easeLinearity:this.easeLinearity,zoomAnimation:this.zoomAnimation,zoomAnimationThreshold:this.zoomAnimationThreshold,fadeAnimation:this.fadeAnimation,markerZoomAnimation:this.markerZoomAnimation},this);this.mapObject=(0,j.map)(this.$el,t),this.bounds&&this.fitBounds(this.bounds),this.debouncedMoveEndHandler=Tn(this.moveEndHandler,100),this.mapObject.on("moveend",this.debouncedMoveEndHandler),this.mapObject.on("overlayadd",this.overlayAddHandler),this.mapObject.on("overlayremove",this.overlayRemoveHandler),j.DomEvent.on(this.mapObject,this.$listeners),Pn(this,this.mapObject,this.$options.props),this.ready=!0,this.$emit("leaflet:load"),this.$nextTick(function(){e.$emit("ready",e.mapObject)})},methods:{registerLayerControl:function(e){var t=this;this.layerControl=e,this.mapObject.addControl(e.mapObject),this.layersToAdd.forEach(function(a){t.layerControl.addLayer(a)}),this.layersToAdd=[]},addLayer:function(e,t){if(e.layerType!==void 0)if(this.layerControl===void 0)this.layersToAdd.push(e);else{var a=this.layersInControl.find(function(n){return n.mapObject._leaflet_id===e.mapObject._leaflet_id});a||(this.layerControl.addLayer(e),this.layersInControl.push(e))}!t&&e.visible!==!1&&this.mapObject.addLayer(e.mapObject)},hideLayer:function(e){this.mapObject.removeLayer(e.mapObject)},removeLayer:function(e,t){e.layerType!==void 0&&(this.layerControl===void 0?this.layersToAdd=this.layersToAdd.filter(function(a){return a.name!==e.name}):(this.layerControl.removeLayer(e),this.layersInControl=this.layersInControl.filter(function(a){return a.mapObject._leaflet_id!==e.mapObject._leaflet_id}))),t||this.mapObject.removeLayer(e.mapObject)},setZoom:function(e,t){e!=null&&(this.mapObject.setZoom(e,{animate:this.noBlockingAnimations?!1:null}),this.cacheMapView())},setCenter:function(e,t){if(e!=null){var a=(0,j.latLng)(e),n=this.lastSetCenter||this.mapObject.getCenter();(n.lat!==a.lat||n.lng!==a.lng)&&(this.lastSetCenter=a,this.mapObject.panTo(a,{animate:this.noBlockingAnimations?!1:null}),this.cacheMapView(void 0,a))}},setBounds:function(e,t){if(e){var a=(0,j.latLngBounds)(e);if(a.isValid()){var n=this.lastSetBounds||this.mapObject.getBounds(),o=!n.equals(a,0);o&&(this.fitBounds(a),this.cacheMapView(a))}}},setPaddingBottomRight:function(e,t){this.paddingBottomRight=e},setPaddingTopLeft:function(e,t){this.paddingTopLeft=e},setPadding:function(e,t){this.padding=e},setCrs:function(e,t){var a=this.mapObject,n=a.getBounds();a.options.crs=e,this.fitBounds(n,{animate:!1})},fitBounds:function(e,t){this.mapObject.fitBounds(e,Object.assign({},this.fitBoundsOptions,t))},moveEndHandler:function(){this.$emit("update:zoom",this.mapObject.getZoom());var e=this.mapObject.getCenter();this.$emit("update:center",e);var t=this.mapObject.getBounds();this.$emit("update:bounds",t)},overlayAddHandler:function(e){var t=this.layersInControl.find(function(a){return a.name===e.name});t&&t.updateVisibleProp(!0)},overlayRemoveHandler:function(e){var t=this.layersInControl.find(function(a){return a.name===e.name});t&&t.updateVisibleProp(!1)},cacheMapView:function(e,t){this.lastSetBounds=e||this.mapObject.getBounds(),this.lastSetCenter=t||this.lastSetBounds.getCenter()}}};function xn(s,e,t,a,n,o,u,d,p,c){typeof u!="boolean"&&(p=d,d=u,u=!1);var _=typeof t=="function"?t.options:t;s&&s.render&&(_.render=s.render,_.staticRenderFns=s.staticRenderFns,_._compiled=!0,n&&(_.functional=!0)),a&&(_._scopeId=a);var g;if(o?(g=function(A){A=A||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!A&&typeof __VUE_SSR_CONTEXT__<"u"&&(A=__VUE_SSR_CONTEXT__),e&&e.call(this,p(A)),A&&A._registeredComponents&&A._registeredComponents.add(o)},_._ssrRegister=g):e&&(g=u?function(A){e.call(this,c(A,this.$root.$options.shadowRoot))}:function(A){e.call(this,d(A))}),g)if(_.functional){var C=_.render;_.render=function(B,k){return g.call(k),C(B,k)}}else{var M=_.beforeCreate;_.beforeCreate=M?[].concat(M,g):[g]}return t}var wn=typeof navigator<"u"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function Nn(s){return function(e,t){return jn(e,t)}}var Ut,ms={};function jn(s,e){var t=wn?e.media||"default":s,a=ms[t]||(ms[t]={ids:new Set,styles:[]});if(!a.ids.has(s)){a.ids.add(s);var n=e.source;if(e.map&&(n+=`
/*# sourceURL=`+e.map.sources[0]+" */",n+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(e.map))))+" */"),a.element||(a.element=document.createElement("style"),a.element.type="text/css",e.media&&a.element.setAttribute("media",e.media),Ut===void 0&&(Ut=document.head||document.getElementsByTagName("head")[0]),Ut.appendChild(a.element)),"styleSheet"in a.element)a.styles.push(n),a.element.styleSheet.cssText=a.styles.filter(Boolean).join(`
`);else{var o=a.ids.size-1,u=document.createTextNode(n),d=a.element.childNodes;d[o]&&a.element.removeChild(d[o]),d.length?a.element.insertBefore(u,d[o]):a.element.appendChild(u)}}}var Un=Rn,$n=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",{staticClass:"vue2leaflet-map"},[s.ready?s._t("default"):s._e()],2)},Vn=[],Wn=function(s){s&&s("data-v-09f270aa_0",{source:".vue2leaflet-map{height:100%;width:100%}",map:void 0,media:void 0})},zn=void 0,Hn=void 0,Gn=!1,Kn=xn({render:$n,staticRenderFns:Vn},Wn,Un,zn,Gn,Hn,!1,Nn,void 0,void 0);const Yn=Kn;var Xn=function(s,e){var t,a=function(){for(var n=[],o=arguments.length;o--;)n[o]=arguments[o];var u=this;t&&clearTimeout(t),t=setTimeout(function(){s.apply(u,n),t=null},e)};return a.cancel=function(){t&&clearTimeout(t)},a},Jn=function(s){return!s||typeof s.charAt!="function"?s:s.charAt(0).toUpperCase()+s.slice(1)},Zn=function(s,e,t,a){var n=function(u){var d="set"+Jn(u),p=t[u].type===Object||t[u].type===Array||Array.isArray(t[u].type);t[u].custom&&s[d]?s.$watch(u,function(c,_){s[d](c,_)},{deep:p}):d==="setOptions"?s.$watch(u,function(c,_){(0,j.setOptions)(e,c)},{deep:p}):e[d]&&s.$watch(u,function(c,_){e[d](c)},{deep:p})};for(var o in t)n(o)},Cs=function(s){var e={};for(var t in s){var a=s[t];a!=null&&(e[t]=a)}return e},Qn=function(s,e){var t=e.options&&e.options.constructor===Object?e.options:{};s=s&&s.constructor===Object?s:{};var a=Cs(t);s=Cs(s);var n=e.$options.props;for(var o in s){var u=n[o]?n[o].default&&typeof n[o].default=="function"?n[o].default.call():n[o].default:Symbol("unique"),d=!1;Array.isArray(u)?d=JSON.stringify(u)===JSON.stringify(s[o]):d=u===s[o],a[o]&&!d?(console.warn(o+" props is overriding the value passed in the options props"),a[o]=s[o]):a[o]||(a[o]=s[o])}return a},qn=function(s){for(var e=!1;s&&!e;)s.mapObject===void 0?s=s.$parent:e=!0;return s},eo={props:{pane:{type:String,default:"overlayPane"},attribution:{type:String,default:null,custom:!0},name:{type:String,custom:!0,default:void 0},layerType:{type:String,custom:!0,default:void 0},visible:{type:Boolean,custom:!0,default:!0}},mounted:function(){this.layerOptions={attribution:this.attribution,pane:this.pane}},beforeDestroy:function(){this.unbindPopup(),this.unbindTooltip(),this.parentContainer.removeLayer(this)},methods:{setAttribution:function(e,t){var a=this.$parent.mapObject.attributionControl;a.removeAttribution(t).addAttribution(e)},setName:function(){this.parentContainer.removeLayer(this),this.visible&&this.parentContainer.addLayer(this)},setLayerType:function(){this.parentContainer.removeLayer(this),this.visible&&this.parentContainer.addLayer(this)},setVisible:function(e){this.mapObject&&(e?this.parentContainer.addLayer(this):this.parentContainer.hideLayer?this.parentContainer.hideLayer(this):this.parentContainer.removeLayer(this))},unbindTooltip:function(){var e=this.mapObject?this.mapObject.getTooltip():null;e&&e.unbindTooltip()},unbindPopup:function(){var e=this.mapObject?this.mapObject.getPopup():null;e&&e.unbindPopup()},updateVisibleProp:function(e){this.$emit("update:visible",e)}}},to={props:{options:{type:Object,default:function(){return{}}}}},so={name:"LMarker",mixins:[eo,to],props:{pane:{type:String,default:"markerPane"},draggable:{type:Boolean,custom:!0,default:!1},latLng:{type:[Object,Array],custom:!0,default:null},icon:{type:[Object],custom:!1,default:function(){return new j.Icon.Default}},opacity:{type:Number,custom:!1,default:1},zIndexOffset:{type:Number,custom:!1,default:null}},data:function(){return{ready:!1}},beforeDestroy:function(){this.debouncedLatLngSync&&this.debouncedLatLngSync.cancel()},mounted:function(){var e=this,t=Qn(Object.assign({},this.layerOptions,{icon:this.icon,zIndexOffset:this.zIndexOffset,draggable:this.draggable,opacity:this.opacity}),this);this.mapObject=(0,j.marker)(this.latLng,t),j.DomEvent.on(this.mapObject,this.$listeners),this.debouncedLatLngSync=Xn(this.latLngSync,100),this.mapObject.on("move",this.debouncedLatLngSync),Zn(this,this.mapObject,this.$options.props),this.parentContainer=qn(this.$parent),this.parentContainer.addLayer(this,!this.visible),this.ready=!0,this.$nextTick(function(){e.$emit("ready",e.mapObject)})},methods:{setDraggable:function(e,t){this.mapObject.dragging&&(e?this.mapObject.dragging.enable():this.mapObject.dragging.disable())},setLatLng:function(e){if(e!=null&&this.mapObject){var t=this.mapObject.getLatLng(),a=(0,j.latLng)(e);(a.lat!==t.lat||a.lng!==t.lng)&&this.mapObject.setLatLng(a)}},latLngSync:function(e){this.$emit("update:latLng",e.latlng),this.$emit("update:lat-lng",e.latlng)}},render:function(s){return this.ready&&this.$slots.default?s("div",{style:{display:"none"}},this.$slots.default):null}};function ao(s,e,t,a,n,o,u,d,p,c){typeof u!="boolean"&&(p=d,d=u,u=!1);var _=typeof t=="function"?t.options:t;s&&s.render&&(_.render=s.render,_.staticRenderFns=s.staticRenderFns,_._compiled=!0,n&&(_.functional=!0)),a&&(_._scopeId=a);var g;if(o?(g=function(A){A=A||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!A&&typeof __VUE_SSR_CONTEXT__<"u"&&(A=__VUE_SSR_CONTEXT__),e&&e.call(this,p(A)),A&&A._registeredComponents&&A._registeredComponents.add(o)},_._ssrRegister=g):e&&(g=u?function(A){e.call(this,c(A,this.$root.$options.shadowRoot))}:function(A){e.call(this,d(A))}),g)if(_.functional){var C=_.render;_.render=function(B,k){return g.call(k),C(B,k)}}else{var M=_.beforeCreate;_.beforeCreate=M?[].concat(M,g):[g]}return t}var io=so,ro=void 0,no=void 0,oo=void 0,lo=void 0,uo=ao({},ro,io,no,lo,oo,!1,void 0,void 0,void 0);const co=uo;var _o=function(s){return!s||typeof s.charAt!="function"?s:s.charAt(0).toUpperCase()+s.slice(1)},po=function(s,e,t,a){var n=function(u){var d="set"+_o(u),p=t[u].type===Object||t[u].type===Array||Array.isArray(t[u].type);t[u].custom&&s[d]?s.$watch(u,function(c,_){s[d](c,_)},{deep:p}):d==="setOptions"?s.$watch(u,function(c,_){(0,j.setOptions)(e,c)},{deep:p}):e[d]&&s.$watch(u,function(c,_){e[d](c)},{deep:p})};for(var o in t)n(o)},vs=function(s){var e={};for(var t in s){var a=s[t];a!=null&&(e[t]=a)}return e},Ao=function(s,e){var t=e.options&&e.options.constructor===Object?e.options:{};s=s&&s.constructor===Object?s:{};var a=vs(t);s=vs(s);var n=e.$options.props;for(var o in s){var u=n[o]?n[o].default&&typeof n[o].default=="function"?n[o].default.call():n[o].default:Symbol("unique"),d=!1;Array.isArray(u)?d=JSON.stringify(u)===JSON.stringify(s[o]):d=u===s[o],a[o]&&!d?(console.warn(o+" props is overriding the value passed in the options props"),a[o]=s[o]):a[o]||(a[o]=s[o])}return a},go=function(s){for(var e=!1;s&&!e;)s.mapObject===void 0?s=s.$parent:e=!0;return s},mo={props:{content:{type:String,default:null,custom:!0}},mounted:function(){this.popperOptions={}},methods:{setContent:function(e){this.mapObject&&e!==null&&e!==void 0&&this.mapObject.setContent(e)}},render:function(e){return this.$slots.default?e("div",this.$slots.default):null}},Co={props:{options:{type:Object,default:function(){return{}}}}},vo={name:"LTooltip",mixins:[mo,Co],mounted:function(){var e=this,t=Ao(this.popperOptions,this);this.mapObject=(0,j.tooltip)(t),j.DomEvent.on(this.mapObject,this.$listeners),po(this,this.mapObject,this.$options.props),this.mapObject.setContent(this.content||this.$el),this.parentContainer=go(this.$parent),this.parentContainer.mapObject.bindTooltip(this.mapObject),this.$nextTick(function(){e.$emit("ready",e.mapObject)})},beforeDestroy:function(){this.parentContainer&&(this.parentContainer.unbindTooltip?this.parentContainer.unbindTooltip():this.parentContainer.mapObject&&this.parentContainer.mapObject.unbindTooltip&&this.parentContainer.mapObject.unbindTooltip())}};function ho(s,e,t,a,n,o,u,d,p,c){typeof u!="boolean"&&(p=d,d=u,u=!1);var _=typeof t=="function"?t.options:t;s&&s.render&&(_.render=s.render,_.staticRenderFns=s.staticRenderFns,_._compiled=!0,n&&(_.functional=!0)),a&&(_._scopeId=a);var g;if(o?(g=function(A){A=A||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!A&&typeof __VUE_SSR_CONTEXT__<"u"&&(A=__VUE_SSR_CONTEXT__),e&&e.call(this,p(A)),A&&A._registeredComponents&&A._registeredComponents.add(o)},_._ssrRegister=g):e&&(g=u?function(A){e.call(this,c(A,this.$root.$options.shadowRoot))}:function(A){e.call(this,d(A))}),g)if(_.functional){var C=_.render;_.render=function(B,k){return g.call(k),C(B,k)}}else{var M=_.beforeCreate;_.beforeCreate=M?[].concat(M,g):[g]}return t}var fo=vo,Do=void 0,yo=void 0,Eo=void 0,bo=void 0,Mo=ho({},Do,fo,yo,bo,Eo,!1,void 0,void 0,void 0);const Fo={name:"Location",components:{LControlAttribution:dn,LTileLayer:Sn,LMap:Yn,LMarker:co,LTooltip:Mo},props:{latitude:{type:Number,required:!0},longitude:{type:Number,required:!0},name:{type:String,default:""},wide:{type:Boolean,default:!1}},data(){return{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",previewZoom:13,linkZoom:18,attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}},computed:{center(){return[this.latitude,this.longitude]},mapLink(){return`https://www.openstreetmap.org/?mlat=${this.latitude}&mlon=${this.longitude}#map=${this.linkZoom}/${this.latitude}/${this.longitude}`},linkAriaLabel(){return(0,r.t)("spreed","Open this location in OpenStreetMap")}},methods:{t:r.t}};var rt=i(82085),de={};de.styleTagTransform=R(),de.setAttributes=O(),de.insert=P().bind(null,"head"),de.domAPI=I(),de.insertStyleElement=L();var A_=T()(rt.A,de);const g_=rt.A&&rt.A.locals?rt.A.locals:void 0;var Bo=(0,b.A)(Fo,Yr,Xr,!1,null,"34c47c84",null);const ko=Bo.exports;var So=function(){var e=this,t=e._self._c;return t("span",{ref:"mention",staticClass:"mention"},[e.size?t("NcUserBubble",{key:e.isDarkTheme?"dark":"light",attrs:{"display-name":e.name,"avatar-image":e.avatarUrl,user:e.id,size:e.size,primary:e.primary}}):e._e()],1)},To=[],Io=i(95462),Po=i(77764),hs=i(27393);const Oo={name:"Mention",components:{NcUserBubble:Po.A},props:{token:{type:String,required:!0},type:{type:String,required:!0},id:{type:String,required:!0},name:{type:String,required:!0},server:{type:String,default:""}},setup(){return{isDarkTheme:(0,Io.u)()}},data(){return{size:null}},computed:{isMentionToAll(){return this.type===m.TR.TYPE.CALL},isGroupMention(){return[m.TR.TYPE.USERGROUP,m.TR.TYPE.GROUP].includes(this.type)},isTeamMention(){return[m.TR.TYPE.CIRCLE,m.TR.TYPE.TEAM].includes(this.type)},isMentionToGuest(){return this.type===m.TR.TYPE.GUEST||this.type===m.TR.TYPE.EMAIL},isRemoteUser(){return[m.TR.TYPE.USER,m.TR.TYPE.FEDERATED_USER].includes(this.type)&&this.server!==""},isCurrentGuest(){return this.$store.getters.isActorGuest()&&(this.id==="guest/"+this.$store.getters.getActorId()||this.id===this.$store.getters.getActorId())},isCurrentUser(){return this.isRemoteUser?!1:this.$store.getters.isActorUser()&&this.id===this.$store.getters.getUserId()},isCurrentUserGroup(){return this.isGroupMention&&this.$store.getters.isActorMemberOfGroup(this.id)},isCurrentUserTeam(){return this.isTeamMention&&this.$store.getters.isActorMemberOfTeam(this.id)},primary(){return this.isMentionToAll||this.isCurrentUser||this.isCurrentUserGroup||this.isCurrentUserTeam||this.isMentionToGuest&&this.isCurrentGuest},avatarUrl(){return this.isRemoteUser?this.token?(0,hs.FC)(this.token,this.id+"@"+this.server,this.isDarkTheme,64):"icon-user-forced-white":this.isGroupMention?"icon-group-forced-white":this.isTeamMention?"icon-team-forced-white":this.isMentionToGuest?"icon-user-forced-white":this.isMentionToAll?(0,hs.nv)(this.id,this.isDarkTheme):void 0}},mounted(){this.size=parseInt(window.getComputedStyle(this.$refs.mention).fontSize??15,10)*4/3}};var nt=i(90630),ce={};ce.styleTagTransform=R(),ce.setAttributes=O(),ce.insert=P().bind(null,"head"),ce.domAPI=I(),ce.insertStyleElement=L();var C_=T()(nt.A,ce);const v_=nt.A&&nt.A.locals?nt.A.locals:void 0;var Lo=(0,b.A)(Oo,So,To,!1,null,"37e5c889",null);const Ro=Lo.exports;var xo=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"element-size",rawName:"v-element-size",value:[e.onResize,{width:0,height:22.5}],expression:"[onResize, { width: 0, height: 22.5 }]"},{name:"intersection-observer",rawName:"v-intersection-observer",value:e.onIntersectionObserver,expression:"onIntersectionObserver"}],ref:"messageMain",staticClass:"message-main"},[e.isSystemMessage||e.isDeletedMessage?t("div",{staticClass:"message-main__text",class:{"system-message":e.isSystemMessage&&!e.showJoinCallButton,"deleted-message":e.isDeletedMessage,"message-highlighted":e.showJoinCallButton}},[e.isDeletedMessage?t("CancelIcon",{attrs:{size:16}}):e._e(),e._v(" "),t("NcRichText",{attrs:{text:e.renderedMessage,arguments:e.richParameters,autolink:"",dir:"auto","reference-limit":0}}),e._v(" "),e.showJoinCallButton?t("CallButton"):e.showConversationActionsShortcut?t("ConversationActionsShortcut",{attrs:{token:e.message.token,"object-type":e.conversation.objectType,"is-highlighted":e.isLastMessage}}):e.showResultsButton?t("Poll",e._b({attrs:{token:e.message.token,"show-as-button":""}},"Poll",e.message.messageParameters.poll,!1)):e._e()],1):t("div",{staticClass:"message-main__text markdown-message",class:{"message-highlighted":e.isNewPollMessage},on:{mouseover:e.handleMarkdownMouseOver,mouseleave:e.handleMarkdownMouseLeave}},[e.message.parent?t("Quote",{attrs:{message:e.message.parent}}):e._e(),e._v(" "),t("NcRichText",{class:{"single-emoji":e.isSingleEmoji},attrs:{text:e.renderedMessage,arguments:e.richParameters,autolink:"",dir:"auto",interactive:e.message.markdown&&e.isEditable,"use-extended-markdown":e.message.markdown,"reference-limit":1,"reference-interactive-opt-in":""},on:{"interact:todo":e.handleInteraction}}),e._v(" "),e.containsCodeBlocks?t("NcButton",{directives:[{name:"show",rawName:"v-show",value:e.currentCodeBlock!==null,expression:"currentCodeBlock !== null"}],staticClass:"message-copy-code",style:{top:e.copyButtonOffset},attrs:{type:"tertiary","aria-label":e.t("spreed","Copy code block"),title:e.t("spreed","Copy code block")},on:{click:e.copyCodeBlock},scopedSlots:e._u([{key:"icon",fn:function(){return[t("ContentCopyIcon",{attrs:{size:16}})]},proxy:!0}],null,!1,134070762)}):e._e()],1),e._v(" "),e.isDeletedMessage?e._e():t("div",{staticClass:"message-main__info"},[t("span",{staticClass:"date",class:{"date--hidden":e.hideDate},attrs:{title:e.messageDate}},[e._v(e._s(e.messageTime))]),e._v(" "),e.message.sendingFailure?t("div",{staticClass:"message-status sending-failed",class:{"retry-option":e.sendingErrorCanRetry},attrs:{title:e.sendingErrorIconTitle,"aria-label":e.sendingErrorIconTitle,tabindex:"0"},on:{mouseover:function(a){e.showReloadButton=!0},focus:function(a){e.showReloadButton=!0},mouseleave:function(a){e.showReloadButton=!1},blur:function(a){e.showReloadButton=!1}}},[e.sendingErrorCanRetry&&e.showReloadButton?t("NcButton",{attrs:{size:"small","aria-label":e.sendingErrorIconTitle},on:{click:e.handleRetry},scopedSlots:e._u([{key:"icon",fn:function(){return[t("ReloadIcon",{attrs:{size:16}})]},proxy:!0}],null,!1,3321262167)}):t("AlertCircleIcon",{attrs:{size:16}})],1):e.showLoadingIcon?t("div",{staticClass:"icon-loading-small message-status",attrs:{title:e.loadingIconTitle,"aria-label":e.loadingIconTitle}}):e.readInfo.showCommonReadIcon?t("div",{staticClass:"message-status",attrs:{title:e.readInfo.commonReadIconTitle,"aria-label":e.readInfo.commonReadIconTitle}},[t("CheckAllIcon",{attrs:{size:16}})],1):e.readInfo.showSentIcon?t("div",{staticClass:"message-status",attrs:{title:e.readInfo.sentIconTitle,"aria-label":e.readInfo.sentIconTitle}},[t("CheckIcon",{attrs:{size:16}})],1):e.readInfo.showSilentIcon?t("div",{staticClass:"message-status",attrs:{title:e.readInfo.silentIconTitle,"aria-label":e.readInfo.silentIconTitle}},[t("IconBellOff",{attrs:{size:16}})],1):e._e()]),e._v(" "),e.isDeletedMessage?e._e():e._t("default")],2)},wo=[];const No=()=>/[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26D3\uFE0F?(?:\u200D\uD83D\uDCA5)?|\u26F9(?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF43\uDF45-\uDF4A\uDF4C-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDF44(?:\u200D\uD83D\uDFEB)?|\uDF4B(?:\u200D\uD83D\uDFE9)?|\uDFC3(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4\uDEB5](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC25\uDC27-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE41\uDE43\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC08(?:\u200D\u2B1B)?|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC26(?:\u200D(?:\u2B1B|\uD83D\uDD25))?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE])))?))?|\uDC6F(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDD75(?:\uD83C[\uDFFB-\uDFFF]|\uFE0F)?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?|\uDE42(?:\u200D[\u2194\u2195]\uFE0F?)?|\uDEB6(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF8](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE7C\uDE80-\uDE89\uDE8F-\uDEC2\uDEC6\uDECE-\uDEDC\uDEDF-\uDEE9]|\uDD3C(?:\u200D[\u2640\u2642]\uFE0F?|\uD83C[\uDFFB-\uDFFF])?|\uDDCE(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1|\uDDD1\u200D\uD83E\uDDD2(?:\u200D\uD83E\uDDD2)?|\uDDD2(?:\u200D\uD83E\uDDD2)?))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?)/g;var jo=i(61908),Uo=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon cancel-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M12 2C17.5 2 22 6.5 22 12S17.5 22 12 22 2 17.5 2 12 6.5 2 12 2M12 4C10.1 4 8.4 4.6 7.1 5.7L18.3 16.9C19.3 15.5 20 13.8 20 12C20 7.6 16.4 4 12 4M16.9 18.3L5.7 7.1C4.6 8.4 4 10.1 4 12C4 16.4 7.6 20 12 20C13.9 20 15.6 19.4 16.9 18.3Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},$o=[];const Vo={name:"CancelIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Wo=(0,b.A)(Vo,Uo,$o,!1,null,null,null);const fs=Wo.exports;var zo=i(54841),Ho=i(91520),$t=i(64416),Go=function(){var e=this,t=e._self._c,a=e._self._setupProxy;return a.isShown?t("div",{staticClass:"conversation-actions",class:{"conversation-actions--highlighted":a.props.isHighlighted}},[t("p",[e._v(e._s(a.descriptionLabel))]),e._v(" "),a.isModerator?t("div",{staticClass:"conversation-actions__buttons"},[t(a.NcButton,{attrs:{type:"error"},on:{click:a.showConfirmationDialog},scopedSlots:e._u([{key:"icon",fn:function(){return[t(a.IconDelete)]},proxy:!0}],null,!1,4052220689)},[e._v(`
			`+e._s(a.t("spreed","Delete now"))+`
		`)]),e._v(" "),a.supportsArchive?t(a.NcButton,{attrs:{type:"secondary"},on:{click:a.resetObjectConversation},scopedSlots:e._u([{key:"icon",fn:function(){return[t(a.IconCheckUnderline)]},proxy:!0}],null,!1,3062481e3)},[e._v(`
			`+e._s(a.t("spreed","Keep"))+`
		`)]):e._e()],1):e._e()]):e._e()},Ko=[],Yo=i(98469),Ds=i(40173),ys=i(24387),Xo=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon check-underline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M21,5L9,17L3.5,11.5L4.91,10.09L9,14.17L19.59,3.59L21,5M3,21V19H21V21H3Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Jo=[];const Zo={name:"CheckUnderlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Qo=(0,b.A)(Zo,Xo,Jo,!1,null,null,null);const qo=Qo.exports;var el=i(57548);const tl=(0,l.pM)({__name:"ConversationActionsShortcut",props:{token:null,objectType:null,isHighlighted:{type:Boolean}},setup(s){const e=s,t=(0,N.t0)("local","archived-conversations-v2"),a=(0,l.EW)(()=>(0,N.JR)(e.token,"conversations","retention-event")),n=(0,l.EW)(()=>(0,N.JR)(e.token,"conversations","retention-phone")),o=(0,l.EW)(()=>(0,N.JR)(e.token,"conversations","retention-instant-meetings")),u=(0,ie.P)(),d=(0,ys.rd)(),p=(0,ys.lq)(),c=(0,l.EW)(()=>u.getters.isModerator),_=(0,l.EW)(()=>e.objectType===m.si.OBJECT_TYPE.EVENT?a.value:e.objectType===m.si.OBJECT_TYPE.PHONE_TEMPORARY?n.value:e.objectType===m.si.OBJECT_TYPE.INSTANT_MEETING?o.value:0),g=(0,l.EW)(()=>c.value||_.value!==0),C=(0,l.EW)(()=>{if(_.value===0)return(0,r.t)("spreed","Would you like to delete this conversation?");const k=new Intl.RelativeTimeFormat((0,r.Z0)(),{numeric:"always"}).format(_.value,"days");return(0,r.t)("spreed","This conversation will be automatically deleted for everyone {expirationDurationFormatted} of no activity.",{expirationDurationFormatted:k})});async function M(){try{p?.params?.token===e.token&&await d.push({name:"root"}).catch(k=>!(0,Ds.Pq)(k,Ds.$c.duplicated)&&Promise.reject(k)),await u.dispatch("deleteConversationFromServer",{token:e.token})}catch(k){console.error(`Error while deleting conversation ${k}`),(0,x.Qg)((0,r.t)("spreed","Error while deleting conversation"))}}async function A(){await u.dispatch("unbindConversationFromObject",{token:e.token})}async function B(){(0,Yo.S)(el.A,{name:(0,r.t)("spreed","Delete conversation"),message:(0,r.t)("spreed","Are you sure you want to delete this conversation?"),buttons:[{label:(0,r.t)("spreed","No"),type:"tertiary"},{label:(0,r.t)("spreed","Yes"),type:"error",callback:()=>{M()}}]})}return{__sfc:!0,props:e,supportsArchive:t,retentionEventPeriod:a,retentionPhonePeriod:n,retentionInstantMeetingPeriod:o,store:u,router:d,route:p,isModerator:c,expirationDuration:_,isShown:g,descriptionLabel:C,deleteEventConversation:M,resetObjectConversation:A,showConfirmationDialog:B,t:r.t,NcButton:U.A,IconCheckUnderline:qo,IconDelete:xt.A}}});var ot=i(90158),_e={};_e.styleTagTransform=R(),_e.setAttributes=O(),_e.insert=P().bind(null,"head"),_e.domAPI=I(),_e.insertStyleElement=L();var y_=T()(ot.A,_e);const E_=ot.A&&ot.A.locals?ot.A.locals:void 0;var sl=(0,b.A)(tl,Go,Ko,!1,null,"e0669596",null);const al=sl.exports;var il=function(){var e=this,t=e._self._c;return e.draft?t("div",{staticClass:"poll-card",on:{click:e.openDraft}},[t("span",{staticClass:"poll-card__header poll-card__header--draft"},[t("IconPoll",{staticClass:"poll-card__header-icon",attrs:{size:20}}),e._v(" "),t("span",{staticClass:"poll-card__header-name"},[e._v(e._s(e.name))]),e._v(" "),e.canEditPollDraft?t("NcButton",{attrs:{type:"tertiary",title:e.t("spreed","Edit poll draft"),"aria-label":e.t("spreed","Edit poll draft")},on:{click:function(a){return a.stopPropagation(),e.editDraft.apply(null,arguments)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("IconPencil",{attrs:{size:20}})]},proxy:!0}],null,!1,291764094)}):e._e(),e._v(" "),t("NcButton",{attrs:{type:"tertiary",title:e.t("spreed","Delete poll draft"),"aria-label":e.t("spreed","Delete poll draft")},on:{click:function(a){return a.stopPropagation(),e.deleteDraft.apply(null,arguments)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("IconDelete",{attrs:{size:20}})]},proxy:!0}],null,!1,881161434)})],1),e._v(" "),t("span",{staticClass:"poll-card__footer"},[e._v(`
		`+e._s(e.pollFooterText)+`
	`)])]):e.showAsButton?t("NcButton",{staticClass:"poll-closed",attrs:{type:"secondary"},on:{click:e.openPoll}},[e._v(`
	`+e._s(e.t("spreed","See results"))+`
`)]):t("a",{directives:[{name:"intersection-observer",rawName:"v-intersection-observer",value:e.getPollData,expression:"getPollData"}],staticClass:"poll-card",attrs:{"aria-label":e.t("spreed","Poll"),role:"button"},on:{click:e.openPoll}},[t("span",{staticClass:"poll-card__header"},[t("IconPoll",{staticClass:"poll-card__header-icon",attrs:{size:20}}),e._v(" "),t("span",{staticClass:"poll-card__header-name"},[e._v(e._s(e.name))])],1),e._v(" "),t("span",{staticClass:"poll-card__footer"},[e._v(`
		`+e._s(e.pollFooterText)+`
	`)])])},rl=[],Vt=i(90201),ze=i(72661);const nl={name:"Poll",components:{NcButton:U.A,IconDelete:xt.A,IconPencil:os.A,IconPoll:Vt.A},directives:{IntersectionObserver:Ve.ez},props:{name:{type:String,required:!0},id:{type:String,required:!0},token:{type:String,required:!0},showAsButton:{type:Boolean,default:!1},draft:{type:Boolean,default:!1}},emits:["click"],setup(){return{pollsStore:(0,ze.v)()}},computed:{poll(){return this.draft?this.pollsStore.drafts[this.token][this.id]:this.pollsStore.getPoll(this.token,this.id)},pollFooterText(){return this.poll?.status===m.eE.STATUS.OPEN?this.poll?.votedSelf.length>0?(0,r.t)("spreed","Open poll \u2022 You voted already"):(0,r.t)("spreed","Open poll \u2022 Click to vote"):this.draft?(0,r.n)("spreed","Poll draft \u2022 %n option","Poll draft \u2022 %n options",this.poll?.options?.length):this.poll?.status===m.eE.STATUS.CLOSED?(0,r.t)("spreed","Poll \u2022 Ended"):(0,r.t)("spreed","Poll")},canEditPollDraft(){return this.draft&&(0,N.t0)(this.token,"edit-draft-poll")}},methods:{t:r.t,n:r.n,getPollData(){this.poll||this.pollsStore.getPollData({token:this.token,pollId:this.id})},openDraft(){this.$emit("click",{id:this.id,action:"fill"})},editDraft(){this.$emit("click",{id:this.id,action:"edit"})},deleteDraft(){this.pollsStore.deletePollDraft({token:this.token,pollId:this.id})},openPoll(){this.pollsStore.setActivePoll({token:this.token,pollId:this.id,name:this.name})}}};var lt=i(47618),pe={};pe.styleTagTransform=R(),pe.setAttributes=O(),pe.insert=P().bind(null,"head"),pe.domAPI=I(),pe.insertStyleElement=L();var M_=T()(lt.A,pe);const F_=lt.A&&lt.A.locals?lt.A.locals:void 0;var ol=(0,b.A)(nl,il,rl,!1,null,"57b5ff68",null);const Wt=ol.exports;var Ae=i(43417),w=i(55031);const ll=No(),ul=/^\s*[-+*]\s.*\[[\sxX]\]/,dl=/^\s*[-+*]\s.*\[[xX]\]/,cl={name:"MessageBody",components:{CallButton:$t.A,NcButton:U.A,NcRichText:ds.Ay,Poll:Wt,Quote:Ho.A,ConversationActionsShortcut:al,AlertCircleIcon:jo.A,IconBellOff:Lt.A,CancelIcon:fs,CheckIcon:qe.A,CheckAllIcon:ns,ContentCopyIcon:Rt.A,ReloadIcon:zo.A},directives:{IntersectionObserver:Ve.ez,ElementSize:Ve.Qw},props:{message:{type:Object,required:!0},richParameters:{type:Object,required:!0},isDeleting:{type:Boolean,default:!1},hasCall:{type:Boolean,default:!1},readInfo:{type:Object,required:!0}},setup(s){const{message:e}=(0,l.QW)(s),{isEditable:t,isFileShare:a}=(0,Nt.B)(e),n=(0,l.WQ)("chatView:isSidebar",!1);return{isInCall:(0,Ae.J)(),pollsStore:(0,ze.v)(),isEditable:t,isFileShare:a,isSidebar:n}},data(){return{isEditing:!1,showReloadButton:!1,currentCodeBlock:null,copyButtonOffset:0,isVisible:!1,previousSize:{width:0,height:22.5}}},computed:{renderedMessage(){return this.isFileShare&&this.message.message!=="{file}"?`{file}

`+this.message.message:this.message.message},isSystemMessage(){return this.message.systemMessage!==""},isDeletedMessage(){return this.message.messageType===m.w5.TYPE.COMMENT_DELETED},isNewPollMessage(){return this.message.messageParameters?.object?.type!=="talk-poll"?!1:this.isInCall&&this.pollsStore.isNewPoll(this.message.messageParameters.object.id)},isCallEndedMessage(){return this.message.systemMessage==="call_ended"||this.message.systemMessage==="call_ended_everyone"},conversation(){return this.$store.getters.conversation(this.message.token)},hasRetentionPeriod(){return this.conversation.objectType===m.si.OBJECT_TYPE.EVENT||this.conversation.objectType===m.si.OBJECT_TYPE.PHONE_TEMPORARY||this.conversation.objectType===m.si.OBJECT_TYPE.INSTANT_MEETING},supportUnbindConversation(){return(0,N.t0)(this.message.token,"unbind-conversation")},showConversationActionsShortcut(){return this.supportUnbindConversation&&!this.isInCall&&!this.isSidebar&&this.$store.getters.isModeratorOrUser&&this.hasRetentionPeriod&&this.isCallEndedMessage&&this.message.id>this.lastCallStartedMessageId},isLastMessage(){return this.message.id===this.conversation.lastMessage?.id},isTemporary(){return this.message.timestamp===0},hideDate(){return this.isTemporary||this.isDeleting||!!this.message.sendingFailure},messageTime(){return(0,z.A)(this.isTemporary?void 0:this.message.timestamp*1e3).format("LT")},messageDate(){return(0,z.A)(this.isTemporary?void 0:this.message.timestamp*1e3).format("LL")},lastCallStartedMessageId(){return this.$store.getters.getLastCallStartedMessageId(this.message.token)},isLastCallStartedMessage(){return this.message.systemMessage==="call_started"&&this.message.id===this.lastCallStartedMessageId},showJoinCallButton(){return this.hasCall&&!this.isInCall&&this.isLastCallStartedMessage},showResultsButton(){return this.message.systemMessage==="poll_closed"},isSingleEmoji(){if(this.isSystemMessage||this.isDeletedMessage)return;const s=this.renderedMessage.trim(),e=s.match(ll);return e!==null&&e.length===1&&e[0]===s},showLoadingIcon(){return this.isTemporary||this.isDeleting||this.isEditing},loadingIconTitle(){return(0,r.t)("spreed","Sending message")},sendingErrorCanRetry(){return["timeout","other","failed-upload"].includes(this.message.sendingFailure)},sendingErrorIconTitle(){return this.sendingErrorCanRetry?(0,r.t)("spreed","Failed to send the message. Click to try again"):this.message.sendingFailure==="quota"?(0,r.t)("spreed","Not enough free space to upload file"):this.message.sendingFailure==="failed-share"?(0,r.t)("spreed","You are not allowed to share files"):(0,r.t)("spreed","You cannot send messages to this conversation at the moment")},containsCodeBlocks(){return this.message.message.includes("```")}},watch:{showJoinCallButton(){w.l.emit("scroll-chat-to-bottom",{smooth:!0})}},mounted(){this.isEditable&&w.l.on("editing-message-processing",this.setIsEditing)},beforeDestroy(){w.l.off("editing-message-processing",this.setIsEditing)},methods:{t:r.t,getCodeBlocks(){return this.containsCodeBlocks?Array.from(this.$refs.messageMain?.querySelectorAll("pre")):null},handleMarkdownMouseOver(s){const e=this.getCodeBlocks();if(!e)return;const t=e.findIndex(a=>a.contains(s.target));if(t!==-1){this.currentCodeBlock=t;const a=e[t];this.copyButtonOffset=`${a.offsetTop}px`}},handleMarkdownMouseLeave(){this.currentCodeBlock=null,this.copyButtonOffset=0},async copyCodeBlock(){try{const s=this.getCodeBlocks()[this.currentCodeBlock].textContent;await navigator.clipboard.writeText(s),(0,x.Te)((0,r.t)("spreed","Code block copied to clipboard"))}catch{(0,x.Qg)((0,r.t)("spreed","Code block could not be copied"))}},handleRetry(){this.sendingErrorCanRetry&&(this.message.sendingFailure==="failed-upload"?this.$store.dispatch("retryUploadFiles",{token:this.message.token,uploadId:this.$store.getters.message(this.message.token,this.message.id)?.uploadId,caption:this.renderedMessage!==this.message.message?this.message.message:void 0}):(w.l.emit("retry-message",this.message.id),w.l.emit("focus-chat-input")))},async handleInteraction(s){if(!this.isEditable)return;const e=s.split("-markdown-input-")[0],t=Array.from(this.$refs.messageMain.querySelectorAll(`span[id^="${e}-markdown-input-"]`)).findIndex(u=>u.id.includes(s));if(t===-1)return;let a=0;const n=this.message.message.split(`
`);for(let u=0;u<n.length;u++)if(ul.test(n[u])){if(a===t){dl.test(n[u])?n[u]=n[u].replace(/\[[xX]\]/,"[ ]"):n[u]=n[u].replace(/\[\s\]/,"[x]");break}a++}let o=(0,jt.Y)(n.join(`
`).trim());o=(0,jt.X)(o,this.message.messageParameters);try{await this.$store.dispatch("editMessage",{token:this.message.token,messageId:this.message.id,updatedMessage:o})}catch(u){console.error(u),(0,x.Qg)((0,r.t)("spreed","Could not update the message"))}},setIsEditing({messageId:s,value:e}){s===this.message.id&&(this.isEditing=e)},onIntersectionObserver([{isIntersecting:s}]){this.isVisible=s},onResize({width:s,height:e}){const t=this.previousSize?.width,a=this.previousSize?.height;this.previousSize={width:s,height:e},this.isVisible&&(t&&t!==s||e!==0&&w.l.emit("message-height-changed",{heightDiff:e-a}))}}};var ut=i(19389),ge={};ge.styleTagTransform=R(),ge.setAttributes=O(),ge.insert=P().bind(null,"head"),ge.domAPI=I(),ge.insertStyleElement=L();var k_=T()(ut.A,ge);const S_=ut.A&&ut.A.locals?ut.A.locals:void 0;var _l=(0,b.A)(cl,xo,wo,!1,null,"1e850aa1",null);const pl=_l.exports;var Al=function(){var e=this,t=e._self._c;return e.reactionsCount&&e.reactionsSorted?t("div",{staticClass:"reactions-wrapper"},[e._l(e.reactionsSorted,function(a){return t("NcPopover",{key:a,attrs:{delay:200,"focus-trap":!1,triggers:["hover"],"popper-triggers":["hover"]},on:{"after-show":e.fetchReactions},scopedSlots:e._u([{key:"trigger",fn:function(){return[t("NcButton",{attrs:{type:e.userHasReacted(a)?"primary":"secondary",size:"small"},on:{click:function(n){return e.handleReactionClick(a)}}},[t("span",{staticClass:"reaction-emoji"},[e._v(e._s(a))]),e._v(" "+e._s(e.reactionsCount(a))+`
			`)])]},proxy:!0}],null,!0)},[e._v(" "),e.hasReactionsLoaded?t("div",{staticClass:"reaction-details"},[t("span",[e._v(e._s(e.getReactionSummary(a))+`
				`),e.reactionsCount(a)===4?t("span",[e._v(`
					`+e._s(e.remainingReactionsLabel(a))+`
				`)]):e.reactionsCount(a)>4?t("a",{staticClass:"more-reactions-button",attrs:{role:"button",tabindex:"0"},on:{click:function(n){n.preventDefault(),e.showAllReactions=!0}}},[e._v(`
					`+e._s(e.remainingReactionsLabel(a))+`
				`)]):e._e()])]):t("div",{staticClass:"details-loading"},[t("NcLoadingIcon")],1)])}),e._v(" "),e.showControls?t("NcButton",{attrs:{size:"small",title:e.t("spreed","Show all reactions"),"aria-label":e.t("spreed","Show all reactions")},on:{click:function(a){e.showAllReactions=!0}}},[t("HeartOutlineIcon",{attrs:{size:15}})],1):t("span",{staticClass:"reaction-button--thumbnail"}),e._v(" "),e.canReact&&e.showControls?t("NcEmojiPicker",{attrs:{"per-line":5},on:{select:e.handleReactionClick,"after-show":e.emitEmojiPickerStatus,"after-hide":e.emitEmojiPickerStatus}},[t("NcButton",{attrs:{size:"small",title:e.t("spreed","Add more reactions"),"aria-label":e.t("spreed","Add more reactions")},scopedSlots:e._u([{key:"icon",fn:function(){return[t("EmoticonPlusOutline",{attrs:{size:15}})]},proxy:!0}],null,!1,1465470732)})],1):e.canReact?t("span",{staticClass:"reaction-button--thumbnail"}):e._e(),e._v(" "),e.showAllReactions?t("ReactionsList",{attrs:{token:e.token,"detailed-reactions":e.detailedReactions,"reactions-sorted":e.reactionsSorted},on:{close:function(a){e.showAllReactions=!1}}}):e._e()],2):e._e()},gl=[],Es=i(54562),ml=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon emoticon-plus-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M15 18H18V15H20V18H23V20H20V23H18V20H15V18M12 17.5C9.67 17.5 7.69 16.04 6.89 14H15.69C14.5 14.78 13.62 15.97 13.23 17.36C12.83 17.45 12.42 17.5 12 17.5M8.5 11C7.67 11 7 10.33 7 9.5C7 8.67 7.67 8 8.5 8C9.33 8 10 8.67 10 9.5C10 10.33 9.33 11 8.5 11M15.5 11C14.67 11 14 10.33 14 9.5C14 8.67 14.67 8 15.5 8C16.33 8 17 8.67 17 9.5C17 10.33 16.33 11 15.5 11M12 20L13.07 19.93C13.18 20.61 13.4 21.26 13.72 21.85C13.16 21.95 12.58 22 12 22C6.47 22 2 17.5 2 12C2 6.5 6.47 2 12 2C17.5 2 22 6.5 22 12C22 12.59 21.95 13.16 21.85 13.72C21.26 13.4 20.62 13.18 19.93 13.07L20 12C20 7.58 16.42 4 12 4C7.58 4 4 7.58 4 12C4 16.42 7.58 20 12 20Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Cl=[];const vl={name:"EmoticonPlusOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var hl=(0,b.A)(vl,ml,Cl,!1,null,null,null);const fl=hl.exports;var Dl=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon heart-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M12.1,18.55L12,18.65L11.89,18.55C7.14,14.24 4,11.39 4,8.5C4,6.5 5.5,5 7.5,5C9.04,5 10.54,6 11.07,7.36H12.93C13.46,6 14.96,5 16.5,5C18.5,5 20,6.5 20,8.5C20,11.39 16.86,14.24 12.1,18.55M16.5,3C14.76,3 13.09,3.81 12,5.08C10.91,3.81 9.24,3 7.5,3C4.42,3 2,5.41 2,8.5C2,12.27 5.4,15.36 10.55,20.03L12,21.35L13.45,20.03C18.6,15.36 22,12.27 22,8.5C22,5.41 19.58,3 16.5,3Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},yl=[];const El={name:"HeartOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var bl=(0,b.A)(El,Dl,yl,!1,null,null,null);const bs=bl.exports;var Ml=function(){var e=this,t=e._self._c;return t("NcDialog",{attrs:{name:e.t("spreed","Reactions"),"close-on-click-outside":""},on:{"update:open":e.closeModal}},[t("div",{staticClass:"reactions__modal"},[Object.keys(e.reactionsOverview).length>0?[t("div",{staticClass:"reactions-list__navigation"},e._l(e.reactionsMenu,function(a){return t("NcButton",{key:a,class:{active:e.reactionFilter===a,"all-reactions__button":a==="\u2661"},attrs:{type:"tertiary"},on:{click:function(n){return e.handleTabClick(a)}}},[a==="\u2661"?t("HeartOutlineIcon",{attrs:{size:15}}):t("span",[e._v(`
						`+e._s(a)+`
					`)]),e._v(`
					`+e._s(e.reactionsOverview[a].length)+`
				`)],1)}),1),e._v(" "),t("ul",{staticClass:"reactions-list__scrollable"},e._l(e.reactionsOverview[e.reactionFilter],function(a){return t("li",{key:a.actorId+a.actorType,staticClass:"reactions-item"},[t("AvatarWrapper",{attrs:{id:a.actorId,token:e.token,name:a.actorDisplayName,source:a.actorType,size:e.AVATAR.SIZE.SMALL,"disable-menu":""}}),e._v(" "),t("span",{staticClass:"reactions-item__name"},[e._v(e._s(a.actorDisplayNameWithFallback))]),e._v(" "),t("span",{staticClass:"reactions-item__emojis"},[e._v(`
						`+e._s(a.reaction?.join("")??e.reactionFilter)+`
					`)])],1)}),0)]:t("NcLoadingIcon",{attrs:{size:64}})],2)])},Fl=[],zt=i(81478);const Bl={name:"ReactionsList",components:{AvatarWrapper:Je.A,NcButton:U.A,NcDialog:We.A,NcLoadingIcon:te.A,HeartOutlineIcon:bs},props:{token:{type:String,required:!0},detailedReactions:{type:Object,default:()=>{}},reactionsSorted:{type:Array,default:()=>[]}},emits:["close"],setup(){return{AVATAR:m.of,guestNameStore:(0,$e.m)()}},data(){return{reactionFilter:"\u2661"}},computed:{reactionsOverview(){const s={},e={};return Object.entries(this.detailedReactions).forEach(([t,a])=>{e[t]=[],a.forEach(n=>{const o=`${n.actorId}-${n.actorType}`,u=this.getDisplayNameForReaction(n),d=(0,zt.G)(u,n.actorType);e[t].push({...n,actorDisplayName:u,actorDisplayNameWithFallback:d}),s[o]?s[o].reaction.push(t):s[o]={actorDisplayName:u,actorDisplayNameWithFallback:d,actorId:n.actorId,actorType:n.actorType,reaction:[t]}})}),{"\u2661":Object.values(s),...e}},reactionsMenu(){return["\u2661",...this.reactionsSorted]}},methods:{t:r.t,closeModal(){this.$emit("close")},getDisplayNameForReaction(s){return s.actorType===m.Rf.ACTOR_TYPE.GUESTS?this.guestNameStore.getGuestNameWithGuestSuffix(this.token,s.actorId):s.actorDisplayName.trim()},handleTabClick(s){this.reactionFilter=s}}};var dt=i(30346),me={};me.styleTagTransform=R(),me.setAttributes=O(),me.insert=P().bind(null,"head"),me.domAPI=I(),me.insertStyleElement=L();var O_=T()(dt.A,me);const L_=dt.A&&dt.A.locals?dt.A.locals:void 0;var kl=(0,b.A)(Bl,Ml,Fl,!1,null,"6216fb6a",null);const Sl=kl.exports,Tl={name:"Reactions",components:{NcButton:U.A,NcEmojiPicker:is.A,NcLoadingIcon:te.A,NcPopover:Es.A,ReactionsList:Sl,EmoticonPlusOutline:fl,HeartOutlineIcon:bs},props:{token:{type:String,required:!0},canReact:{type:Boolean,default:!1},id:{type:[String,Number],required:!0},showControls:{type:Boolean,default:!1}},emits:["emoji-picker-toggled"],setup(){const s=(0,$e.m)(),e=(0,ls.b)();return{guestNameStore:s,reactionsStore:e}},data(){return{showAllReactions:!1}},computed:{hasReactionsLoaded(){return Object.keys(Object(this.detailedReactions)).length!==0},detailedReactions(){return this.reactionsStore.getReactions(this.token,this.id)},plainReactions(){return this.$store.getters.message(this.token,this.id).reactions},reactionsSelf(){return this.$store.getters.message(this.token,this.id).reactionsSelf},reactionsSorted(){if(this.detailedReactions)return Object.keys(this.detailedReactions).sort((s,e)=>this.detailedReactions[e].length-this.detailedReactions[s].length);if(this.plainReactions)return Object.keys(this.plainReactions).sort((s,e)=>this.plainReactions[e]-this.plainReactions[s])},hasOutdatedDetails(){const s=Object.fromEntries(Object.entries(this.detailedReactions).sort().map(([e,t])=>[e,t.length]));return this.hasReactionsLoaded&&JSON.stringify(this.plainReactions)!==JSON.stringify(s)}},methods:{t:r.t,n:r.n,fetchReactions(){(!this.hasReactionsLoaded||this.hasOutdatedDetails)&&this.reactionsStore.fetchReactions(this.token,this.id)},userHasReacted(s){return this.reactionsSelf?.includes(s)},async handleReactionClick(s){if(!this.canReact){(0,x.Qg)((0,r.t)("spreed","No permission to post reactions in this conversation"));return}this.userHasReacted(s)?this.reactionsStore.removeReactionFromMessage({token:this.token,messageId:this.id,selectedEmoji:s}):this.reactionsStore.addReactionToMessage({token:this.token,messageId:this.id,selectedEmoji:s})},getDisplayNameForReaction(s){return s.actorType===m.Rf.ACTOR_TYPE.GUESTS?this.guestNameStore.getGuestNameWithGuestSuffix(this.token,s.actorId):(0,zt.G)(s.actorDisplayName,s.actorType)},reactionsCount(s){if(!(!this.detailedReactions||!this.plainReactions))return this.detailedReactions?this.detailedReactions[s]?.length:this.plainReactions[s]},getReactionSummary(s){if(!this.hasReactionsLoaded)return"";const e=this.detailedReactions[s].slice(0,3),t=[];for(const a in e)e[a].actorType===this.$store.getters.getActorType()&&e[a].actorId===this.$store.getters.getActorId()?t.unshift((0,r.t)("spreed","You")):t.push(this.getDisplayNameForReaction(e[a]));return t.join(", ")},emitEmojiPickerStatus(){this.$emit("emoji-picker-toggled")},remainingReactionsLabel(s){return this.reactionsCount(s)===4?(0,r.t)("spreed","and {participant}",{participant:this.getDisplayNameForReaction(this.detailedReactions[s][3])}):(0,r.n)("spreed","and %n other participant","and %n other participants",this.reactionsCount(s)-3)}}};var ct=i(34469),Ce={};Ce.styleTagTransform=R(),Ce.setAttributes=O(),Ce.insert=P().bind(null,"head"),Ce.domAPI=I(),Ce.insertStyleElement=L();var x_=T()(ct.A,Ce);const w_=ct.A&&ct.A.locals?ct.A.locals:void 0;var Il=(0,b.A)(Tl,Al,gl,!1,null,"4b4afe76",null);const Pl=Il.exports;var Ht=i(25198),Ol=i(16906);const Ll=(0,N.t0)("local","chat-summary-api"),Rl=(0,N.JR)("local","chat","summary-threshold")??0,xl={name:"Message",components:{IconCreation:ss,IconUnfoldLess:Ua,IconUnfoldMore:Ha,MessageBody:pl,MessageButtonsBar:mr,MessageForwarder:br,MessageTranslateDialog:xr,NcButton:U.A,NcLoadingIcon:te.A,Reactions:Pl},directives:{IntersectionObserver:Ve.ez},props:{message:{type:Object,required:!0},isCombinedSystemMessage:{type:Boolean,default:!1},isCombinedSystemMessageCollapsed:{type:Boolean,default:void 0},isCollapsedSystemMessage:{type:Boolean,default:!1},lastCollapsedMessageId:{type:[String,Number],default:0},previousMessageId:{type:[String,Number],default:0},nextMessageId:{type:[String,Number],default:0}},emits:["toggle-combined-system-message"],setup(s){return{isTranslationAvailable:(0,N.JR)(s.token,"chat","has-translation-providers")??(0,N.JR)(s.token,"chat","translations")?.length>0,chatExtrasStore:(0,Ht.k)()}},data(){return{loading:!1,isHovered:!1,isDeleting:!1,seen:!1,isActionMenuOpen:!1,isEmojiPickerOpen:!1,isFollowUpEmojiPickerOpen:!1,isReactionsMenuOpen:!1,isForwarderOpen:!1,isTranslateDialogOpen:!1}},computed:{isTemporary(){return this.message.timestamp===0},isLastMessage(){return!this.nextMessageId||this.message.id===this.conversation?.lastMessage?.id},visualLastLastReadMessageId(){return this.$store.getters.getVisualLastReadMessageId(this.message.token)},isLastReadMessage(){return this.isLastMessage?!1:this.message.id===this.visualLastLastReadMessageId?!this.isCollapsedSystemMessage||this.message.id!==this.lastCollapsedMessageId:this.isCombinedSystemMessage&&this.lastCollapsedMessageId===this.visualLastLastReadMessageId},shouldShowSummaryOption(){return this.conversation.remoteServer||!Ll||this.chatExtrasStore.hasChatSummaryTaskRequested(this.message.token)?!1:this.conversation.unreadMessages>=Rl},isSystemMessage(){return this.message.systemMessage!==""},isDeletedMessage(){return this.message.messageType===m.w5.TYPE.COMMENT_DELETED},conversation(){return this.$store.getters.conversation(this.message.token)},showCommonReadIcon(){return this.conversation.lastCommonReadMessage>=this.message.id&&this.showSentIcon&&!this.isDeletedMessage},showSentIcon(){return!this.isSystemMessage&&!this.isTemporary&&!this.isDeleting&&this.message.actorType===this.$store.getters.getActorType()&&this.message.actorId===this.$store.getters.getActorId()&&!this.isDeletedMessage},richParameters(){const s={};return Object.keys(this.message.messageParameters).forEach(function(e){const t=this.message.messageParameters[e].type,a=this.message.messageParameters[e].mimetype,n=(0,Ol.$)({messageParameters:this.message.messageParameters,messageType:this.message.messageType});if(Object.values(m.TR.TYPE).includes(t))s[e]={component:Ro,props:{...this.message.messageParameters[e],token:this.message.token}};else if(t==="file"&&a!=="text/vcard")s[e]={component:_s.A,props:{token:this.message.token,messageId:this.message.id,nextMessageId:this.nextMessageId,itemType:n,referenceId:this.message.referenceId,file:this.message.messageParameters[e]}};else if(t==="deck-card")s[e]={component:Gr,props:this.message.messageParameters[e]};else if(t==="geo-location")s[e]={component:ko,props:this.message.messageParameters[e]};else if(t==="talk-poll"&&this.message.systemMessage!=="poll_closed"){const o=Object.assign({},this.message.messageParameters[e]);o.token=this.message.token,s[e]={component:Wt,props:o}}else a==="text/vcard"?s[e]={component:$r,props:this.message.messageParameters[e]}:s[e]={component:Kr.A,props:this.message.messageParameters[e]}}.bind(this)),s},showMessageButtonsBar(){return!this.isSystemMessage&&!this.isDeletedMessage&&!this.isTemporary&&(this.isHovered||this.isActionMenuOpen||this.isEmojiPickerOpen||this.isFollowUpEmojiPickerOpen||this.isReactionsMenuOpen||this.isForwarderOpen||this.isTranslateDialogOpen)},showCombinedSystemMessageToggle(){return this.isSystemMessage&&!this.isDeletedMessage&&!this.isTemporary&&this.isCombinedSystemMessage&&(this.isHovered||!this.isCombinedSystemMessageCollapsed)},readInfo(){return{showCommonReadIcon:this.showCommonReadIcon,commonReadIconTitle:(0,r.t)("spreed","Message read by everyone who shares their reading status"),showSentIcon:this.showSentIcon,sentIconTitle:(0,r.t)("spreed","Message sent"),showSilentIcon:this.message.silent,silentIconTitle:(0,r.t)("spreed","Sent without notification")}},canReact(){return this.conversation.readOnly!==m.si.STATE.READ_ONLY&&(this.conversation.permissions&m._z.PERMISSIONS.CHAT)!==0&&this.message.messageType!==m.w5.TYPE.COMMAND&&this.message.messageType!==m.w5.TYPE.COMMENT_DELETED}},methods:{t:r.t,lastReadMessageVisibilityChanged([{isIntersecting:s}]){s&&(this.seen=!0)},clearHighlightedClass(){this.$refs.message.classList.remove("message--highlighted")},handleMouseover(){this.isHovered||(this.isHovered=!0)},handleMouseleave(){this.isHovered&&(this.isHovered=!1)},handleReply(){this.chatExtrasStore.setParentIdToReply({token:this.message.token,id:this.message.id}),w.l.emit("focus-chat-input")},handleEdit(){this.chatExtrasStore.initiateEditingMessage({token:this.message.token,id:this.message.id,message:this.message.message,messageParameters:this.message.messageParameters})},async handleDelete(){this.isDeleting=!0;try{const s=await this.$store.dispatch("deleteMessage",{token:this.message.token,id:this.message.id,placeholder:(0,r.t)("spreed","Deleting message")});s===202?(0,x.I9)((0,r.t)("spreed","Message deleted successfully, but a bot or Matterbridge is configured and the message might already be distributed to other services"),{timeout:x.Jt*2}):s===200&&(0,x.Te)((0,r.t)("spreed","Message deleted successfully"))}catch(s){s?.response?.status===400?(0,x.Qg)((0,r.t)("spreed","Message could not be deleted because it is too old")):s?.response?.status===405?(0,x.Qg)((0,r.t)("spreed","Only normal chat messages can be deleted")):((0,x.Qg)((0,r.t)("spreed","An error occurred while deleting the message")),console.error(s)),this.isDeleting=!1;return}this.isDeleting=!1},toggleCombinedSystemMessage(){this.$emit("toggle-combined-system-message")},toggleFollowUpEmojiPicker(){this.isFollowUpEmojiPickerOpen=!this.isFollowUpEmojiPickerOpen},async generateSummary(){this.loading=!0,await this.chatExtrasStore.requestChatSummary(this.message.token,this.message.id),this.loading=!1}}};var _t=i(59083),ve={};ve.styleTagTransform=R(),ve.setAttributes=O(),ve.insert=P().bind(null,"head"),ve.domAPI=I(),ve.insertStyleElement=L();var j_=T()(_t.A,ve);const U_=_t.A&&_t.A.locals?_t.A.locals:void 0;var wl=(0,b.A)(xl,Ta,Ia,!1,null,"61667449",null);const Ms=wl.exports,Nl={name:"MessagesGroup",components:{AvatarWrapper:Je.A,Message:Ms},inheritAttrs:!1,props:{token:{type:String,required:!0},messages:{type:Array,required:!0},previousMessageId:{type:[String,Number],default:0},nextMessageId:{type:[String,Number],default:0}},setup(s){const{messages:e}=(0,l.QW)(s),t=(0,l.EW)(()=>e.value[0]),{remoteServer:a,lastEditor:n,actorDisplayName:o,actorDisplayNameWithFallback:u}=(0,Nt.B)(t),d=(0,l.EW)(()=>[u.value,a.value,n.value].filter(p=>p).join(" "));return{AVATAR:m.of,guestNameStore:(0,$e.m)(),actorDisplayName:o,actorInfo:d}},computed:{actorId(){return this.messages[0].actorId},actorType(){return this.messages[0].actorType},disableMenu(){return this.$store.getters.isActorGuest()||this.actorType===m.Rf.ACTOR_TYPE.BRIDGED}},methods:{t:r.t}};var pt=i(64555),he={};he.styleTagTransform=R(),he.setAttributes=O(),he.insert=P().bind(null,"head"),he.domAPI=I(),he.insertStyleElement=L();var V_=T()(pt.A,he);const W_=pt.A&&pt.A.locals?pt.A.locals:void 0;var jl=(0,b.A)(Nl,ka,Sa,!1,null,"77e4c704",null);const Ul=jl.exports;var $l=function(){var e=this,t=e._self._c;return t("li",{staticClass:"wrapper wrapper--system"},e._l(e.messagesGroupedBySystemMessage,function(a){return t("div",{key:a.id,staticClass:"messages-group__system"},[a.messages?.length>1?t("ul",{staticClass:"messages"},[t("Message",{attrs:{"is-combined-system-message":"","is-combined-system-message-collapsed":a.collapsed,"next-message-id":e.getNextMessageId(a.messages.at(-1)),"previous-message-id":e.getPrevMessageId(a.messages.at(0)),"last-collapsed-message-id":a.lastId,message:e.createCombinedSystemMessage(a)},on:{"toggle-combined-system-message":function(n){return e.toggleCollapsed(a)}}})],1):e._e(),e._v(" "),t("ul",{directives:[{name:"show",rawName:"v-show",value:a.messages?.length===1||!a.collapsed,expression:"messagesCollapsed.messages?.length === 1 || !messagesCollapsed.collapsed"}],staticClass:"messages",class:{"messages--collapsed":a.messages?.length>1}},e._l(a.messages,function(n){return t("Message",{key:n.id,attrs:{message:n,"is-collapsed-system-message":a.messages?.length>1,"last-collapsed-message-id":a.lastId,"next-message-id":e.getNextMessageId(n),"previous-message-id":e.getPrevMessageId(n)}})}),1)])}),0)},Vl=[],Wl=i(88055),zl=i.n(Wl);function Hl(){const s=(0,ie.P)();function e(o){return o.actorId===s.getters.getActorId()&&o.actorType===s.getters.getActorType()}function t(o){return o.messageParameters.actor.id===s.getters.getActorId()&&o.messageParameters.actor.type+"s"===s.getters.getActorType()}function a(o){return o.messageParameters.user.id===s.getters.getActorId()&&o.messageParameters.user.type+"s"===s.getters.getActorType()}function n({id:o,messages:u,type:d,collapsed:p}){const c=zl()(u[0]);if(c.id=u[0].id+"_combined",d==="call_reconnected")return t(c)?c.message=(0,r.t)("spreed","You reconnected to the call"):c.message=(0,r.t)("spreed","{actor} reconnected to the call"),c;const _=u[0].messageParameters.actor;c.messageParameters={actor:_};const g=_.id==="guest/cli"&&_.type==="guest";let C=0,M=!1,A=0;if(d==="user_added"&&(u.forEach(B=>{a(B)?M=!0:(c.messageParameters[`user${A}`]=B.messageParameters.user,A++),C++}),e(c)?C===2?c.message=(0,r.t)("spreed","You added {user0} and {user1}"):c.message=(0,r.n)("spreed","You added {user0}, {user1} and %n more participant","You added {user0}, {user1} and %n more participants",C-2):M?C===2?c.message=g?(0,r.t)("spreed","An administrator added you and {user0}"):(0,r.t)("spreed","{actor} added you and {user0}"):c.message=g?(0,r.n)("spreed","An administrator added you, {user0} and %n more participant","An administrator added you, {user0} and %n more participants",C-2):(0,r.n)("spreed","{actor} added you, {user0} and %n more participant","{actor} added you, {user0} and %n more participants",C-2):C===2?c.message=g?(0,r.t)("spreed","An administrator added {user0} and {user1}"):(0,r.t)("spreed","{actor} added {user0} and {user1}"):c.message=g?(0,r.n)("spreed","An administrator added {user0}, {user1} and %n more participant","An administrator added {user0}, {user1} and %n more participants",C-2):(0,r.n)("spreed","{actor} added {user0}, {user1} and %n more participant","{actor} added {user0}, {user1} and %n more participants",C-2)),d==="user_removed"&&(u.forEach(B=>{a(B)?M=!0:(c.messageParameters[`user${A}`]=B.messageParameters.user,A++),C++}),e(c)?C===2?c.message=(0,r.t)("spreed","You removed {user0} and {user1}"):c.message=(0,r.n)("spreed","You removed {user0}, {user1} and %n more participant","You removed {user0}, {user1} and %n more participants",C-2):M?C===2?c.message=g?(0,r.t)("spreed","An administrator removed you and {user0}"):(0,r.t)("spreed","{actor} removed you and {user0}"):c.message=g?(0,r.n)("spreed","An administrator removed you, {user0} and %n more participant","An administrator removed you, {user0} and %n more participants",C-2):(0,r.n)("spreed","{actor} removed you, {user0} and %n more participant","{actor} removed you, {user0} and %n more participants",C-2):C===2?c.message=g?(0,r.t)("spreed","An administrator removed {user0} and {user1}"):(0,r.t)("spreed","{actor} removed {user0} and {user1}"):c.message=g?(0,r.n)("spreed","An administrator removed {user0}, {user1} and %n more participant","An administrator removed {user0}, {user1} and %n more participants",C-2):(0,r.n)("spreed","{actor} removed {user0}, {user1} and %n more participant","{actor} removed {user0}, {user1} and %n more participants",C-2)),d==="call_joined"||d==="call_left"){const B=[];if(u.forEach(k=>{const W=`${k.messageParameters.actor.id}_${k.messageParameters.actor.type}`;B.includes(W)||(t(k)?M=!0:(c.messageParameters[`user${A}`]=k.messageParameters.actor,A++),B.push(W),C++)}),C===1)return c.message=u[0].message,c;d==="call_joined"?M?C===2?c.message=(0,r.t)("spreed","You and {user0} joined the call"):c.message=(0,r.n)("spreed","You, {user0} and %n more participant joined the call","You, {user0} and %n more participants joined the call",C-2):C===2?c.message=(0,r.t)("spreed","{user0} and {user1} joined the call"):c.message=(0,r.n)("spreed","{user0}, {user1} and %n more participant joined the call","{user0}, {user1} and %n more participants joined the call",C-2):d==="call_left"&&(M?C===2?c.message=(0,r.t)("spreed","You and {user0} left the call"):c.message=(0,r.n)("spreed","You, {user0} and %n more participant left the call","You, {user0} and %n more participants left the call",C-2):C===2?c.message=(0,r.t)("spreed","{user0} and {user1} left the call"):c.message=(0,r.n)("spreed","{user0}, {user1} and %n more participant left the call","{user0}, {user1} and %n more participants left the call",C-2))}return d==="moderator_promoted"&&(u.forEach(B=>{a(B)?M=!0:(c.messageParameters[`user${A}`]=B.messageParameters.user,A++),C++}),e(c)?C===2?c.message=(0,r.t)("spreed","You promoted {user0} and {user1} to moderators"):c.message=(0,r.n)("spreed","You promoted {user0}, {user1} and %n more participant to moderators","You promoted {user0}, {user1} and %n more participants to moderators",C-2):M?C===2?c.message=g?(0,r.t)("spreed","An administrator promoted you and {user0} to moderators"):(0,r.t)("spreed","{actor} promoted you and {user0} to moderators"):c.message=g?(0,r.n)("spreed","An administrator promoted you, {user0} and %n more participant to moderators","An administrator promoted you, {user0} and %n more participants to moderators",C-2):(0,r.n)("spreed","{actor} promoted you, {user0} and %n more participant to moderators","{actor} promoted you, {user0} and %n more participants to moderators",C-2):C===2?c.message=g?(0,r.t)("spreed","An administrator promoted {user0} and {user1} to moderators"):(0,r.t)("spreed","{actor} promoted {user0} and {user1} to moderators"):c.message=g?(0,r.n)("spreed","An administrator promoted {user0}, {user1} and %n more participant to moderators","An administrator promoted {user0}, {user1} and %n more participants to moderators",C-2):(0,r.n)("spreed","{actor} promoted {user0}, {user1} and %n more participant to moderators","{actor} promoted {user0}, {user1} and %n more participants to moderators",C-2)),d==="moderator_demoted"&&(u.forEach(B=>{a(B)?M=!0:(c.messageParameters[`user${A}`]=B.messageParameters.user,A++),C++}),e(c)?C===2?c.message=(0,r.t)("spreed","You demoted {user0} and {user1} from moderators"):c.message=(0,r.n)("spreed","You demoted {user0}, {user1} and %n more participant from moderators","You demoted {user0}, {user1} and %n more participants from moderators",C-2):M?C===2?c.message=g?(0,r.t)("spreed","An administrator demoted you and {user0} from moderators"):(0,r.t)("spreed","{actor} demoted you and {user0} from moderators"):c.message=g?(0,r.n)("spreed","An administrator demoted you, {user0} and %n more participant from moderators","An administrator demoted you, {user0} and %n more participants from moderators",C-2):(0,r.n)("spreed","{actor} demoted you, {user0} and %n more participant from moderators","{actor} demoted you, {user0} and %n more participants from moderators",C-2):C===2?c.message=g?(0,r.t)("spreed","An administrator demoted {user0} and {user1} from moderators"):(0,r.t)("spreed","{actor} demoted {user0} and {user1} from moderators"):c.message=g?(0,r.n)("spreed","An administrator demoted {user0}, {user1} and %n more participant from moderators","An administrator demoted {user0}, {user1} and %n more participants from moderators",C-2):(0,r.n)("spreed","{actor} demoted {user0}, {user1} and %n more participant from moderators","{actor} demoted {user0}, {user1} and %n more participants from moderators",C-2)),c}return{createCombinedSystemMessage:n}}const Gl={name:"MessagesSystemGroup",components:{Message:Ms},inheritAttrs:!1,props:{token:{type:String,required:!0},messages:{type:Array,required:!0},previousMessageId:{type:[String,Number],default:0},nextMessageId:{type:[String,Number],default:0}},setup(){const{createCombinedSystemMessage:s}=Hl();return{createCombinedSystemMessage:s}},data(){return{groupIsCollapsed:{},messagesGroupedBySystemMessage:[]}},computed:{lastReadMessageId(){return this.$store.getters.conversation(this.token)?.lastReadMessage}},watch:{messages:{deep:!0,immediate:!0,handler(s){this.messagesGroupedBySystemMessage=this.groupMessages(s),this.updateCollapsedState()}},lastReadMessageId(){this.updateCollapsedState()}},methods:{messagesShouldBeGrouped(s,e){return e?s.systemMessage==="call_joined"&&s.systemMessage===e.systemMessage?"call_joined":s.systemMessage==="call_left"&&s.systemMessage===e.systemMessage?"call_left":s.actorId!==e.actorId||s.actorType!==e.actorType?"":s.systemMessage==="call_joined"&&e.systemMessage==="call_left"&&s.timestamp-e.timestamp<60*1e3?"call_reconnected":s.systemMessage==="user_added"&&s.systemMessage===e.systemMessage?"user_added":s.systemMessage==="user_removed"&&s.systemMessage===e.systemMessage?"user_removed":(s.systemMessage==="moderator_promoted"||s.systemMessage==="guest_moderator_promoted")&&(e.systemMessage==="moderator_promoted"||e.systemMessage==="guest_moderator_promoted")?"moderator_promoted":(s.systemMessage==="moderator_demoted"||s.systemMessage==="guest_moderator_demoted")&&(e.systemMessage==="moderator_demoted"||e.systemMessage==="guest_moderator_demoted")?"moderator_demoted":"":""},updateCollapsedState(){for(const s of this.messagesGroupedBySystemMessage)this.lastReadMessageId>=s.id&&this.lastReadMessageId<s.lastId?s.collapsed=!1:this.groupIsCollapsed[s.id]!==void 0?s.collapsed=this.groupIsCollapsed[s.id]:s.collapsed=s.messages.length>1},groupMessages(s){const e=[];let t=null,a=!1;for(const n of s){const o=this.messagesShouldBeGrouped(n,t);!o||a?(e.push({id:n.id,lastId:n.id,messages:[n],type:"",collapsed:void 0}),a=!1):(o==="call_reconnected"&&(e.push({id:n.id,lastId:n.id,messages:[e.at(-1).messages.pop()],type:"",collapsed:void 0}),e.at(-1).lastId=e.at(-1).messages.at(-1).id,a=!0),e.at(-1).messages.push(n),e.at(-1).lastId=n.id,e.at(-1).type=o),t=n}return e},toggleCollapsed(s){this.$set(s,"collapsed",!s.collapsed),this.groupIsCollapsed[s.id]=s.collapsed},getNextMessageId(s){return this.messages[this.messages.findIndex(t=>t.id===s.id)+1]?.id||this.nextMessageId},getPrevMessageId(s){return this.messages[this.messages.findIndex(t=>t.id===s.id)-1]?.id||this.previousMessageId}}};var At=i(25283),fe={};fe.styleTagTransform=R(),fe.setAttributes=O(),fe.insert=P().bind(null,"head"),fe.domAPI=I(),fe.insertStyleElement=L();var H_=T()(At.A,fe);const G_=At.A&&At.A.locals?At.A.locals:void 0;var Kl=(0,b.A)(Gl,$l,Vl,!1,null,"4c6a63a2",null);const Yl=Kl.exports;var Xl=i(49583),V=i(29876);const Gt=10,Jl={name:"MessagesList",components:{LoadingPlaceholder:Ba.A,Message:Fa,NcEmptyContent:Z.A,NcLoadingIcon:te.A,TransitionWrapper:Pt.A},provide(){return{getMessagesListScroller:()=>this.$refs.scroller}},props:{token:{type:String,required:!0},isChatScrolledToBottom:{type:Boolean,default:!0},isVisible:{type:Boolean,default:!0}},emits:["update:is-chat-scrolled-to-bottom"],setup(s){const e=(0,Xl.f)(),t=(0,l.EW)(()=>e.value&&s.isVisible);return{isInCall:(0,Ae.J)(),chatExtrasStore:(0,Ht.k)(),isChatVisible:t}},data(){return{messagesGroupedByDateByAuthor:{},viewId:Da()("messagesList"),displayMessagesLoader:!1,previousScrollTopValue:null,pollingErrorTimeout:1,loadingOldMessages:!1,isInitialisingMessages:!1,isFocusingMessage:!1,destroying:!1,expirationInterval:null,debounceUpdateReadMarkerPosition:()=>{},debounceHandleScroll:()=>{},stopFetchingOldMessages:!1,isScrolling:null,stickyDate:null,dateSeparatorLabels:{},endScrollTimeout:()=>{}}},computed:{visualLastReadMessageId(){return this.$store.getters.getVisualLastReadMessageId(this.token)},messagesList(){return this.$store.getters.messagesList(this.token)},isMessagesListPopulated(){return this.$store.getters.isMessagesListPopulated(this.token)},chatLoadedIdentifier(){return this.token+":"+this.isMessagesListPopulated},showEmptyContent(){return!this.messagesList.length},isSticky(){return this.isChatScrolledToBottom&&!this.isInitialisingMessages},hasMoreMessagesToLoad(){return this.$store.getters.hasMoreMessagesToLoad(this.token)},isParticipant(){return this.conversation?!!this.$store.getters.findParticipant(this.token,this.conversation)?.attendeeId:!1},isInLobby(){return this.$store.getters.isInLobby},conversation(){return this.$store.getters.conversation(this.token)},chatIdentifier(){return this.token+":"+this.isParticipant+":"+this.viewId},currentDay(){return(0,et.pf)(new Date().setHours(0,0,0,0))},isChatBeginningReached(){return this.stopFetchingOldMessages||this.messagesList?.[0]?.messageType===m.w5.TYPE.SYSTEM&&["conversation_created","history_cleared"].includes(this.messagesList[0].systemMessage)}},watch:{isChatVisible(s){s&&this.onWindowFocus()},chatIdentifier:{immediate:!0,handler(s,e){e&&this.$store.dispatch("cancelPollNewMessages",{requestId:e}),this.handleStartGettingMessagesPreconditions(this.token),this.removeExpiredMessagesFromStore()}},token(s,e){this.$store.dispatch("easeMessageList",{token:e})},messagesList:{immediate:!0,handler(s,e){const t=this.prepareMessagesGroups(s);!e||e?.length&&s.length&&s[0].token!==e?.at(0)?.token?this.messagesGroupedByDateByAuthor=t:this.softUpdateByDateGroups(this.messagesGroupedByDateByAuthor,t),this.scrollToBottom({smooth:!1}),this.$nextTick(()=>{this.checkChatNotScrollable(),this.conversation?.type===m.si.TYPE.NOTE_TO_SELF&&this.updateTasksCount()})}},chatLoadedIdentifier(){this.stickyDate=null,this.stopFetchingOldMessages=!1,this.$refs.scroller&&this.$refs.scroller.removeEventListener("wheel",this.handleWheelEvent),this.isMessagesListPopulated&&this.$nextTick(()=>{this.checkSticky(),!this.isChatBeginningReached&&this.checkChatNotScrollable()&&this.$refs.scroller.addEventListener("wheel",this.handleWheelEvent,{passive:!0})})}},mounted(){this.debounceUpdateReadMarkerPosition=ts()(this.updateReadMarkerPosition,1e3),this.debounceHandleScroll=ts()(this.handleScroll,50),w.l.on("scroll-chat-to-bottom",this.scrollToBottom),w.l.on("focus-message",this.focusMessage),w.l.on("route-change",this.onRouteChange),w.l.on("message-height-changed",this.onMessageHeightChanged),(0,X.B1)("networkOffline",this.handleNetworkOffline),(0,X.B1)("networkOnline",this.handleNetworkOnline),window.addEventListener("focus",this.onWindowFocus),this.resizeObserver=new ResizeObserver(this.updateSize),this.resizeObserver.observe(this.$refs.scroller),this.expirationInterval=window.setInterval(()=>{this.removeExpiredMessagesFromStore()},3e4)},beforeDestroy(){this.debounceUpdateReadMarkerPosition.clear?.(),this.debounceHandleScroll.clear?.(),window.removeEventListener("focus",this.onWindowFocus),w.l.off("scroll-chat-to-bottom",this.scrollToBottom),w.l.off("focus-message",this.focusMessage),w.l.off("route-change",this.onRouteChange),w.l.off("message-height-changed",this.onMessageHeightChanged),this.$store.dispatch("cancelPollNewMessages",{requestId:this.chatIdentifier}),this.destroying=!0,(0,X.al)("networkOffline",this.handleNetworkOffline),(0,X.al)("networkOnline",this.handleNetworkOnline),this.resizeObserver&&this.resizeObserver.disconnect(),this.expirationInterval&&(clearInterval(this.expirationInterval),this.expirationInterval=null)},methods:{t:r.t,n:r.n,updateSize(){this.isChatScrolledToBottom?this.$refs.scroller.scrollTo({top:this.$refs.scroller.scrollHeight}):this.checkChatNotScrollable()},prepareMessagesGroups(s){let e=null;const t={};let a=null,n=null,o=null;for(const u of s)this.messagesShouldBeGrouped(u,a)?t[e.date][e.groupId].messages.push(u):(n=u.id,u.timestamp===0?o=this.currentDay:o=(0,et.pf)(new Date(u.timestamp*1e3).setHours(0,0,0,0)),this.dateSeparatorLabels[o]||this.$set(this.dateSeparatorLabels,o,this.generateDateSeparator(o)),t[o]||(t[o]={}),t[o][n]={id:u.id,messages:[u],token:this.token,dateTimestamp:o,previousMessageId:a?.id||0,nextMessageId:0,isSystemMessagesGroup:u.systemMessage.length!==0},e&&(t[e.date][e.groupId].nextMessageId=u.id),e={date:o,groupId:u.id}),a=u;return t},softUpdateByDateGroups(s,e){new Set([...Object.keys(s),...Object.keys(e)]).forEach(a=>{e[a]?s[a]?this.softUpdateAuthorGroups(s[a],e[a],a):this.$set(this.messagesGroupedByDateByAuthor,a,e[a]):this.$delete(this.messagesGroupedByDateByAuthor,a)})},softUpdateAuthorGroups(s,e,t){new Set([...Object.keys(s),...Object.keys(e)]).forEach(n=>{s[n]&&!e[n]?this.$delete(this.messagesGroupedByDateByAuthor[t],n):(e[n]&&!s[n]||!this.areGroupsIdentical(e[n],s[n]))&&this.$set(this.messagesGroupedByDateByAuthor[t],n,e[n])})},areGroupsIdentical(s,e){return s.messages.length!==e.messages.length||s.dateSeparator!==e.dateSeparator||s.previousMessageId!==e.previousMessageId||s.nextMessageId!==e.nextMessageId?!1:s.messages.every((t,a)=>e.messages[a].id===t.id&&JSON.stringify(e.messages[a])===JSON.stringify(t))},removeExpiredMessagesFromStore(){this.$store.dispatch("removeExpiredMessages",{token:this.token})},messagesShouldBeGrouped(s,e){if(!e||s.lastEditTimestamp||e.lastEditTimestamp||s.actorType===m.Rf.ACTOR_TYPE.BOTS&&s.actorId!==m.Rf.CHANGELOG_BOT_ID&&s.actorId!==m.Rf.SAMPLE_BOT_ID)return!1;const t=s.systemMessage.length!==0,a=e.systemMessage.length!==0;if(t!==a||!t&&(s.actorType!==e.actorType||s.actorId!==e.actorId||s.actorType===m.Rf.ACTOR_TYPE.BRIDGED&&s.actorDisplayName!==e.actorDisplayName))return!1;const n=this.getDateOfMessage(s),o=this.getDateOfMessage(e);return n.getFullYear()!==o.getFullYear()||n.getMonth()!==o.getMonth()||n.getDate()!==o.getDate()?!1:Math.abs(n-o)<3e5},getRelativePrefix(s){switch(s){case 0:return(0,r.t)("spreed","Today");case 1:return(0,r.t)("spreed","Yesterday");case 7:return(0,r.t)("spreed","A week ago");default:return(0,r.n)("spreed","%n day ago","%n days ago",s)}},generateDateSeparator(s){const e=new Date(s*1e3).setHours(0,0,0,0),t=Math.floor((Date.now()-e)/et.x8);return t<=7?(0,r.t)("spreed","{relativeDate}, {absoluteDate}",{relativeDate:this.getRelativePrefix(t),absoluteDate:(0,z.A)(e).format("LL")},void 0,{escape:!1}):(0,z.A)(e).format("LL")},getDateOfMessage(s){return s.id.toString().startsWith("temp-")?new Date:new Date(s.timestamp*1e3)},getMessageIdFromHash(s=void 0){return s?parseInt(s.slice(9),10):this.$route?.hash?.startsWith("#message_")?parseInt(this.$route.hash.slice(9),10):null},scrollToFocusedMessage(s){let e=null;if(s){this.focusMessage(s,!1);return}if(this.visualLastReadMessageId&&(e=this.focusMessage(this.visualLastReadMessageId,!1,!1)),!e){const t=this.$store.getters.getFirstDisplayableMessageIdBeforeReadMarker(this.token,this.visualLastReadMessageId);t&&(e=this.focusMessage(t,!1,!1)),e?this.$store.dispatch("setVisualLastReadMessageId",{token:this.token,id:t}):this.scrollToBottom({smooth:!1,force:!0})}this.debounceUpdateReadMarkerPosition()},async handleStartGettingMessagesPreconditions(s){if(s&&this.isParticipant&&!this.isInLobby){this.isInitialisingMessages=!0;const e=this.getMessageIdFromHash();if(this.$store.dispatch("setVisualLastReadMessageId",{token:s,id:this.conversation.lastReadMessage}),!this.$store.getters.getFirstKnownMessageId(s))try{const t=e!==null?e:this.conversation.lastReadMessage;if(!t)throw new Error(`[DEBUG] spreed: context message ID is ${t}`);this.$store.dispatch("setFirstKnownMessageId",{token:s,id:t}),this.$store.dispatch("setLastKnownMessageId",{token:s,id:t}),await this.getMessageContext(s,t!==m.w5.CHAT_BEGIN_ID?t:0)}catch(t){console.debug(t),this.$store.dispatch("setFirstKnownMessageId",{token:s,id:null}),this.$store.dispatch("setLastKnownMessageId",{token:s,id:null});return}this.$nextTick(()=>{this.scrollToFocusedMessage(e)}),this.isInitialisingMessages=!1,await this.pollNewMessages(s)}else this.$store.dispatch("cancelPollNewMessages",{requestId:this.chatIdentifier})},async getMessageContext(s,e){this.loadingOldMessages=!0;try{V.l.start(`${s} | get context`),await this.$store.dispatch("getMessageContext",{token:s,messageId:e,minimumVisible:m.VR.MINIMUM_VISIBLE}),V.l.end(`${s} | get context`,"status 200"),this.loadingOldMessages=!1}catch(t){if(q.Ay.isCancel(t))throw console.debug("The request has been canceled",t),V.l.end(`${s} | get context`,"cancelled"),this.loadingOldMessages=!1,t;t?.response?.status===304&&t?.response?.data===""&&(V.l.end(`${s} | get context`,"status 304"),this.$store.dispatch("loadedMessagesOfConversation",{token:this.token}),this.stopFetchingOldMessages=!0)}this.loadingOldMessages=!1},async getOldMessages(s){if(!this.isChatBeginningReached){this.loadingOldMessages=!0;try{V.l.start(`${this.token} | fetch history`),await this.$store.dispatch("fetchMessages",{token:this.token,lastKnownMessageId:this.$store.getters.getFirstKnownMessageId(this.token),includeLastKnown:s,minimumVisible:m.VR.MINIMUM_VISIBLE}),V.l.end(`${this.token} | fetch history`,"status 200")}catch(e){q.Ay.isCancel(e)&&(V.l.end(`${this.token} | fetch history`,"cancelled"),console.debug("The request has been canceled",e)),e?.response?.status===304&&(V.l.end(`${this.token} | fetch history`,"status 304"),this.stopFetchingOldMessages=!0)}this.loadingOldMessages=!1}},async pollNewMessages(s){if(this.destroying){console.debug("Prevent polling new messages on MessagesList being destroyed");return}if(this.token!==s){console.debug(`token has changed to ${this.token}, breaking the loop for ${s}`);return}try{V.l.start(`${s} | long polling`),this.pollingErrorTimeout=1,await this.$store.dispatch("pollNewMessages",{token:s,lastKnownMessageId:this.$store.getters.getLastKnownMessageId(s),requestId:this.chatIdentifier}),V.l.end(`${s} | long polling`,"status 200")}catch(e){if(q.Ay.isCancel(e)){V.l.end(`${s} | long polling`,"cancelled"),console.debug("The request has been canceled",e);return}if(e?.response?.status===304){V.l.end(`${s} | long polling`,"status 304"),this.pollingErrorTimeout=1,setTimeout(()=>{this.pollNewMessages(s)},500);return}this.pollingErrorTimeout<30&&(this.pollingErrorTimeout+=5),V.l.end(`${s} | long polling`,`status ${e?.response?.status}`),console.debug("Error happened while getting chat messages. Trying again in ",this.pollingErrorTimeout,e),setTimeout(()=>{this.pollNewMessages(s)},this.pollingErrorTimeout*1e3);return}setTimeout(()=>{this.pollNewMessages(s)},500)},checkSticky(){const s=this.$refs["dateGroup-"+this.token];if(!s)return;const e=this.$refs.scroller.getBoundingClientRect();s.forEach(t=>{const a=t.getBoundingClientRect();a.top<=e.top&&a.bottom>=e.top&&(this.stickyDate=t.getAttribute("data-date-timestamp"))})},onScroll(s){this.isScrolling&&clearTimeout(this.endScrollTimeout),this.isScrolling=this.previousScrollTopValue>s.target.scrollTop?"up":"down",this.previousScrollTopValue=s.target.scrollTop,this.endScrollTimeout=setTimeout(this.endScroll,3e3),this.$refs.scroller.scrollTop===0?this.stickyDate=null:this.checkSticky(),this.debounceHandleScroll()},async handleScroll({skipHeightCheck:s=!1}={}){if(!this.$refs.scroller)return;if(!this.$store.getters.getFirstKnownMessageId(this.token)){console.debug("Ignoring handleScroll as the messages history is empty");return}if(this.isInitialisingMessages){console.debug("Ignore handleScroll as we are initialising the message history");return}if(this.isFocusingMessage){console.debug("Ignore handleScroll as we are programmatically scrolling to focus a message");return}const{scrollHeight:e,scrollTop:t,clientHeight:a}=this.$refs.scroller,n=e-t,o=Math.abs(n-a);if(o<Gt&&!this.hasMoreMessagesToLoad&&t>0){this.setChatScrolledToBottom(!0),this.displayMessagesLoader=!1,this.debounceUpdateReadMarkerPosition();return}if(o>=Gt&&this.setChatScrolledToBottom(!1),e>a&&t<800&&this.isScrolling==="up"||s){if(this.loadingOldMessages||this.isChatBeginningReached)return;this.displayMessagesLoader=!0,await this.getOldMessages(!1),this.displayMessagesLoader=!1,this.$refs.scroller.scrollHeight!==e&&this.$refs.scroller.scrollTo({top:t+(this.$refs.scroller.scrollHeight-e)}),this.setChatScrolledToBottom(!1,{auto:!0})}this.debounceUpdateReadMarkerPosition()},endScroll(){this.debounceHandleScroll.flush?.(),this.isScrolling=null,clearTimeout(this.endScrollTimeout)},findFirstVisibleMessage(s){if(!this.$refs.scroller)return;let e=s;if(!e||e.offsetParent===null){const n=this.$store.getters.getFirstDisplayableMessageIdAfterReadMarker(this.token,this.conversation.lastReadMessage);e=document.getElementById("message_"+n)}let t=e;const{scrollTop:a}=this.$refs.scroller;for(;e;){if(e.offsetTop-a>=0)return t;t=e,e=document.getElementById("message_"+e.getAttribute("data-next-message-id"))}return t},refreshReadMarkerPosition(){this.conversation&&(console.debug("setVisualLastReadMessageId token="+this.token+" id="+this.conversation.lastReadMessage),this.$store.dispatch("setVisualLastReadMessageId",{token:this.token,id:this.conversation.lastReadMessage}))},getVisualLastReadMessageElement(){let s=document.getElementById("message_"+this.visualLastReadMessageId);return s&&(s=s.closest(".message"),(s===null||s.offsetParent===null)&&(s=document.querySelector(".message-unread-marker"),s?s=s.closest(".message"):console.warn("Visual last read message element not found"))),s},updateReadMarkerPosition(){if(!this.conversation)return;if(this.conversation.lastReadMessage===0){console.debug("clearLastReadMessage because lastReadMessage was 0 token="+this.token),this.$store.dispatch("clearLastReadMessage",{token:this.token,updateVisually:!0});return}if(this.conversation.lastReadMessage===this.conversation.lastMessage?.id)return;const s=this.getVisualLastReadMessageElement();if(s&&s.getAttribute("data-seen")!=="true")return;if(this.isSticky&&!this.hasMoreMessagesToLoad){console.debug("clearLastReadMessage because of isSticky token="+this.token),this.$store.dispatch("clearLastReadMessage",{token:this.token});return}if(s&&this.$refs.scroller&&s.offsetTop-this.$refs.scroller.scrollTop>0)return;const e=this.findFirstVisibleMessage(s);if(!e){console.warn("First visible message not found: ",e);return}const t=parseInt(e.getAttribute("data-message-id"),10);t<=this.conversation.lastReadMessage||(console.debug("updateLastReadMessage token="+this.token+" messageId="+t),this.$store.dispatch("updateLastReadMessage",{token:this.token,id:t,updateVisually:!1}))},scrollToBottom(s={}){this.$nextTick(()=>{if(!this.$refs.scroller||this.isFocusingMessage)return;let e;if(s?.force)e=this.$refs.scroller.scrollHeight,this.setChatScrolledToBottom(!0);else if(this.isSticky)if(this.isChatVisible)e=this.$refs.scroller.scrollHeight,this.setChatScrolledToBottom(!0);else{const a=this.$refs.scroller.scrollHeight-this.$refs.scroller.scrollTop-this.$refs.scroller.offsetHeight<40?10:40;e=this.$refs.scroller.scrollTop+a,this.setChatScrolledToBottom(!1)}else return;this.$refs.scroller.scrollTo({top:e,behavior:s?.smooth?"smooth":"auto"})})},focusMessage(s,e=!0,t=!0){const a=document.getElementById(`message_${s}`);if(!a)return console.warn("Message to focus not found in DOM",s),!1;let n=a;return this.isChatVisible&&n.offsetParent===null&&(console.debug("Message to focus is hidden, scrolling to its nearest visible parent",s),n=n.closest('ul[style="display: none;"]').parentElement),console.debug("Scrolling to a focused message programmatically"),this.isFocusingMessage=!0,this.$nextTick(()=>{n.scrollIntoView({behavior:e?"smooth":"auto",block:"center",inline:"nearest"})}),this.$refs.scroller&&!e&&(this.$refs.scroller.scrollTop+=this.$refs.scroller.offsetHeight/4),this.checkChatNotScrollable(),t&&n===a&&a.classList.add("message--highlighted"),this.isFocusingMessage=!1,!0},getLastKnownMessageId(){let s=this.messagesList.length-1;for(;s>=0;){if(!this.messagesList[s].id.toString().startsWith("temp-"))return this.messagesList[s].id;s--}return"0"},getFirstKnownMessageId(){return this.messagesList[0].id.toString()},handleNetworkOffline(){console.debug("Canceling message request as we are offline"),this.$store.dispatch("cancelPollNewMessages",{requestId:this.chatIdentifier})},handleNetworkOnline(){console.debug("Restarting polling of new chat messages"),this.pollNewMessages(this.token)},async onRouteChange({from:s,to:e}){if(s.name==="conversation"&&e.name==="conversation"&&s.params.token===e.params.token&&s.hash!==e.hash&&e.hash&&e.hash.startsWith("#message_")){const t=this.getMessageIdFromHash(e.hash);this.messagesList.find(a=>a.id===t)?window.setTimeout(()=>{this.focusMessage(t,!0)},2):(this.$store.dispatch("setFirstKnownMessageId",{token:this.token,id:t}),this.$store.dispatch("setLastKnownMessageId",{token:this.token,id:t}),await this.getMessageContext(this.token,t),this.focusMessage(t,!0))}},setChatScrolledToBottom(s,{auto:e=!1}={}){let t=s;if(e){const a=this.$refs.scroller.scrollHeight-this.$refs.scroller.scrollTop;t=Math.abs(a-this.$refs.scroller.clientHeight)<Gt}this.$emit("update:is-chat-scrolled-to-bottom",t),t&&this.debounceUpdateReadMarkerPosition()},onWindowFocus(){setTimeout(()=>{this.refreshReadMarkerPosition(),Object.keys(this.dateSeparatorLabels).forEach(s=>{this.$set(this.dateSeparatorLabels,s,this.generateDateSeparator(s))})},2)},messagesGroupComponent(s){return s.isSystemMessagesGroup?Yl:Ul},onMessageHeightChanged({heightDiff:s}){this.$refs.scroller.scrollTop+=s},updateTasksCount(){if(!this.$refs.scroller)return;const s=this.$refs.scroller.querySelectorAll(".checkbox-content__icon--checked")?.length,e=this.$refs.scroller.querySelectorAll(".task-list-item")?.length;this.chatExtrasStore.setTasksCounters({tasksCount:e,tasksDoneCount:s})},checkChatNotScrollable(){const s=this.$refs.scroller?this.$refs.scroller.clientHeight===this.$refs.scroller.scrollHeight:!1;return s&&!this.isChatScrolledToBottom&&this.setChatScrolledToBottom(!0),s},handleWheelEvent(s){if(s.deltaY<0){if(this.isChatBeginningReached){this.$refs.scroller.removeEventListener("wheel",this.handleWheelEvent);return}this.isScrolling="up",this.debounceHandleScroll({skipHeightCheck:!0})}}}};var gt=i(78092),De={};De.styleTagTransform=R(),De.setAttributes=O(),De.insert=P().bind(null,"head"),De.domAPI=I(),De.insertStyleElement=L();var Y_=T()(gt.A,De);const X_=gt.A&&gt.A.locals?gt.A.locals:void 0;var Zl=(0,b.A)(Jl,Ca,va,!1,null,"6b78e40c",null);const Ql=Zl.exports;var Fs=i(87681),ql=function(){var e=this,t=e._self._c;return e.showModal?t("NcModal",{ref:"modal",attrs:{size:e.isVoiceMessage?"small":"normal","close-on-click-outside":!1,"label-id":e.dialogHeaderId},on:{close:e.handleDismiss}},[t("div",{staticClass:"upload-editor",on:{dragover:function(a){return a.preventDefault(),e.handleDragOver.apply(null,arguments)},dragleave:function(a){return a.preventDefault(),e.handleDragLeave.apply(null,arguments)},drop:function(a){return a.preventDefault(),e.handleDropFiles.apply(null,arguments)}}},[e.isVoiceMessage?[t("AudioPlayer",{attrs:{name:e.voiceMessageName,"local-url":e.voiceMessageLocalURL}})]:[t("h2",{staticClass:"hidden-visually",attrs:{id:e.dialogHeaderId}},[e._v(`
				`+e._s(e.t("spreed","Upload from device"))+`
			`)]),e._v(" "),t("input",{ref:"fileUploadInput",staticClass:"hidden-visually",attrs:{id:"file-upload",multiple:"",type:"file"},on:{change:e.handleFileInput}}),e._v(" "),t("TransitionWrapper",{staticClass:"upload-editor__previews",class:{"dragging-over":e.isDraggingOver},attrs:{name:"fade",tag:"div",group:""}},[e._l(e.files,function(a){return[t("FilePreview",{key:a[1].temporaryMessage.id,attrs:{token:e.token,"is-upload-editor":"",file:a[1].temporaryMessage.messageParameters.file},on:{"remove-file":e.handleRemoveFileFromSelection}})]}),e._v(" "),t("NcButton",{key:"add-more",staticClass:"add-more-button",attrs:{"aria-label":e.addMoreAriaLabel,type:"tertiary",size:"large"},on:{click:e.clickImportInput},scopedSlots:e._u([{key:"icon",fn:function(){return[t("Plus",{attrs:{size:48}})]},proxy:!0}],null,!1,1550548444)})],2)],e._v(" "),e.supportMediaCaption?t("NewMessage",{ref:"newMessage",staticClass:"upload-editor__textfield",attrs:{role:"region",upload:"",dialog:"",token:e.token,container:e.modalContainerId,"aria-label":e.t("spreed","Post message")},on:{submit:e.handleUpload,dismiss:e.handleDismiss}}):t("div",{staticClass:"upload-editor__actions"},[t("NcButton",{attrs:{type:"tertiary"},on:{click:e.handleDismiss}},[e._v(`
				`+e._s(e.t("spreed","Dismiss"))+`
			`)]),e._v(" "),t("NcButton",{ref:"submitButton",attrs:{type:"primary"},on:{click:e.handleLegacyUpload}},[e._v(`
				`+e._s(e.t("spreed","Send"))+`
			`)])],1)],2)]):e._e()},eu=[],tu=i(37479);const su={name:"NewMessageUploadEditor",components:{NcModal:Q.A,FilePreview:_s.A,Plus:wt.A,AudioPlayer:tu.A,NcButton:U.A,NewMessage:Fs.A,TransitionWrapper:Pt.A},setup(){const s=(0,l.KR)(null),e=(0,l.KR)(!1),t=`new-message-upload-${(0,Ye.B)()}`;return{modalContainerId:s,isDraggingOver:e,dialogHeaderId:t}},computed:{token(){return this.$store.getters.getToken()},supportMediaCaption(){return(0,N.t0)(this.token,"media-caption")},currentUploadId(){return this.$store.getters.currentUploadId},files(){return this.$store.getters.getInitialisedUploads(this.currentUploadId)},showModal(){return!!this.currentUploadId},addMoreAriaLabel(){return(0,r.t)("spreed","Add more files")},firstFile(){return this.files?.at(0)?.at(1)},isVoiceMessage(){return this.firstFile?this.firstFile.temporaryMessage.messageType===m.w5.TYPE.VOICE_MESSAGE:!1},voiceMessageName(){return this.firstFile?.file?.name?this.firstFile.file.name:""},voiceMessageLocalURL(){return this.$store.getters.getLocalUrl(this.firstFile.temporaryMessage.referenceId)}},watch:{async showModal(s){s&&(await this.$nextTick(),this.modalContainerId=`#modal-description-${this.$refs.modal.randId}`,this.supportMediaCaption?this.$refs.newMessage.focusInput():this.$refs.submitButton.$el.focus())}},methods:{t:r.t,handleDismiss(){this.$store.dispatch("discardUpload",this.currentUploadId)},handleLegacyUpload(){this.$store.dispatch("uploadFiles",{token:this.token,uploadId:this.currentUploadId,caption:null,options:null})},async handleUpload({token:s,temporaryMessage:e,options:t}){if(this.files.length)await this.$store.dispatch("uploadFiles",{token:s,uploadId:this.currentUploadId,caption:e.message,options:t});else if(this.$store.dispatch("discardUpload",this.currentUploadId),e.message.trim())try{await this.$store.dispatch("postNewMessage",{token:s,temporaryMessage:e,options:t})}catch(a){console.error(a)}},clickImportInput(){this.$refs.fileUploadInput.click()},handleFileInput(s){const e=Object.values(s.target.files);this.$store.dispatch("initialiseUpload",{files:e,token:this.token,uploadId:this.currentUploadId}),this.$refs.fileUploadInput.value=null},handleRemoveFileFromSelection(s){this.$store.dispatch("removeFileFromSelection",s)},handleDragOver(s){s.dataTransfer.types.includes("Files")&&(this.isDraggingOver=!0)},handleDragLeave(s){s.currentTarget.contains(s.relatedTarget)||(this.isDraggingOver=!1)},handleDropFiles(s){if(!this.isDraggingOver)return;this.isDraggingOver=!1;const e=Object.values(s.dataTransfer.files);this.$store.dispatch("initialiseUpload",{files:e,token:this.token,uploadId:this.currentUploadId})}}};var mt=i(73708),ye={};ye.styleTagTransform=R(),ye.setAttributes=O(),ye.insert=P().bind(null,"head"),ye.domAPI=I(),ye.insertStyleElement=L();var Z_=T()(mt.A,ye);const Q_=mt.A&&mt.A.locals?mt.A.locals:void 0;var au=(0,b.A)(su,ql,eu,!1,null,"a9598b96",null);const iu=au.exports,ru={name:"ChatView",components:{NcButton:U.A,NcEmptyContent:Z.A,MessagesList:Ql,NewMessage:Fs.A,NewMessageUploadEditor:iu,TransitionWrapper:Pt.A,GuestWelcomeWindow:ma,IconAccount:Qt.A,IconAlertOctagon:Zt,IconChevronDoubleDown:Xs,IconTrayArrowUp:ea},props:{isVisible:{type:Boolean,default:!0},isSidebar:{type:Boolean,default:!1}},setup(s){return(0,l.Gt)("chatView:isSidebar",s.isSidebar),{chatExtrasStore:(0,Ht.k)()}},data(){return{isChatScrolledToBottom:!0,isDraggingOver:!1}},computed:{isGuest(){return this.$store.getters.isActorGuest()},isGuestWithoutDisplayName(){return!this.$store.getters.getDisplayName()&&this.isGuest},canUploadFiles(){return(0,N.JR)(this.token,"attachments","allowed")&&this.$store.getters.getUserId()&&this.$store.getters.getAttachmentFolderFreeSpace()!==0&&this.conversation.permissions&m._z.PERMISSIONS.CHAT&&!this.conversation.remoteServer},isDragAndDropBlocked(){return this.chatExtrasStore.getMessageIdToEdit(this.token)!==void 0||!this.canUploadFiles},dropHintText(){return this.isGuest?(0,r.t)("spreed","You need to be logged in to upload files"):this.isReadOnly?(0,r.t)("spreed","This conversation is read-only"):(0,r.t)("spreed","Drop your files to upload")},isReadOnly(){if(this.conversation)return this.conversation.readOnly===m.si.STATE.READ_ONLY},token(){return this.$store.getters.getToken()},conversation(){return this.$store.getters.conversation(this.token)},isLoadingChat(){return!this.$store.getters.isMessagesListPopulated(this.token)}},methods:{t:r.t,handleDragOver(s){s.dataTransfer.types.includes("Files")&&!this.isDragAndDropBlocked&&(this.isDraggingOver=!0)},handleDragLeave(s){s.currentTarget.contains(s.relatedTarget)||(this.isDraggingOver=!1)},handleDropFiles(s){if(!this.isDraggingOver||this.isDragAndDropBlocked||(this.isDraggingOver=!1,this.isGuest||this.isReadOnly))return;const e=Object.values(s.dataTransfer.files),t=new Date().getTime();this.$store.dispatch("initialiseUpload",{files:e,token:this.token,uploadId:t})},scrollToBottom(){w.l.emit("scroll-chat-to-bottom",{smooth:!1,force:!0})}}};var Ct=i(54529),Ee={};Ee.styleTagTransform=R(),Ee.setAttributes=O(),Ee.insert=P().bind(null,"head"),Ee.domAPI=I(),Ee.insertStyleElement=L();var ep=T()(Ct.A,Ee);const tp=Ct.A&&Ct.A.locals?Ct.A.locals:void 0;var nu=(0,b.A)(ru,Ws,zs,!1,null,"18b378b3",null);const ou=nu.exports;var lu=function(){var e=this,t=e._self._c;return e.modal?t("NcModal",{attrs:{"label-id":e.dialogHeaderId},on:{close:e.closeModal}},[t("div",{staticClass:"media-settings"},[t("h2",{staticClass:"media-settings__title nc-dialog-alike-header",attrs:{id:e.dialogHeaderId}},[e._v(`
			`+e._s(e.t("spreed","Media settings"))+`
		`)]),e._v(" "),t("div",{staticClass:"media-settings__preview"},[t("video",{directives:[{name:"show",rawName:"v-show",value:e.showVideo,expression:"showVideo"}],ref:"video",staticClass:"preview__video",class:{"preview__video--mirrored":e.isMirrored},attrs:{disablePictureInPicture:"",tabindex:"-1"}}),e._v(" "),e.showVideo?t("NcButton",{staticClass:"media-settings__preview-mirror",attrs:{type:"secondary",title:e.mirrorToggleLabel,"aria-label":e.mirrorToggleLabel},on:{click:function(a){e.isMirrored=!e.isMirrored}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("IconReflectHorizontal",{attrs:{size:20}})]},proxy:!0}],null,!1,1245179250)}):e._e(),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.showVideo,expression:"!showVideo"}],staticClass:"preview__novideo"},[t("VideoBackground",{attrs:{"display-name":e.displayName,user:e.userId}}),e._v(" "),t("AvatarWrapper",{attrs:{id:e.userId,token:e.token,name:e.displayName,source:e.actorType,size:e.AVATAR.SIZE.EXTRA_LARGE,"disable-menu":"","disable-tooltip":""}})],1),e._v(" "),t("div",{staticClass:"media-settings__toggles"},[t("NcButton",{attrs:{type:"tertiary",title:e.audioButtonTitle,"aria-label":e.audioButtonTitle,disabled:!e.audioPreviewAvailable},on:{click:e.toggleAudio},scopedSlots:e._u([{key:"icon",fn:function(){return[t("VolumeIndicator",{attrs:{"audio-preview-available":e.audioPreviewAvailable,"audio-enabled":e.audioOn,"current-volume":e.currentVolume,"volume-threshold":e.currentThreshold,"overlay-muted-color":"#888888"}})]},proxy:!0}],null,!1,1973535079)}),e._v(" "),t("NcButton",{attrs:{type:"tertiary",title:e.videoButtonTitle,"aria-label":e.videoButtonTitle,disabled:!e.videoPreviewAvailable},on:{click:e.toggleVideo},scopedSlots:e._u([{key:"icon",fn:function(){return[e.videoOn?t("IconVideo",{attrs:{size:20}}):t("IconVideoOff",{attrs:{size:20}})]},proxy:!0}],null,!1,427690725)})],1)],1),e._v(" "),t("MediaSettingsTabs",{attrs:{active:e.tabContent,tabs:e.tabs},on:{"update:active":function(a){e.tabContent=a}},scopedSlots:e._u([{key:"tab-panel:devices",fn:function(){return[t("MediaDevicesSelector",{attrs:{kind:"audioinput",devices:e.devices,"device-id":e.audioInputId},on:{refresh:e.updateDevices,"update:deviceId":e.handleAudioInputIdChange}}),e._v(" "),t("MediaDevicesSelector",{attrs:{kind:"videoinput",devices:e.devices,"device-id":e.videoInputId},on:{refresh:e.updateDevices,"update:deviceId":e.handleVideoInputIdChange}}),e._v(" "),e.audioOutputSupported?t("MediaDevicesSelector",{attrs:{kind:"audiooutput",devices:e.devices,"device-id":e.audioOutputId},on:{refresh:e.updateDevices,"update:deviceId":e.handleAudioOutputIdChange}}):e._e(),e._v(" "),t("MediaDevicesSpeakerTest")]},proxy:!0},{key:"tab-panel:backgrounds",fn:function(){return[t("VideoBackgroundEditor",{staticClass:"media-settings__tab",attrs:{token:e.token,"skip-blur-virtual-background":e.skipBlurVirtualBackground},on:{"update-background":e.handleUpdateVirtualBackground}})]},proxy:!0}],null,!1,2578001999)}),e._v(" "),e.isInTalkDashboard?[e.supportStartWithoutMedia?t("NcCheckboxRadioSwitch",{attrs:{id:"call-media","model-value":e.startWithoutMediaEnabled,disabled:e.mediaLoading,type:"switch"},on:{"update:model-value":e.toggleStartWithoutMedia}},[e._v(`
				`+e._s(e.t("spreed","Turn off camera and microphone by default when joining a call"))+`
			`)]):e._e(),e._v(" "),e.supportDefaultBlurVirtualBackground?t("NcCheckboxRadioSwitch",{attrs:{type:"switch","model-value":e.blurVirtualBackgroundEnabled},on:{"update:model-value":e.setBlurVirtualBackgroundEnabled}},[e._v(`
				`+e._s(e.t("spreed","Enable blur background by default for all conversation"))+`
			`)]):e._e()]:[e.isPublicShareAuthSidebar?e._e():t("NcCheckboxRadioSwitch",{staticClass:"checkbox",attrs:{"model-value":e.showMediaSettings||e.showRecordingWarning,disabled:e.showRecordingWarning},on:{"update:model-value":e.setShowMediaSettings}},[e._v(`
				`+e._s(e.t("spreed","Always show preview for this conversation"))+`
			`)]),e._v(" "),!e.hasCall&&e.canModerateRecording?t("NcCheckboxRadioSwitch",{staticClass:"checkbox",model:{value:e.isRecordingFromStart,callback:function(a){e.isRecordingFromStart=a},expression:"isRecordingFromStart"}},[e._v(`
				`+e._s(e.t("spreed","Start recording immediately with the call"))+`
			`)]):e._e(),e._v(" "),e.showRecordingWarning?t("NcNoteCard",{attrs:{type:"warning"}},[e.isCurrentlyRecording?t("p",[t("strong",[e._v(e._s(e.t("spreed","The call is being recorded.")))])]):t("p",[t("strong",[e._v(e._s(e.t("spreed","The call might be recorded.")))])]),e._v(" "),e.isRecordingConsentRequired?[t("p",[e._v(`
						`+e._s(e.t("spreed","The recording might include your voice, video from camera, and screen share. Your consent is required before joining the call."))+`
					`)]),e._v(" "),t("NcCheckboxRadioSwitch",{staticClass:"checkbox--warning",attrs:{"model-value":e.recordingConsentGiven},on:{"update:model-value":e.setRecordingConsentGiven}},[e._v(`
						`+e._s(e.t("spreed","Give consent to the recording of this call"))+`
					`)])]:e._e()],2):e._e()],e._v(" "),t("div",{staticClass:"media-settings__call-buttons"},[e.isInTalkDashboard?e._e():[e.showSilentCallOption?t("NcActions",{attrs:{"force-menu":""}},[e.silentCall?t("NcActionButton",{attrs:{name:e.t("spreed","Normal call"),"close-after-click":""},on:{click:function(a){return e.setSilentCall(!1)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("IconBell",{attrs:{size:16}})]},proxy:!0}],null,!1,1012025185)},[e._v(`
						`+e._s(e.t("spreed","The conversation participants will be notified about this call"))+`
					`)]):t("NcActionButton",{attrs:{name:e.t("spreed","Call without notification"),"close-after-click":""},on:{click:function(a){return e.setSilentCall(!0)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("IconBellOff",{attrs:{size:16}})]},proxy:!0}],null,!1,3643103150)},[e._v(`
						`+e._s(e.t("spreed","The conversation participants will not be notified about this call"))+`
						`)])],1):e._e(),e._v(" "),e.isInCall?e._e():t("CallButton",{staticClass:"call-button",attrs:{"is-media-settings":"","is-recording-from-start":e.isRecordingFromStart,disabled:e.isRecordingConsentRequired&&!e.recordingConsentGiven,"recording-consent-given":e.recordingConsentGiven,"silent-call":e.silentCall}})],e._v(" "),e.showUpdateChangesButton?t("NcButton",{on:{click:e.closeModalAndApplySettings}},[e._v(`
				`+e._s(e.isInTalkDashboard?e.t("spreed","Save"):e.t("spreed","Apply settings"))+`
			`)]):e._e()],2)],2)]):e._e()},uu=[],Kt=i(32073),Bs=i(40083),du=i(53293),cu=i(35527),_u=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon reflect-horizontal-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M22,20H14A1,1 0 0,1 13,19V4.97C13,4.5 13.31,4.12 13.74,4C14.19,3.88 14.65,4.08 14.87,4.47L22.89,18.5C23.07,18.81 23.07,19.19 22.89,19.5C22.71,19.81 22.38,20 22,20M2,20C1.62,20 1.29,19.81 1.11,19.5C0.93,19.19 0.93,18.81 1.11,18.5L9.13,4.47C9.35,4.08 9.81,3.88 10.26,4C10.69,4.12 11,4.5 11,4.97V19A1,1 0 0,1 10,20H2M9,18V8.74L3.71,18H9Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},pu=[];const Au={name:"ReflectHorizontalIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var gu=(0,b.A)(Au,_u,pu,!1,null,null,null);const mu=gu.exports;var ks=i(45987),Cu=i(79946),vu=i(7789),hu=i(45261),fu=function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t("div",{staticClass:"media-devices-selector"},[t(a.deviceIcon,{tag:"component",staticClass:"media-devices-selector__icon",attrs:{title:"",size:16}}),e._v(" "),t(a.NcSelect,{attrs:{"input-id":`device-selector-${a.props.kind}`,options:a.deviceOptions,label:"label","aria-label-combobox":a.t("spreed","Select a device"),clearable:!1,placeholder:a.deviceSelectorPlaceholder,disabled:!e.enabled||!a.deviceOptionsAvailable},model:{value:a.deviceSelectedOption,callback:function(n){a.deviceSelectedOption=n},expression:"deviceSelectedOption"}}),e._v(" "),t(a.NcButton,{attrs:{type:"tertiary",title:a.t("spreed","Refresh devices list"),"aria-lebel":a.t("spreed","Refresh devices list")},on:{click:function(n){return e.$emit("refresh")}}},[t(a.IconRefresh,{attrs:{size:20}})],1)],1)},Du=[],yu=i(50402),Eu=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon refresh-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},bu=[];const Mu={name:"RefreshIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Fu=(0,b.A)(Mu,Eu,bu,!1,null,null,null);const Bu=Fu.exports;var ku=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon volume-high-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Su=[];const Tu={name:"VolumeHighIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Iu=(0,b.A)(Tu,ku,Su,!1,null,null,null);const Ss=Iu.exports,Pu=(0,l.pM)({__name:"MediaDevicesSelector",props:{kind:null,devices:null,deviceId:{default:void 0},enabled:{type:Boolean,default:!0}},emits:["refresh","update:deviceId"],setup(s,{emit:e}){const t=s,a=(0,l.EW)(()=>{const c=t.devices.filter(_=>_.kind===t.kind).map(_=>({id:_.deviceId,label:_.label?_.label:_.fallbackLabel}));return t.kind==="audiooutput"?c:[...c,{id:null,label:(0,r.t)("spreed","None")}]}),n=(0,l.EW)(()=>a.value.length>1),o=(0,l.EW)(()=>{switch(t.kind){case"audioinput":return yu.A;case"audiooutput":return Ss;case"videoinput":return ks.A;default:return null}}),u=(0,l.EW)(()=>{switch(t.kind){case"audioinput":return n.value?(0,r.t)("spreed","Select microphone"):(0,r.t)("spreed","No microphone available");case"audiooutput":return n.value?(0,r.t)("spreed","Select speaker"):(0,r.t)("spreed","No speaker available");case"videoinput":return n.value?(0,r.t)("spreed","Select camera"):(0,r.t)("spreed","No camera available");default:return""}}),d=(0,l.EW)({get:()=>a.value.find(c=>c.id===t.deviceId)??null,set:c=>{p(c?.id??null)}});function p(c){c!==t.deviceId&&(t.deviceId&&!a.value.find(_=>_.id===t.deviceId)||typeof t.deviceId>"u"||e("update:deviceId",c))}return{__sfc:!0,props:t,emit:e,deviceOptions:a,deviceOptionsAvailable:n,deviceIcon:o,deviceSelectorPlaceholder:u,deviceSelectedOption:d,updateDeviceId:p,t:r.t,NcButton:U.A,NcSelect:cs.A,IconRefresh:Bu}}});var vt=i(65394),be={};be.styleTagTransform=R(),be.setAttributes=O(),be.insert=P().bind(null,"head"),be.domAPI=I(),be.insertStyleElement=L();var np=T()(vt.A,be);const op=vt.A&&vt.A.locals?vt.A.locals:void 0;var Ou=(0,b.A)(Pu,fu,Du,!1,null,"1c8a36b0",null);const Lu=Ou.exports;var Ru=function(){var e=this,t=e._self._c;return t("div",{staticClass:"media-devices-checker"},[t("IconVolumeHigh",{staticClass:"media-devices-checker__icon",attrs:{size:16}}),e._v(" "),t("NcButton",{attrs:{type:"secondary"},on:{click:e.playTestSound}},[e._v(`
		`+e._s(e.buttonLabel)+`
	`)]),e._v(" "),e.isPlayingTestSound?t("div",{staticClass:"equalizer"},e._l(e.equalizerBars,function(a){return t("div",{key:a.key,staticClass:"equalizer__bar",style:a.style})}),0):e._e()],1)},xu=[],Ts=i(6355);const wu={name:"MediaDevicesSpeakerTest",components:{IconVolumeHigh:Ss,NcButton:U.A},setup(){return{soundsStore:(0,Ts.L)()}},computed:{isPlayingTestSound(){return this.soundsStore.audioObjectsPromises.wait!==null},buttonLabel(){return this.isPlayingTestSound?(0,r.t)("spreed","Playing \u2026"):(0,r.t)("spreed","Test speakers")},equalizerBars(){return Array.from(Array(4).keys()).map(s=>({key:s,style:{height:Math.random()*100+"%",animationDelay:Math.random()*-2+"s"}}))}},beforeDestroy(){this.soundsStore.pauseAudio("wait")},methods:{t:r.t,playTestSound(){this.isPlayingTestSound?this.soundsStore.pauseAudio("wait"):this.soundsStore.playAudio("wait")}}};var ht=i(59713),Me={};Me.styleTagTransform=R(),Me.setAttributes=O(),Me.insert=P().bind(null,"head"),Me.domAPI=I(),Me.insertStyleElement=L();var up=T()(ht.A,Me);const dp=ht.A&&ht.A.locals?ht.A.locals:void 0;var Nu=(0,b.A)(wu,Ru,xu,!1,null,"8e69121a",null);const ju=Nu.exports;var Uu=function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t("div",{staticClass:"tabs"},[t("div",{staticClass:"tab-list",attrs:{role:"tablist"}},e._l(e.tabs,function(n){return t(a.NcButton,{key:n.id,attrs:{id:a.getRefId("tab",n.id),wide:"",role:"tab",type:a.isSelected(n.id)?"secondary":"tertiary","aria-selected":a.isSelected(n.id)?"true":"false","aria-controls":a.getRefId("panel",n.id)},on:{click:function(o){return o.stopPropagation(),a.handleTabClick(n.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(n.icon,{tag:"component",attrs:{size:20}})]},proxy:!0}],null,!0)},[e._v(`
			`+e._s(n.label)+`
		`)])}),1),e._v(" "),t(a.TransitionExpand,{attrs:{show:a.isOpen,direction:"vertical"},on:{"after-leave":a.handleTabsAfterClosed}},[t("div",{staticClass:"tab-panels-container"},e._l(e.tabs,function(n){return t("div",{key:n.id,staticClass:"tab-panel",style:a.tabStyles,attrs:{id:a.getRefId("panel",n.id),role:"tabpanel",inert:!a.isActive(n.id),"aria-hidden":!a.isActive(n.id),"aria-labelledby":a.getRefId("tab",n.id)}},[e._t(`tab-panel:${n.id}`)],2)}),0)])],1)},$u=[],Vu=i(90495);const Wu=(0,l.pM)({__name:"MediaSettingsTabs",props:{tabs:null,active:null},emits:["update:active"],setup(s,{emit:e}){const t=s,a=(0,l.KR)(!!t.active),n=(0,r.V8)(),o=Math.random().toString(36).substring(7),u=(M,A)=>`tab-${o}-${M}-${A}`,d=(0,l.EW)(()=>t.tabs.findIndex(M=>M.id===t.active)),p=(0,l.EW)(()=>d.value!==-1?{transform:`translateX(${(n?1:-1)*d.value*100}%)`}:void 0);function c(M){return M===t.active}function _(M){return a.value&&c(M)}function g(M){c(M)?a.value=!a.value:(e("update:active",M),a.value=!0)}function C(){e("update:active",void 0)}return{__sfc:!0,props:t,emit:e,isOpen:a,isRTLDirection:n,randomId:o,getRefId:u,activeIndex:d,tabStyles:p,isActive:c,isSelected:_,handleTabClick:g,handleTabsAfterClosed:C,NcButton:U.A,TransitionExpand:Vu.A}}});var ft=i(16744),Fe={};Fe.styleTagTransform=R(),Fe.setAttributes=O(),Fe.insert=P().bind(null,"head"),Fe.domAPI=I(),Fe.insertStyleElement=L();var _p=T()(ft.A,Fe);const pp=ft.A&&ft.A.locals?ft.A.locals:void 0;var zu=(0,b.A)(Wu,Uu,$u,!1,null,"4a409665",null);const Hu=zu.exports;var Gu=function(){var e=this,t=e._self._c;return t("div",{staticClass:"background-editor"},[t("button",{key:"clear",staticClass:"background-editor__element",class:{"background-editor__element--selected":e.selectedBackground==="none"},on:{click:function(a){return e.handleSelectBackground("none")}}},[t("IconCancel",{attrs:{size:20}}),e._v(`
		`+e._s(e.t("spreed","None"))+`
	`)],1),e._v(" "),t("button",{key:"blur",staticClass:"background-editor__element",class:{"background-editor__element--selected":e.selectedBackground==="blur"},on:{click:function(a){return e.handleSelectBackground("blur")}}},[t("IconBlur",{attrs:{size:20}}),e._v(`
		`+e._s(e.t("spreed","Blur"))+`
	`)],1),e._v(" "),e.predefinedBackgrounds?.length?[e.canUploadBackgrounds?[t("button",{staticClass:"background-editor__element",on:{click:e.clickImportInput}},[t("IconUpload",{attrs:{size:20}}),e._v(`
				`+e._s(e.t("spreed","Upload"))+`
			`)],1),e._v(" "),t("button",{staticClass:"background-editor__element",class:{"background-editor__element--selected":e.isCustomBackground},on:{click:function(a){e.showFilePicker=!0}}},[t("IconFolder",{attrs:{size:20}}),e._v(`
				`+e._s(e.t("spreed","Files"))+`
			`)],1)]:e._e(),e._v(" "),e._l(e.predefinedBackgroundsURLs,function(a){return t("button",{key:a,staticClass:"background-editor__element",class:{"background-editor__element--selected":e.selectedBackground===a},style:{"background-image":"url("+a+")"},attrs:{"aria-label":e.ariaLabelForPredefinedBackground(a),title:e.ariaLabelForPredefinedBackground(a)},on:{click:function(n){return e.handleSelectBackground(a)}}},[e.selectedBackground===a?t("IconCheckBold",{attrs:{size:40,"fill-color":"#fff"}}):e._e()],1)})]:e._e(),e._v(" "),t("input",{ref:"fileUploadInput",staticClass:"hidden-visually",attrs:{id:"custom-background-file",multiple:"",type:"file",tabindex:"-1","aria-hidden":"true"},on:{change:e.handleFileInput}}),e._v(" "),e.showFilePicker?t("FilePickerVue",{attrs:{name:e.t("spreed","Select a file"),path:e.relativeBackgroundsFolderPath,container:".media-settings",buttons:e.filePickerButtons,multiselect:!1},on:{close:function(a){e.showFilePicker=!1}}}):e._e()],2)},Ku=[],Yu=i(8184),Xu=i(1077),Ju=i(39574),Zu=i(24509),S=i(24140),Is=i(97029),Ps=i(31310),Qu=i(88459);const qu={"1_office":(0,r.t)("spreed","Select virtual office background"),"2_home":(0,r.t)("spreed","Select virtual home background"),"3_abstract":(0,r.t)("spreed","Select virtual abstract background"),"4_beach":(0,r.t)("spreed","Select virtual beach background"),"5_park":(0,r.t)("spreed","Select virtual park background"),"6_theater":(0,r.t)("spreed","Select virtual theater background"),"7_library":(0,r.t)("spreed","Select virtual library background"),"8_space_station":(0,r.t)("spreed","Select virtual space station background")},ed={name:"VideoBackgroundEditor",components:{FilePickerVue:Yu.Z,IconBlur:Xu.A,IconCancel:fs,IconCheckBold:es,IconFolder:Ju.A,IconUpload:Zu.A},props:{token:{type:String,required:!0},skipBlurVirtualBackground:{type:Boolean,default:!1}},emits:["update-background"],setup(){return{canUploadBackgrounds:(0,N.JR)("local","call","can-upload-background"),predefinedBackgrounds:(0,N.JR)("local","call","predefined-backgrounds"),predefinedBackgroundsV2:(0,N.JR)("local","call","predefined-backgrounds-v2"),settingsStore:(0,Ps.C)()}},data(){return{selectedBackground:void 0,showFilePicker:!1}},computed:{isCustomBackground(){return this.selectedBackground!=="none"&&this.selectedBackground!=="blur"&&!this.predefinedBackgroundsURLs.includes(this.selectedBackground)},predefinedBackgroundsURLs(){return this.predefinedBackgroundsV2?this.predefinedBackgroundsV2:this.predefinedBackgrounds.map(s=>(0,Y.d0)("spreed","backgrounds/"+s))},relativeBackgroundsFolderPath(){return this.$store.getters.getAttachmentFolder()+"/Backgrounds"},filePickerButtons(){return[{label:(0,r.t)("spreed","Confirm"),callback:s=>this.handleFileChoose(s),type:"primary"}]}},async mounted(){if(this.loadBackground(),this.$store.getters.getUserId()===null){console.debug("Skip Talk backgrounds folder check and setup for participants that are not logged in");return}const e="/files/"+this.$store.getters.getUserId()+this.relativeBackgroundsFolderPath;try{const t=(0,Is.p)();await t.exists(e)===!1&&await t.createDirectory(e)}catch(t){console.debug(t)}},methods:{t:r.t,handleSelectBackground(s){this.$emit("update-background",s),this.selectedBackground=s},clickImportInput(){this.$refs.fileUploadInput.click()},async handleFileInput(s){const e=s.target.files[0];s.target.value="";const t="/files/"+this.$store.getters.getUserId(),a=this.$store.getters.getAttachmentFolder()+"/Backgrounds/"+e.name,n=(0,Is.p)(),{uniquePath:o}=await(0,Qu.a7)(n,t,a);try{const u=await new Blob([e]).arrayBuffer();await n.putFileContents(t+o,u,{contentLength:e.size});const d=await(0,Y.Jv)("/core/preview.png?file={path}&x=-1&y={height}&a=1",{path:a,height:1080});this.handleSelectBackground(d)}catch(u){console.debug(u),(0,x.Qg)((0,r.t)("spreed","Error while uploading the file"))}},handleFileChoose(s){const e=s[0]?.path;if(!e)return;if(!e.startsWith("/"))throw new Error((0,r.t)("files","Invalid path selected"));const t=(0,Y.Jv)("/core/preview.png?file={path}&x=-1&y={height}&a=1",{path:e,height:1080});this.handleSelectBackground(t)},loadBackground(){S.A.getItem("virtualBackgroundEnabled_"+this.token)==="true"?S.A.getItem("virtualBackgroundType_"+this.token)===m.Ju.BACKGROUND_TYPE.BLUR?this.selectedBackground="blur":S.A.getItem("virtualBackgroundType_"+this.token)===m.Ju.BACKGROUND_TYPE.IMAGE?this.selectedBackground=S.A.getItem("virtualBackgroundUrl_"+this.token):this.selectedBackground="none":this.settingsStore.blurVirtualBackgroundEnabled&&!this.skipBlurVirtualBackground?this.selectedBackground="blur":this.selectedBackground="none"},ariaLabelForPredefinedBackground(s){const e=s.split("/").pop().split(".").shift();return qu[e]??(0,r.t)("spreed","Select virtual background from file {fileName}",{fileName:e})}}};var Dt=i(6925),Be={};Be.styleTagTransform=R(),Be.setAttributes=O(),Be.insert=P().bind(null,"head"),Be.domAPI=I(),Be.insertStyleElement=L();var gp=T()(Dt.A,Be);const mp=Dt.A&&Dt.A.locals?Dt.A.locals:void 0;var td=(0,b.A)(ed,Gu,Ku,!1,null,"46481b48",null);const sd=td.exports;var ad=i(66885),id=i.n(ad),rd=i(21625),nd=i(19894),od=i(31775),J=i(47846);function ld(s,e){let t=!1,a=0,n=0;const o=(0,Ts.L)(),u=(0,l.KR)(null),d=(0,l.KR)(null),p=(0,l.Kh)(J.Dh);window.OCA.Talk.mediaDevicesManager=J.Dh;const c=(0,l.KR)(-100),_=(0,l.KR)(-100),g=(0,l.KR)(null),C=(0,l.KR)(null),M=(0,l.KR)(null),A=(0,l.KR)(null),B=(0,l.KR)(null),k=(0,l.EW)(()=>p.attributes.devices),W=(0,l.EW)({get(){return p.attributes.audioInputId},set(F){p.set("audioInputId",F)}}),xe=(0,l.EW)(()=>!!W.value&&!!C.value),we=(0,l.EW)(()=>{if(!C.value)return null;const F=C.value.getAudioTracks();return F.length<1?null:F[0].getSettings().deviceId}),se=(0,l.EW)({get(){return p.attributes.audioOutputId},set(F){p.set("audioOutputId",F)}}),He=(0,l.EW)(()=>p.isAudioOutputSelectSupported),H=(0,l.EW)({get(){return p.attributes.videoInputId},set(F){p.set("videoInputId",F)}}),Yt=(0,l.EW)(()=>!!H.value&&!!A.value),Tt=(0,l.EW)(()=>{if(!A.value)return null;const F=A.value.getVideoTracks();return F.length<1?null:F[0].getSettings().deviceId});(0,l.wB)(W,()=>{t&&G()}),(0,l.wB)(se,F=>{t&&F!==void 0&&(o.setGeneralAudioOutput(F),J.ki&&J.ki.setGeneralAudioOutput(F))}),(0,l.wB)(H,()=>{t&&Jt()}),(0,l.sV)(()=>{g.value=new od.A,g.value.setEnabled(!1),d.value=new nd.A,d.value.addInputTrackSlot("video"),g.value.connectTrackSink("default",d.value,"video"),e&&Ne()}),(0,l.xo)(()=>{It()});function Ne(){t||(t=!0,p.isSupported()||(M.value={message:"MediaDevicesManager is not supported",name:"NotSupportedError"},B.value={message:"MediaDevicesManager is not supported",name:"NotSupportedError"}),p.enableDeviceEvents(),G(),Jt(),p.attributes.audioOutputId!==void 0&&o.setGeneralAudioOutput(p.attributes.audioOutputId))}function Xt(){p._updateDevices()}function Ge(F){p.updatePreferences(F)}function It(){if(t)t=!1;else return;ee(),xs(),p.disableDeviceEvents()}function $(F){C.value=F,F&&(u.value=id()(F),u.value.on("volume_change",(ae,Mc)=>{c.value=ae,_.value=Mc}))}function ee(){C.value&&(C.value.getTracks().forEach(F=>F.stop()),C.value=null,M.value=null,u.value&&(u.value.off("volume_change"),u.value.stop(),u.value=null))}function je(){const F=a>1;a=0,F&&G()}function G(){if(p.isSupported()&&!(we.value&&we.value===W.value)){if(a){a++;return}ee(),!(W.value===null||W.value===void 0)&&(a=1,p.getUserMedia({audio:!0}).then(F=>{t?$(F):F.getTracks().forEach(ae=>ae.stop())}).catch(F=>{console.error("Error getting audio stream: "+F.name+": "+F.message),M.value=F,$(null)}).finally(()=>{je()}))}}function Ue(F){if(A.value=F,!s.value)return;if(!F){g.value._setInputTrack("default",null);return}g.value._setInputTrack("default",A.value.getVideoTracks()[0]);const ae={autoplay:!0,mirror:!0,muted:!0};(0,rd.A)(d.value.getStream(),s.value,ae)}function xs(){g.value._setInputTrack("default",null),A.value&&(A.value.getTracks().forEach(F=>F.stop()),A.value=null,B.value=null,s.value&&(s.value.srcObject=null))}function bc(){const F=n>1;n=0,F&&Jt()}function Jt(){if(p.isSupported()&&!(Tt.value&&Tt.value===H.value)){if(n){n++;return}xs(),!(H.value===null||H.value===void 0)&&(n=1,p.getUserMedia({video:!0}).then(F=>{t?Ue(F):F.getTracks().forEach(ae=>ae.stop())}).catch(F=>{console.error("Error getting video stream: "+F.name+": "+F.message),B.value=F,Ue(null)}).finally(()=>{bc()}))}}return{devices:k,updateDevices:Xt,currentVolume:c,currentThreshold:_,audioPreviewAvailable:xe,videoPreviewAvailable:Yt,audioInputId:W,audioOutputId:se,videoInputId:H,audioOutputSupported:He,audioStream:C,audioStreamError:M,videoStream:A,videoStreamError:B,initializeDevices:Ne,updatePreferences:Ge,stopDevices:It,virtualBackground:g}}const ud=(0,N.JR)("local","call","start-without-media")!==void 0,dd=(0,N.JR)("local","call","blur-virtual-background")!==void 0,cd={name:"MediaSettings",components:{AvatarWrapper:Je.A,CallButton:$t.A,MediaDevicesSelector:Lu,MediaDevicesSpeakerTest:ju,MediaSettingsTabs:Hu,NcActionButton:Ze.A,NcActions:Qe.A,NcButton:U.A,NcCheckboxRadioSwitch:Kt.A,NcModal:Q.A,NcNoteCard:Bs.A,VideoBackground:vu.A,VideoBackgroundEditor:sd,VolumeIndicator:hu.A,IconBell:du.A,IconBellOff:Lt.A,IconReflectHorizontal:mu,IconVideo:ks.A,IconVideoOff:Cu.A},props:{recordingConsentGiven:{type:Boolean,default:!1}},emits:["update:recording-consent-given"],setup(){const s=(0,l.KR)(null),e=(0,Ae.J)(),t=(0,$e.m)(),a=(0,Ps.C)(),n=`media-settings-header-${(0,Ye.B)()}`,{devices:o,updateDevices:u,updatePreferences:d,currentVolume:p,currentThreshold:c,audioPreviewAvailable:_,videoPreviewAvailable:g,audioInputId:C,audioOutputId:M,videoInputId:A,audioOutputSupported:B,initializeDevices:k,stopDevices:W,virtualBackground:xe}=ld(s,!1),we=(0,l.EW)(()=>xe.value.isAvailable()),se={id:"devices",label:(0,r.t)("spreed","Devices"),icon:(0,l.IG)(cu.A)},He={id:"backgrounds",label:(0,r.t)("spreed","Backgrounds"),icon:(0,l.IG)(ss)},H=(0,l.EW)(()=>we.value?[se,He]:[se]);return{AVATAR:m.of,isInCall:e,guestNameStore:t,settingsStore:a,video:s,devices:o,updateDevices:u,updatePreferences:d,currentVolume:p,currentThreshold:c,audioPreviewAvailable:_,videoPreviewAvailable:g,audioInputId:C,audioOutputId:M,videoInputId:A,audioOutputSupported:B,initializeDevices:k,stopDevices:W,virtualBackground:xe,model:J.PR,tabs:H,dialogHeaderId:n,supportStartWithoutMedia:ud,supportDefaultBlurVirtualBackground:dd}},data(){return{modal:!1,tabContent:void 0,audioOn:void 0,videoOn:void 0,silentCall:!1,updatedBackground:void 0,audioDeviceStateChanged:!1,videoDeviceStateChanged:!1,isRecordingFromStart:!1,isPublicShareAuthSidebar:!1,isMirrored:!1,skipBlurVirtualBackground:!1,mediaLoading:!1,isInTalkDashboard:!1}},computed:{displayName(){return this.$store.getters.getDisplayName()},guestName(){return this.guestNameStore.getGuestName(this.$store.getters.getToken(),this.$store.getters.getActorId())},userId(){return this.$store.getters.getUserId()},actorType(){return this.$store.getters.getActorType()},token(){return this.$store.getters.getToken()},showMediaSettings(){return this.settingsStore.getShowMediaSettings(this.token)},blurVirtualBackgroundEnabled(){return this.settingsStore.blurVirtualBackgroundEnabled},showVideo(){return this.videoPreviewAvailable&&this.videoOn},audioButtonTitle(){return this.audioPreviewAvailable?this.audioOn?(0,r.t)("spreed","Mute audio"):(0,r.t)("spreed","Unmute audio"):(0,r.t)("spreed","No audio")},videoButtonTitle(){return this.videoPreviewAvailable?this.videoOn?(0,r.t)("spreed","Disable video"):(0,r.t)("spreed","Enable video"):(0,r.t)("spreed","No camera")},mirrorToggleLabel(){return this.isMirrored?(0,r.t)("spreed","Display video as you will see it (mirrored)"):(0,r.t)("spreed","Display video as others will see it")},conversation(){return this.$store.getters.conversation(this.token)||this.$store.getters.dummyConversation},hasCall(){return this.conversation.hasCall},isCurrentlyRecording(){return[m.XV.RECORDING.VIDEO_STARTING,m.XV.RECORDING.AUDIO_STARTING,m.XV.RECORDING.VIDEO,m.XV.RECORDING.AUDIO].includes(this.conversation.callRecording)},canFullModerate(){return this.conversation.participantType===m._z.TYPE.OWNER||this.conversation.participantType===m._z.TYPE.MODERATOR},isInLobby(){return this.$store.getters.isInLobby},canModerateRecording(){return this.canFullModerate&&((0,N.JR)(this.token,"call","recording")||!1)},recordingConsent(){return(0,N.JR)(this.token,"call","recording-consent")},isRecordingConsentRequired(){return this.recordingConsent===m.PI.RECORDING_CONSENT.REQUIRED||this.recordingConsent===m.PI.RECORDING_CONSENT.OPTIONAL&&this.conversation.recordingConsent===m.XV.RECORDING_CONSENT.ENABLED},showRecordingWarning(){return!this.isInCall&&(this.isCurrentlyRecording||this.isRecordingConsentRequired)},showSilentCallOption(){return!(this.hasCall&&!this.isInLobby)&&!this.isPublicShareAuthSidebar},showUpdateChangesButton(){return(this.isInTalkDashboard||this.isInCall)&&(this.updatedBackground||this.audioDeviceStateChanged||this.videoDeviceStateChanged)},connectionFailed(){return this.$store.getters.connectionFailed(this.token)},startWithoutMediaEnabled(){return this.settingsStore.startWithoutMedia}},watch:{modal(s){s?(this.settingsStore.startWithoutMedia?(this.audioOn=!1,S.A.setItem("audioDisabled_"+this.token,"true"),this.videoOn=!1,S.A.setItem("videoDisabled_"+this.token,"true")):(this.audioOn=!S.A.getItem("audioDisabled_"+this.token),this.videoOn=!S.A.getItem("videoDisabled_"+this.token)),this.silentCall=!!S.A.getItem("silentCall_"+this.token),S.A.getItem("virtualBackgroundEnabled_"+this.token)==="true"?S.A.getItem("virtualBackgroundType_"+this.token)===m.Ju.BACKGROUND_TYPE.BLUR?this.blurVirtualBackground():S.A.getItem("virtualBackgroundType_"+this.token)===m.Ju.BACKGROUND_TYPE.IMAGE&&this.setVirtualBackgroundImage(S.A.getItem("virtualBackgroundUrl_"+this.token)):this.blurVirtualBackgroundEnabled&&!this.skipBlurVirtualBackground?this.blurVirtualBackground():this.clearVirtualBackground(),this.initializeDevices()):this.stopDevices()},audioInputId(s){this.tabContent==="devices"&&s&&!this.audioOn&&this.toggleAudio()},videoInputId(s){this.tabContent==="devices"&&s&&!this.videoOn&&this.toggleVideo()},isRecordingFromStart(s){this.setRecordingConsentGiven(s)},isInCall(s){if(s){const e=S.A.getItem("virtualBackgroundEnabled_"+this.token)==="true";this.blurVirtualBackgroundEnabled&&!this.skipBlurVirtualBackground&&!e&&this.blurBackground(!0)}else this.skipBlurVirtualBackground=!1},connectionFailed(s){s&&(this.skipBlurVirtualBackground=!1)}},beforeMount(){(0,X.B1)("talk:media-settings:show",this.showModal),(0,X.B1)("talk:media-settings:hide",this.closeModalAndApplySettings),S.A.getItem("devicesPreferred")&&S.A.removeItem("devicesPreferred")},beforeDestroy(){(0,X.al)("talk:media-settings:show",this.showModal),(0,X.al)("talk:media-settings:hide",this.closeModalAndApplySettings)},methods:{t:r.t,showModal(s){this.modal=!0,s==="video-verification"&&(this.isPublicShareAuthSidebar=!0),s==="device-check"&&(this.isInTalkDashboard=!0),(!S.A.getItem("audioInputDevicePreferred")||!S.A.getItem("videoInputDevicePreferred"))&&(this.tabContent="devices")},closeModal(){this.modal=!1,this.updatedBackground=void 0,this.audioDeviceStateChanged=!1,this.videoDeviceStateChanged=!1,this.isPublicShareAuthSidebar=!1,this.isInTalkDashboard=!1,this.isRecordingFromStart=!1,this.isMirrored=!1,this.updatePreferences("audioinput"),this.updatePreferences("audiooutput"),this.updatePreferences("videoinput")},toggleAudio(){this.audioOn?(S.A.setItem("audioDisabled_"+this.token,"true"),this.audioOn=!1):(S.A.removeItem("audioDisabled_"+this.token),this.audioOn=!0),this.audioDeviceStateChanged=!this.audioDeviceStateChanged},toggleVideo(){this.videoOn?(S.A.setItem("videoDisabled_"+this.token,"true"),this.videoOn=!1):(S.A.removeItem("videoDisabled_"+this.token),this.videoOn=!0),this.videoDeviceStateChanged=!this.videoDeviceStateChanged},setSilentCall(s){this.silentCall=s,s?S.A.setItem("silentCall_"+this.token,"true"):S.A.removeItem("silentCall_"+this.token)},closeModalAndApplySettings(){this.updatedBackground&&this.handleUpdateBackground(this.updatedBackground),this.audioDeviceStateChanged&&(0,X.Ic)("local-audio-control-button:toggle-audio"),this.videoDeviceStateChanged&&(0,X.Ic)("local-video-control-button:toggle-video"),this.closeModal()},handleUpdateBackground(s){this.blurVirtualBackgroundEnabled&&s!=="blur"&&(this.skipBlurVirtualBackground=!0),s==="none"?this.clearBackground():s==="blur"?this.blurBackground(this.blurVirtualBackgroundEnabled):this.setBackgroundImage(s)},handleUpdateVirtualBackground(s){this.updatedBackground=s,s==="none"?this.clearVirtualBackground():s==="blur"?this.blurVirtualBackground():this.setVirtualBackgroundImage(s)},clearVirtualBackground(){this.virtualBackground.setEnabled(!1)},clearBackground(){this.isInCall?J.PR.disableVirtualBackground():S.A.removeItem("virtualBackgroundEnabled_"+this.token)},blurVirtualBackground(){this.virtualBackground.setEnabled(!0),this.virtualBackground.setVirtualBackground({backgroundType:m.Ju.BACKGROUND_TYPE.BLUR,blurValue:m.Ju.BLUR_STRENGTH.DEFAULT})},blurBackground(s=!1){this.isInCall?(J.PR.enableVirtualBackground(),J.PR.setVirtualBackgroundBlur(m.Ju.BLUR_STRENGTH.DEFAULT,s)):s||(this.skipBlurVirtualBackground=!0,S.A.setItem("virtualBackgroundEnabled_"+this.token,"true"),S.A.setItem("virtualBackgroundType_"+this.token,m.Ju.BACKGROUND_TYPE.BLUR),S.A.setItem("virtualBackgroundBlurStrength_"+this.token,m.Ju.BLUR_STRENGTH.DEFAULT))},setVirtualBackgroundImage(s){this.virtualBackground.setEnabled(!0),this.virtualBackground.setVirtualBackground({backgroundType:m.Ju.BACKGROUND_TYPE.IMAGE,virtualSource:s})},setBackgroundImage(s){this.isInCall?(J.PR.enableVirtualBackground(),J.PR.setVirtualBackgroundImage(s)):(S.A.setItem("virtualBackgroundEnabled_"+this.token,"true"),S.A.setItem("virtualBackgroundType_"+this.token,m.Ju.BACKGROUND_TYPE.IMAGE),S.A.setItem("virtualBackgroundUrl_"+this.token,s))},setShowMediaSettings(s){this.settingsStore.setShowMediaSettings(this.token,s)},setRecordingConsentGiven(s){this.$emit("update:recording-consent-given",s)},handleAudioInputIdChange(s){this.audioInputId=s,this.updatePreferences("audioinput")},handleAudioOutputIdChange(s){this.audioOutputId=s,this.updatePreferences("audiooutput")},handleVideoInputIdChange(s){this.videoInputId=s,this.updatePreferences("videoinput")},async toggleStartWithoutMedia(s){this.mediaLoading=!0;try{await this.settingsStore.setStartWithoutMedia(s),(0,x.Te)((0,r.t)("spreed","Your default media state has been saved"))}catch{(0,x.Qg)((0,r.t)("spreed","Error while setting default media state"))}finally{this.mediaLoading=!1}},async setBlurVirtualBackgroundEnabled(s){try{await this.settingsStore.setBlurVirtualBackgroundEnabled(s),s?this.blurVirtualBackground():this.virtualBackground.setEnabled(!1)}catch(e){console.error("Failed to set blur background enabled:",e)}}}};var yt=i(7196),ke={};ke.styleTagTransform=R(),ke.setAttributes=O(),ke.insert=P().bind(null,"head"),ke.domAPI=I(),ke.insertStyleElement=L();var vp=T()(yt.A,ke);const hp=yt.A&&yt.A.locals?yt.A.locals:void 0;var _d=(0,b.A)(cd,lu,uu,!1,null,"7c03922a",null);const pd=_d.exports;var Ad=function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t("div",[a.showPollEditor?t(a.PollEditor,{ref:"pollEditorRef",attrs:{token:a.token,"can-create-poll-drafts":a.canCreatePollDrafts,container:a.container},on:{close:function(n){a.showPollEditor=!1}}}):e._e(),e._v(" "),a.canCreatePollDrafts&&a.showPollDraftHandler?t(a.PollDraftHandler,{attrs:{token:a.token,container:a.container,"editor-opened":a.showPollEditor},on:{close:function(n){a.showPollDraftHandler=!1}}}):e._e()],1)},gd=[],md=function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t(a.NcDialog,e._g({staticClass:"drafts",attrs:{name:a.t("spreed","Poll drafts"),container:e.container,size:"normal","close-on-click-outside":""},on:{"update:open":function(n){return a.emit("close")}},scopedSlots:e._u([a.props.editorOpened?null:{key:"actions",fn:function(){return[t(a.NcButton,{on:{click:function(n){return a.openPollEditor({id:null,action:"fill"})}}},[e._v(`
			`+e._s(a.t("spreed","Create new poll"))+`
		`)])]},proxy:!0}],null,!0)},e.$listeners),[a.pollDrafts.length?t("div",{staticClass:"drafts__wrapper"},e._l(a.pollDrafts,function(n){return t(a.Poll,{key:n.id,attrs:{id:n.id.toString(),token:e.token,name:n.question,draft:""},on:{click:a.openPollEditor}})}),1):t(a.EmptyView,{staticClass:"drafts__empty",attrs:{name:a.pollDraftsLoaded?a.t("spreed","No poll drafts"):a.t("spreed","Loading \u2026"),description:a.pollDraftsLoaded?a.t("spreed","There is no poll drafts yet saved for this conversation"):""},scopedSlots:e._u([{key:"icon",fn:function(){return[a.pollDraftsLoaded?t(a.IconPoll):t(a.NcLoadingIcon)]},proxy:!0}],null,!1,2767504160)})],1)},Cd=[],vd=function(){var e=this,t=e._self._c;return t("NcEmptyContent",{staticClass:"empty-view",attrs:{name:e.name,description:e.description},scopedSlots:e._u([{key:"icon",fn:function(){return[e._t("icon")]},proxy:!0}],null,!0)})},hd=[];const fd={name:"EmptyView",components:{NcEmptyContent:Z.A},props:{name:{type:String,required:!0},description:{type:String,required:!0}}};var Et=i(1030),Se={};Se.styleTagTransform=R(),Se.setAttributes=O(),Se.insert=P().bind(null,"head"),Se.domAPI=I(),Se.insertStyleElement=L();var Dp=T()(Et.A,Se);const yp=Et.A&&Et.A.locals?Et.A.locals:void 0;var Dd=(0,b.A)(fd,vd,hd,!1,null,"51aa65e6",null);const yd=Dd.exports,Ed=(0,l.pM)({__name:"PollDraftHandler",props:{token:null,editorOpened:{type:Boolean},container:null},emits:["close"],setup(s,{emit:e}){const t=s,a=(0,ze.v)();a.getPollDrafts(t.token);const n=(0,l.EW)(()=>a.getDrafts(t.token)),o=(0,l.EW)(()=>a.draftsLoaded(t.token));function u({id:d,action:p}){w.l.emit("poll-editor-open",{id:d,fromDrafts:!t.editorOpened,action:p,selector:t.container})}return{__sfc:!0,props:t,emit:e,pollsStore:a,pollDrafts:n,pollDraftsLoaded:o,openPollEditor:u,t:r.t,NcButton:U.A,NcDialog:We.A,NcLoadingIcon:te.A,IconPoll:Vt.A,EmptyView:yd,Poll:Wt}}});var bt=i(57300),Te={};Te.styleTagTransform=R(),Te.setAttributes=O(),Te.insert=P().bind(null,"head"),Te.domAPI=I(),Te.insertStyleElement=L();var bp=T()(bt.A,Te);const Mp=bt.A&&bt.A.locals?bt.A.locals:void 0;var bd=(0,b.A)(Ed,md,Cd,!1,null,"6bdc379b",null);const Md=bd.exports;var Fd=function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t(a.NcDialog,e._g({attrs:{name:a.dialogName,"close-on-click-outside":!a.isFilled,container:e.container},on:{"update:open":function(n){return a.emit("close")}},scopedSlots:e._u([{key:"actions",fn:function(){return[a.supportPollDrafts?t(a.NcActions,{attrs:{"force-menu":""}},[a.props.canCreatePollDrafts&&!a.editingDraftId?t(a.NcActionButton,{attrs:{disabled:!a.isFilled},on:{click:a.createPollDraft},scopedSlots:e._u([{key:"icon",fn:function(){return[t(a.IconFileEdit,{attrs:{size:20}})]},proxy:!0}],null,!1,602811801)},[e._v(`
				`+e._s(a.t("spreed","Save as draft"))+`
			`)]):e._e(),e._v(" "),a.isFilled?t(a.NcActionLink,{attrs:{href:a.exportPollURI,download:a.exportPollFileName},scopedSlots:e._u([{key:"icon",fn:function(){return[t(a.IconFileDownload,{attrs:{size:20}})]},proxy:!0}],null,!1,3727133841)},[e._v(`
				`+e._s(a.t("spreed","Export draft to file"))+`
			`)]):e._e()],1):e._e(),e._v(" "),t(a.NcButton,{attrs:{type:"primary",disabled:!a.isFilled},on:{click:a.handleSubmit}},[e._v(`
			`+e._s(a.createPollLabel)+`
		`)])]},proxy:!0}])},e.$listeners),[a.supportPollDrafts&&a.isOpenedFromDraft?t(a.NcButton,{staticClass:"poll-editor__back-button",attrs:{type:"tertiary",title:a.t("spreed","Back"),"aria-label":a.t("spreed","Back")},on:{click:a.goBack},scopedSlots:e._u([{key:"icon",fn:function(){return[t(a.IconArrowLeft,{staticClass:"bidirectional-icon",attrs:{size:20}})]},proxy:!0}],null,!1,541554724)}):e._e(),e._v(" "),t("p",{staticClass:"poll-editor__caption"},[e._v(`
		`+e._s(a.t("spreed","Question"))+`
	`)]),e._v(" "),t("div",{staticClass:"poll-editor__wrapper"},[t(a.NcTextField,e._g({attrs:{label:a.t("spreed","Ask a question")},model:{value:a.pollForm.question,callback:function(n){e.$set(a.pollForm,"question",n)},expression:"pollForm.question"}},e.$listeners)),e._v(" "),t("input",{ref:"pollImport",staticClass:"hidden-visually",attrs:{id:"poll-upload",type:"file"},on:{change:a.importPoll}}),e._v(" "),a.supportPollDrafts?t(a.NcActions,{attrs:{"force-menu":""}},[a.props.canCreatePollDrafts&&!a.isOpenedFromDraft?t(a.NcActionButton,{attrs:{"close-after-click":""},on:{click:a.openPollDraftHandler},scopedSlots:e._u([{key:"icon",fn:function(){return[t(a.IconFileEdit,{attrs:{size:20}})]},proxy:!0}],null,!1,602811801)},[e._v(`
				`+e._s(a.t("spreed","Browse poll drafts"))+`
			`)]):e._e(),e._v(" "),t(a.NcActionButton,{attrs:{"close-after-click":""},on:{click:a.triggerImport},scopedSlots:e._u([{key:"icon",fn:function(){return[t(a.IconFileUpload,{attrs:{size:20}})]},proxy:!0}],null,!1,161887622)},[e._v(`
				`+e._s(a.t("spreed","Import draft from file"))+`
			`)])],1):e._e()],1),e._v(" "),t("p",{staticClass:"poll-editor__caption"},[e._v(`
		`+e._s(a.t("spreed","Answers"))+`
	`)]),e._v(" "),e._l(a.pollForm.options,function(n,o){return t("div",{key:o,staticClass:"poll-editor__option"},[t(a.NcTextField,{ref:"pollOption",refInFor:!0,attrs:{label:a.t("spreed","Answer {option}",{option:o+1})},model:{value:a.pollForm.options[o],callback:function(u){e.$set(a.pollForm.options,o,u)},expression:"pollForm.options[index]"}}),e._v(" "),a.pollForm.options.length>2?t(a.NcButton,{attrs:{type:"tertiary","aria-label":a.t("spreed","Delete poll option")},on:{click:function(u){return a.deleteOption(o)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(a.Close,{attrs:{size:20}})]},proxy:!0}],null,!0)}):e._e()],1)}),e._v(" "),t(a.NcButton,{staticClass:"poll-editor__add-more",attrs:{type:"tertiary"},on:{click:a.addOption},scopedSlots:e._u([{key:"icon",fn:function(){return[t(a.Plus)]},proxy:!0}])},[e._v(`
		`+e._s(a.t("spreed","Add answer"))+`
	`)]),e._v(" "),t("p",{staticClass:"poll-editor__caption"},[e._v(`
		`+e._s(a.t("spreed","Settings"))+`
	`)]),e._v(" "),t("div",{staticClass:"poll-editor__settings"},[t(a.NcCheckboxRadioSwitch,{attrs:{type:"checkbox"},model:{value:a.isAnonymous,callback:function(n){a.isAnonymous=n},expression:"isAnonymous"}},[e._v(`
			`+e._s(a.t("spreed","Anonymous poll"))+`
		`)]),e._v(" "),t(a.NcCheckboxRadioSwitch,{attrs:{type:"checkbox"},model:{value:a.isMultipleAnswer,callback:function(n){a.isMultipleAnswer=n},expression:"isMultipleAnswer"}},[e._v(`
			`+e._s(a.t("spreed","Multiple answers"))+`
		`)])],1)],2)},Bd=[],kd=i(83614),Sd=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon file-download-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M14,2H6C4.89,2 4,2.89 4,4V20C4,21.11 4.89,22 6,22H18C19.11,22 20,21.11 20,20V8L14,2M12,19L8,15H10.5V12H13.5V15H16L12,19M13,9V3.5L18.5,9H13Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Td=[];const Id={name:"FileDownloadIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Pd=(0,b.A)(Id,Sd,Td,!1,null,null,null);const Os=Pd.exports;var Od=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon file-edit-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M6 2C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H10V20.1L20 10.1V8L14 2H6M13 3.5L18.5 9H13V3.5M20.1 13C20 13 19.8 13.1 19.7 13.2L18.7 14.2L20.8 16.3L21.8 15.3C22 15.1 22 14.7 21.8 14.5L20.5 13.2C20.4 13.1 20.3 13 20.1 13M18.1 14.8L12 20.9V23H14.1L20.2 16.9L18.1 14.8Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Ld=[];const Rd={name:"FileEditIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var xd=(0,b.A)(Rd,Od,Ld,!1,null,null,null);const Ls=xd.exports;var wd=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon file-upload-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M13.5,16V19H10.5V16H8L12,12L16,16H13.5M13,9V3.5L18.5,9H13Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},Nd=[];const jd={name:"FileUploadIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var Ud=(0,b.A)(jd,wd,Nd,!1,null,null,null);const $d=Ud.exports,Vd=function(s,e="text/plain;charset=US-ASCII",t=""){return"data:"+e+t+","+encodeURIComponent(s)},Rs=function(s){return Vd(JSON.stringify(s,null,2),"application/json;charset=utf-8")},Wd=["question","options","resultMode","maxVotes"];function zd(s){return Array.isArray(s)&&s.every(e=>typeof e=="string")}function Hd(s){if(typeof s!="object"||!s)throw new Error("Invalid parsed object");const e=s;for(const t of Wd)if(e[t]===void 0)throw new Error("Missing required key");if(typeof e.question!="string")throw new Error("Invalid parsed value: question");if(typeof e.resultMode!="number"||!(e.resultMode===0||e.resultMode===1))throw new Error("Invalid parsed value: resultMode");if(typeof e.maxVotes!="number")throw new Error("Invalid parsed value: maxVotes");if(!zd(e.options))throw new Error("Invalid parsed value: options");return{question:e.question,options:[...e.options],resultMode:e.resultMode,maxVotes:e.maxVotes}}const Gd=(0,l.pM)({__name:"PollEditor",props:{token:null,canCreatePollDrafts:{type:Boolean},container:null},emits:["close"],setup(s,{expose:e,emit:t}){const a=s;e({fillPollEditorFromDraft:H});const n=(0,N.t0)(a.token,"talk-polls-drafts"),o=(0,ie.P)(),u=(0,ze.v)(),d=(0,l.KR)(!1),p=(0,l.KR)(null),c=(0,l.KR)(null),_=(0,l.KR)(null),g=(0,l.Kh)({question:"",options:["",""],resultMode:m.eE.MODE.PUBLIC,maxVotes:m.eE.ANSWER_TYPE.SINGLE}),C=(0,l.EW)(()=>!!g.question&&g.options.filter($=>!!$).length>=2),M=(0,l.EW)(()=>p.value?(0,r.t)("spreed","Edit poll draft"):(0,r.t)("spreed","Create new poll")),A=(0,l.EW)(()=>p.value?(0,r.t)("spreed","Save"):o.getters.getToken()!==a.token?(0,r.t)("spreed","Create poll in {name}",{name:o.getters.conversation(a.token).displayName},void 0,{escape:!1,sanitize:!1}):(0,r.t)("spreed","Create poll")),B=(0,l.EW)({get(){return g.resultMode===m.eE.MODE.HIDDEN},set($){g.resultMode=$?m.eE.MODE.HIDDEN:m.eE.MODE.PUBLIC}}),k=(0,l.EW)({get(){return g.maxVotes===m.eE.ANSWER_TYPE.MULTIPLE},set($){g.maxVotes=$?m.eE.ANSWER_TYPE.MULTIPLE:m.eE.ANSWER_TYPE.SINGLE}}),W=(0,l.EW)(()=>Rs(g)),xe=`Talk Poll ${new Date().toISOString().slice(0,10)}`;function we($){g.options.splice($,1)}function se(){g.options.push(""),(0,l.dY)(()=>{c.value.at(-1).focus()})}async function He(){if(p.value){await u.updatePollDraft({token:a.token,pollId:p.value,form:g})&&(Ge(),(0,l.dY)(()=>{t("close")}));return}await u.createPoll({token:a.token,form:g})&&t("close")}function H($,ee,je){if(ee&&(d.value=!0),je==="edit"&&(p.value=$),$===null)return;const G=u.drafts[a.token][$];G&&Ne({question:G.question,options:[...G.options],resultMode:G.resultMode,maxVotes:G.maxVotes})}function Yt(){_.value.click()}function Tt($){const ee=$.target.files?.[0];if(!ee)return;const je=new FileReader;je.onload=G=>{try{const Ue=Hd(JSON.parse(G.target.result));Ne(Ue)}catch(Ue){(0,x.Qg)((0,r.t)("spreed","Error while importing poll")),console.error("Error while importing poll:",Ue)}},je.readAsText(ee)}function Ne($){Object.assign(g,$)}async function Xt(){await u.createPollDraft({token:a.token,form:g})}function Ge(){w.l.emit("poll-drafts-open",{selector:a.container})}function It(){Ge(),d.value&&(0,l.dY)(()=>{t("close")})}return{__sfc:!0,props:a,emit:t,supportPollDrafts:n,store:o,pollsStore:u,isOpenedFromDraft:d,editingDraftId:p,pollOption:c,pollImport:_,pollForm:g,isFilled:C,dialogName:M,createPollLabel:A,isAnonymous:B,isMultipleAnswer:k,exportPollURI:W,exportPollFileName:xe,deleteOption:we,addOption:se,handleSubmit:He,fillPollEditorFromDraft:H,triggerImport:Yt,importPoll:Tt,fillPollForm:Ne,createPollDraft:Xt,openPollDraftHandler:Ge,goBack:It,t:r.t,NcActionButton:Ze.A,NcActionLink:Ot.A,NcActions:Qe.A,NcButton:U.A,NcCheckboxRadioSwitch:Kt.A,NcDialog:We.A,NcTextField:qt.A,IconArrowLeft:rs.A,Close:kd.A,IconFileDownload:Os,IconFileEdit:Ls,IconFileUpload:$d,Plus:wt.A}}});var Mt=i(18408),Ie={};Ie.styleTagTransform=R(),Ie.setAttributes=O(),Ie.insert=P().bind(null,"head"),Ie.domAPI=I(),Ie.insertStyleElement=L();var Tp=T()(Mt.A,Ie);const Ip=Mt.A&&Mt.A.locals?Mt.A.locals:void 0;var Kd=(0,b.A)(Gd,Fd,Bd,!1,null,"1b71dcf8",null);const Yd=Kd.exports,Xd=(0,l.pM)({__name:"PollManager",setup(s){const e=(0,ie.P)(),t=(0,l.KR)(null),a=(0,l.KR)(!1),n=(0,l.KR)(!1),o=(0,l.KR)(void 0),u=(0,l.EW)(()=>e.getters.getConversationSettingsToken()||e.getters.getToken()),d=(0,l.EW)(()=>{const{participantType:_,type:g}=e.getters.conversation(u.value)??{};return(0,N.t0)(u.value,"talk-polls-drafts")&&[m._z.TYPE.OWNER,m._z.TYPE.MODERATOR,m._z.TYPE.GUEST_MODERATOR].includes(_)&&[m.si.TYPE.GROUP,m.si.TYPE.PUBLIC].includes(g)});(0,l.sV)(()=>{w.l.on("poll-editor-open",c),w.l.on("poll-drafts-open",p)}),(0,l.xo)(()=>{w.l.off("poll-editor-open",c),w.l.off("poll-drafts-open",p)});function p({selector:_}){o.value=_,n.value=!0}function c({id:_,fromDrafts:g,action:C,selector:M}){o.value=M,a.value=!0,(0,l.dY)(()=>{t.value?.fillPollEditorFromDraft(_,g,C),n.value=!1})}return{__sfc:!0,store:e,pollEditorRef:t,showPollEditor:a,showPollDraftHandler:n,container:o,token:u,canCreatePollDrafts:d,openPollDraftHandler:p,openPollEditor:c,PollDraftHandler:Md,PollEditor:Yd}}});var Jd=(0,b.A)(Xd,Ad,gd,!1,null,null,null);const Zd=Jd.exports;var Qd=function(){var e=this,t=e._self._c;return e.id?t("NcModal",{attrs:{size:"small","label-id":e.dialogHeaderId},on:{close:e.dismissModal}},[e.poll?t("div",{staticClass:"poll-modal"},[t("div",{staticClass:"poll-modal__header"},[t("IconPoll",{attrs:{size:20}}),e._v(" "),t("span",{attrs:{id:e.dialogHeaderId,role:"heading","aria-level":"2"}},[e._v(`
				`+e._s(e.name)+`
			`)])],1),e._v(" "),t("p",{staticClass:"poll-modal__summary"},[e._v(`
			`+e._s(e.pollSummaryText)+`
		`)]),e._v(" "),e.modalPage==="voting"?t("div",{staticClass:"poll-modal__options"},e._l(e.poll.options,function(a,n){return t("NcCheckboxRadioSwitch",{key:"option-"+n,attrs:{value:n.toString(),type:e.isMultipleAnswers?"checkbox":"radio",name:"answerType"},model:{value:e.checked,callback:function(o){e.checked=o},expression:"checked"}},[e._v(`
				`+e._s(a)+`
			`)])}),1):e.modalPage==="results"?t("div",{staticClass:"results__options"},e._l(e.poll.options,function(a,n){return t("div",{key:n,staticClass:"results__option"},[t("div",{staticClass:"results__option-title"},[t("p",[e._v(e._s(a))]),e._v(" "),e.hasVotesToDisplay?t("p",{staticClass:"percentage"},[e._v(`
						`+e._s(e.votePercentage[n]+"%")+`
					`)]):e._e()]),e._v(" "),e.getFilteredDetails(n).length>0||e.selfHasVotedOption(n)?t("div",{staticClass:"results__option__details"},[e.poll.details?t("PollVotersDetails",{attrs:{token:e.token,details:e.getFilteredDetails(n)}}):e._e(),e._v(" "),e.selfHasVotedOption(n)?t("p",{staticClass:"results__option-subtitle"},[t("IconCheck",{attrs:{size:16}}),e._v(`
						`+e._s(e.t("spreed","You voted for this option"))+`
					`)],1):e._e()],1):e._e(),e._v(" "),e.hasVotesToDisplay?t("NcProgressBar",{staticClass:"results__option-progress",attrs:{value:e.votePercentage[n],size:"medium"}}):e._e()],1)}),0):e._e(),e._v(" "),e.isPollOpen?t("div",{staticClass:"poll-modal__actions"},[e.modalPage==="voting"?t("NcButton",{attrs:{type:"primary",disabled:e.disabled},on:{click:e.submitVote}},[e._v(`
				`+e._s(e.t("spreed","Submit vote"))+`
			`)]):t("NcButton",{attrs:{type:"secondary"},on:{click:function(a){e.modalPage="voting"}}},[e._v(`
				`+e._s(e.t("spreed","Change your vote"))+`
			`)]),e._v(" "),e.canEndPoll?t("NcActions",{attrs:{"force-menu":""}},[e.supportPollDrafts&&e.isModerator?t("NcActionButton",{on:{click:e.createPollDraft},scopedSlots:e._u([{key:"icon",fn:function(){return[t("IconFileEdit",{attrs:{size:20}})]},proxy:!0}],null,!1,332626905)},[e._v(`
					`+e._s(e.t("spreed","Save as draft"))+`
				`)]):e._e(),e._v(" "),e.supportPollDrafts?t("NcActionLink",{attrs:{href:e.exportPollURI,download:e.exportPollFileName},scopedSlots:e._u([{key:"icon",fn:function(){return[t("IconFileDownload",{attrs:{size:20}})]},proxy:!0}],null,!1,722742481)},[e._v(`
					`+e._s(e.t("spreed","Export draft to file"))+`
				`)]):e._e(),e._v(" "),t("NcActionButton",{staticClass:"critical",on:{click:e.endPoll},scopedSlots:e._u([{key:"icon",fn:function(){return[t("IconFileLock",{attrs:{size:20}})]},proxy:!0}],null,!1,995290382)},[e._v(`
					`+e._s(e.t("spreed","End poll"))+`
					`)])],1):e._e()],1):e.supportPollDrafts&&e.selfIsOwnerOrModerator?t("div",{staticClass:"poll-modal__actions"},[t("NcActions",{attrs:{"force-menu":""}},[e.isModerator?t("NcActionButton",{on:{click:e.createPollDraft},scopedSlots:e._u([{key:"icon",fn:function(){return[t("IconFileEdit",{attrs:{size:20}})]},proxy:!0}],null,!1,332626905)},[e._v(`
					`+e._s(e.t("spreed","Save as draft"))+`
				`)]):e._e(),e._v(" "),t("NcActionLink",{attrs:{href:e.exportPollURI,download:e.exportPollFileName},scopedSlots:e._u([{key:"icon",fn:function(){return[t("IconFileDownload",{attrs:{size:20}})]},proxy:!0}],null,!1,722742481)},[e._v(`
					`+e._s(e.t("spreed","Export draft to file"))+`
				`)])],1)],1):e._e()]):t("NcLoadingIcon",{staticClass:"poll-modal__loading"})],1):e._e()},qd=[],ec=i(95101),tc=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon file-lock-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(a){return e.$emit("click",a)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M18 13C16.6 13 15.2 14.1 15.2 15.5V17C14.6 17 14 17.6 14 18.2V21.7C14 22.4 14.6 23 15.2 23H20.7C21.4 23 22 22.4 22 21.8V18.3C22 17.6 21.4 17 20.8 17V15.5C20.8 14.1 19.4 13 18 13M18 14.2C18.8 14.2 19.5 14.7 19.5 15.5V17H16.5V15.5C16.5 14.7 17.2 14.2 18 14.2M6 2C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H12V18.2C12 17.2 12.4 16.5 13 16C13.1 15.9 13.2 15.9 13.2 15.8V15.5C13.2 12.8 15.6 11 18 11C18.7 11 19.4 11.2 20 11.4V8L14 2H6M13 3.5L18.5 9H13V3.5Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},sc=[];const ac={name:"FileLockIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var ic=(0,b.A)(ac,tc,sc,!1,null,null,null);const rc=ic.exports;var nc=function(){var e=this,t=e._self._c;return t("NcPopover",{staticClass:"poll-voters-details",attrs:{trigger:"hover"},scopedSlots:e._u([{key:"trigger",fn:function(){return[t("NcButton",{staticClass:"poll-voters-details__button",attrs:{type:"tertiary-no-background","aria-label":e.t("spreed","Voted participants")},scopedSlots:e._u([{key:"icon",fn:function(){return e._l(e.details.slice(0,8),function(a,n){return t("AvatarWrapper",{key:n,attrs:{id:a.actorId,token:e.token,name:e.getDisplayName(a),source:a.actorType,size:e.AVATAR.SIZE.EXTRA_SMALL,condensed:"","disable-menu":"","disable-tooltip":""}})})},proxy:!0}])})]},proxy:!0}])},[e._v(" "),t("div",{staticClass:"poll-voters-details__popover",attrs:{tabindex:"0"}},e._l(e.details,function(a,n){return t("div",{key:n,staticClass:"poll-voters-details__list-item"},[t("AvatarWrapper",{attrs:{id:a.actorId,token:e.token,name:a.actorDisplayName.trim(),source:a.actorType,size:e.AVATAR.SIZE.EXTRA_SMALL,"disable-menu":""}}),e._v(" "),t("p",{staticClass:"poll-voters-details__display-name"},[e._v(`
				`+e._s(e.getDisplayName(a))+`
			`)])],1)}),0)])},oc=[];const lc={name:"PollVotersDetails",components:{AvatarWrapper:Je.A,NcButton:U.A,NcPopover:Es.A},props:{token:{type:String,required:!0},details:{type:Array,required:!0}},setup(){return{AVATAR:m.of}},methods:{t:r.t,getDisplayName(s){return(0,zt.G)(s.actorDisplayName,s.actorType)}}};var Ft=i(30197),Pe={};Pe.styleTagTransform=R(),Pe.setAttributes=O(),Pe.insert=P().bind(null,"head"),Pe.domAPI=I(),Pe.insertStyleElement=L();var Rp=T()(Ft.A,Pe);const xp=Ft.A&&Ft.A.locals?Ft.A.locals:void 0;var uc=(0,b.A)(lc,nc,oc,!1,null,"154f7bb4",null);const dc=uc.exports;function cc(s){let e=0;const t=[];for(let a=0;a<s.length;a++)s[a]>e?(e=s[a],t.length=0,t.push(a)):s[a]===e&&t.push(a);return t}function _c(s,e){if(!e)return s;const t=[],a=[],n=[];let o=0,u=0;for(const d in s){const p=s[d]/e*100;t.push(Math.round(p)),a.push(Math.floor(p)),n.push(Math.round(p%1*1e3)),o+=t[d],u+=a[d]}if(o===100)return t;for(let d=100-u;d>0;){const p=cc(n);if(p.length>d)return a;for(const c of p)a[c]++,n[c]=0,d--}return a}const pc={name:"PollViewer",components:{NcActions:Qe.A,NcActionButton:Ze.A,NcActionLink:Ot.A,NcCheckboxRadioSwitch:Kt.A,NcLoadingIcon:te.A,NcModal:Q.A,NcButton:U.A,NcProgressBar:ec.A,PollVotersDetails:dc,IconCheck:qe.A,IconFileLock:rc,IconFileDownload:Os,IconFileEdit:Ls,IconPoll:Vt.A},setup(){const s=(0,l.KR)([]),e=(0,l.KR)(""),t=(0,l.KR)(!1),a=`guest-welcome-header-${(0,Ye.B)()}`,n=(0,ze.v)(),o=(0,l.EW)(()=>n.activePoll),u=(0,l.EW)(()=>o.value?.name),d=(0,l.EW)(()=>o.value?.id),p=(0,l.EW)(()=>o.value?.token),c=(0,l.EW)(()=>n.getPoll(p.value,d.value)),_=(0,l.EW)(()=>(0,N.t0)(p.value,"talk-polls-drafts")),g=(0,l.EW)(()=>Rs({question:c.value.question,options:c.value.options,resultMode:c.value.resultMode,maxVotes:c.value.maxVotes})),C=`Talk Poll ${new Date().toISOString().slice(0,10)}`;return{isInCall:(0,Ae.J)(),pollsStore:n,voteToSubmit:s,modalPage:e,loading:t,dialogHeaderId:a,name:u,id:d,token:p,poll:c,supportPollDrafts:_,exportPollURI:g,exportPollFileName:C}},computed:{selfHasVoted(){return this.poll?.votedSelf?.length>0},isPollPublic(){return this.poll?.resultMode===m.eE.MODE.PUBLIC},isPollOpen(){return this.poll?.status===m.eE.STATUS.OPEN},isPollClosed(){return this.poll?.status===m.eE.STATUS.CLOSED},isMultipleAnswers(){return this.poll?.maxVotes===m.eE.ANSWER_TYPE.MULTIPLE},checked:{get(){return this.voteToSubmit},set(s){this.voteToSubmit=Array.isArray(s)?s:[s]}},disabled(){return this.loading||this.voteToSubmit.length===0},isModerator(){return this.$store.getters.isModerator},selfIsOwnerOrModerator(){return this.isModerator||this.poll?.actorType===this.$store.getters.getActorType()&&this.poll?.actorId===this.$store.getters.getActorId()},pollSummaryText(){return this.isPollClosed?(0,r.n)("spreed","Poll results \u2022 %n vote","Poll results \u2022 %n votes",this.poll?.numVoters):this.isPollPublic&&(this.selfIsOwnerOrModerator||this.selfHasVoted)?(0,r.n)("spreed","Open poll \u2022 %n vote","Open poll \u2022 %n votes",this.poll?.numVoters):!this.isPollPublic&&this.selfHasVoted?(0,r.t)("spreed","Open poll \u2022 You voted already"):(0,r.t)("spreed","Open poll")},canEndPoll(){return this.isPollOpen&&this.selfIsOwnerOrModerator},hasVotesToDisplay(){return Object.keys(Object(this.poll?.votes)).length!==0},votePercentage(){const s=Object.keys(Object(this.poll?.options)).map(e=>this.poll?.votes["option-"+e]??0);return _c(s,this.poll.numVoters)}},watch:{modalPage(s){s==="voting"&&this.setVoteData()},id(s){this.pollsStore.hidePollToast(s)},isInCall(s){s||this.pollsStore.hideAllPollToasts()},poll:{immediate:!0,handler(s){s?this.selfHasVoted||this.isPollClosed?this.modalPage="results":this.modalPage="voting":this.modalPage=""}}},mounted(){w.l.on("talk:poll-added",this.showPollToast)},beforeDestroy(){w.l.off("talk:poll-added",this.showPollToast)},methods:{t:r.t,n:r.n,getPollData(){this.poll||this.pollsStore.getPollData({token:this.token,pollId:this.id})},setVoteData(){this.voteToSubmit=this.selfHasVoted?this.poll?.votedSelf.map(s=>s.toString()):[]},showPollToast({token:s,message:e}){this.isInCall&&this.pollsStore.addPollToast({token:s,message:e})},dismissModal(){this.pollsStore.removeActivePoll(),this.voteToSubmit=[]},async submitVote(){this.loading=!0;try{await this.pollsStore.submitVote({token:this.token,pollId:this.id,optionIds:this.voteToSubmit.map(s=>+s)}),this.modalPage="results"}catch(s){console.error(s),this.modalPage="voting"}this.loading=!1},async endPoll(){this.loading=!0;try{await this.pollsStore.endPoll({token:this.token,pollId:this.id}),this.modalPage="results"}catch(s){console.error(s)}this.loading=!1},async createPollDraft(){await this.pollsStore.createPollDraft({token:this.token,form:this.poll})},selfHasVotedOption(s){return this.poll?.votedSelf.includes(s)},getFilteredDetails(s){return(this.poll?.details||[]).filter(e=>e.optionId===s)}}};var Bt=i(12069),Oe={};Oe.styleTagTransform=R(),Oe.setAttributes=O(),Oe.insert=P().bind(null,"head"),Oe.domAPI=I(),Oe.insertStyleElement=L();var Np=T()(Bt.A,Oe);const jp=Bt.A&&Bt.A.locals?Bt.A.locals:void 0;var Ac=(0,b.A)(pc,Qd,qd,!1,null,"5f34177e",null);const gc=Ac.exports;var mc=function(){var e=this,t=e._self._c,a=e._self._setupProxy;return t(a.NcNoteCard,{directives:[{name:"show",rawName:"v-show",value:a.show,expression:"show"}],staticClass:"internal-warning",attrs:{type:"warning"},scopedSlots:e._u([{key:"icon",fn:function(){return[t(a.IconNetworkStrength2Alert,{attrs:{"fill-color":"var(--color-warning)",size:20}})]},proxy:!0}])},[e._v(" "),t("strong",[e._v(e._s(a.warningTitle))]),e._v(" "),t("p",{domProps:{innerHTML:e._s(a.warningDescription)}})])},Cc=[],vc=i(92787);const hc=(0,l.pM)({__name:"InternalSignalingHint",setup(s){const e=(0,ie.P)(),t=(0,Ae.J)(),a=(0,l.EW)(()=>[m.si.TYPE.GROUP,m.si.TYPE.PUBLIC].includes(e.getters.conversation(e.getters.getToken())?.type)),n=(0,l.KR)(!1),o=(0,r.t)("spreed","Calls without High-performance backend can cause connectivity issues and high load on devices. {linkstart}Learn more{linkend}").replace("{linkstart}",'<a target="_blank" rel="noreferrer nofollow" class="external" href="https://portal.nextcloud.com/article/Nextcloud-Talk/High-Performance-Backend/Installation-of-Nextcloud-Talk-High-Performance-Backend">').replace("{linkend}"," \u2197</a>"),u=(0,r.t)("spreed","Talk setup incomplete");(0,l.sV)(()=>{w.l.on("signaling-internal-show-warning",d)}),(0,l.xo)(()=>{w.l.on("signaling-internal-show-warning",d)}),(0,l.wB)(t,p=>{p||(n.value=!1)});const d=()=>{a.value&&(n.value=!0)};return{__sfc:!0,store:e,isInCall:t,isGroupConversation:a,show:n,warningDescription:o,warningTitle:u,showInternalWarning:d,NcNoteCard:Bs.A,IconNetworkStrength2Alert:vc.A}}});var kt=i(50232),Le={};Le.styleTagTransform=R(),Le.setAttributes=O(),Le.insert=P().bind(null,"head"),Le.domAPI=I(),Le.insertStyleElement=L();var $p=T()(kt.A,Le);const Vp=kt.A&&kt.A.locals?kt.A.locals:void 0;var fc=(0,b.A)(hc,mc,Cc,!1,null,"1743a337",null);const Dc={name:"FilesSidebarChatView",components:{InternalSignalingHint:fc.exports,CallButton:$t.A,CallFailedDialog:Vs,ChatView:ou,MediaSettings:pd,PollManager:Zd,PollViewer:gc},setup(){return{isInCall:(0,Ae.J)()}},data(){return{recordingConsentGiven:!1}},computed:{token(){return this.$store.getters.getToken()},connectionFailed(){return this.$store.getters.connectionFailed(this.token)}}};var St=i(77037),Re={};Re.styleTagTransform=R(),Re.setAttributes=O(),Re.insert=P().bind(null,"head"),Re.domAPI=I(),Re.insertStyleElement=L();var Hp=T()(St.A,Re);const Gp=St.A&&St.A.locals?St.A.locals:void 0;var yc=(0,b.A)(Dc,f,v,!1,null,"5356b7d8",null);const Ec=yc.exports}}]);})();

//# sourceMappingURL=talk-files-sidebar-tab-chunk.js.map?v=21008976cfe311939e72